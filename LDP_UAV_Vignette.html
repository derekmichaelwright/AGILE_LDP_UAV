<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Derek Michael Wright derek.wright@usask.ca" />
    
    
    <title>Dissecting lentil crop growth in contrasting environments using digital imaging and and genome-wide association studies</title>

        <script src="LDP_UAV_Vignette_files/header-attrs-2.29/header-attrs.js"></script>
        <script src="LDP_UAV_Vignette_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="LDP_UAV_Vignette_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="LDP_UAV_Vignette_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="LDP_UAV_Vignette_files/navigation-1.1/tabsets.js"></script>
        <script src="LDP_UAV_Vignette_files/navigation-1.1/codefolding.js"></script>
        <link href="LDP_UAV_Vignette_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="LDP_UAV_Vignette_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="LDP_UAV_Vignette_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="LDP_UAV_Vignette_files/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="LDP_UAV_Vignette_files/readthedown-0.1/readthedown.js"></script>
        <link href="LDP_UAV_Vignette_files/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
        <link href="LDP_UAV_Vignette_files/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  background-color: #f8f8f8; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ef2929; } /* Alert */
      code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #204a87; } /* Attribute */
      code span.bn { color: #0000cf; } /* BaseN */
      code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4e9a06; } /* Char */
      code span.cn { color: #8f5902; } /* Constant */
      code span.co { color: #8f5902; font-style: italic; } /* Comment */
      code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
      code span.dt { color: #204a87; } /* DataType */
      code span.dv { color: #0000cf; } /* DecVal */
      code span.er { color: #a40000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #0000cf; } /* Float */
      code span.fu { color: #204a87; font-weight: bold; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
      code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
      code span.ot { color: #8f5902; } /* Other */
      code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
      code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
      code span.ss { color: #4e9a06; } /* SpecialString */
      code span.st { color: #4e9a06; } /* String */
      code span.va { color: #000000; } /* Variable */
      code span.vs { color: #4e9a06; } /* VerbatimString */
      code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="custom.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
        <script>
      $(document).ready(function () {
	  	  	  window.initializeCodeFolding("show" === "show");
	        });
    </script>
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
      <div class="btn-group pull-right">
     <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
     <ul class="dropdown-menu" style="min-width: 50px;">
	    	    <li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
	    <li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
	    	    	         </ul>
   </div>
   
        
      <h1 class="title">Dissecting lentil crop growth in contrasting
environments using digital imaging and and genome-wide association
studies</h1>
         <h1 class="subtitle"><em>The Plant Phenome Journal</em>.
(<strong>2025</strong>) 8(1): e70040.</h1>
   
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Dissecting lentil crop growth in contrasting
environments using digital imaging and and genome-wide association
studies</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#introduction"
      id="toc-introduction">Introduction</a></li>
      <li><a href="#data" id="toc-data">Data</a>
      <ul>
      <li><a href="#manual-phenotypes" id="toc-manual-phenotypes">Manual
      Phenotypes</a></li>
      <li><a href="#drone-phenotypes" id="toc-drone-phenotypes">Drone
      phenotypes</a></li>
      </ul></li>
      <li><a href="#prepare-the-data" id="toc-prepare-the-data">Prepare
      the Data</a>
      <ul>
      <li><a href="#italy-2017" id="toc-italy-2017">Italy 2017</a></li>
      <li><a href="#rosthern-2017" id="toc-rosthern-2017">Rosthern
      2017</a></li>
      <li><a href="#sutherland-2017" id="toc-sutherland-2017">Sutherland
      2017</a></li>
      <li><a href="#sutherland-2018" id="toc-sutherland-2018">Sutherland
      2018</a></li>
      </ul></li>
      <li><a href="#check-data" id="toc-check-data">Check Data</a>
      <ul>
      <li><a href="#italy-2017-1" id="toc-italy-2017-1">Italy
      2017</a></li>
      <li><a href="#rosthern-2017-1" id="toc-rosthern-2017-1">Rosthern
      2017</a></li>
      <li><a href="#sutherland-2017-1"
      id="toc-sutherland-2017-1">Sutherland 2017</a></li>
      <li><a href="#sutherland-2018-1"
      id="toc-sutherland-2018-1">Sutherland 2018</a></li>
      </ul></li>
      <li><a href="#summarise-drone-data"
      id="toc-summarise-drone-data">Summarise Drone Data</a></li>
      <li><a href="#model-growth-curves"
      id="toc-model-growth-curves">Model Growth Curves</a>
      <ul>
      <li><a href="#italy-2017-2" id="toc-italy-2017-2">Italy
      2017</a></li>
      <li><a href="#rosthern-2017-2" id="toc-rosthern-2017-2">Rosthern
      2017</a></li>
      <li><a href="#sutherland-2017-2"
      id="toc-sutherland-2017-2">Sutherland 2017</a></li>
      <li><a href="#sutherland-2018-2"
      id="toc-sutherland-2018-2">Sutherland 2018</a></li>
      </ul></li>
      <li><a href="#figure-1---envdata"
      id="toc-figure-1---envdata">Figure 1 - EnvData</a></li>
      <li><a href="#figure-2---growth-curve-coefficients"
      id="toc-figure-2---growth-curve-coefficients">Figure 2 - Growth
      Curve Coefficients</a>
      <ul>
      <li><a href="#additional-figures-1---growth-curve-coefficients"
      id="toc-additional-figures-1---growth-curve-coefficients">Additional
      Figures 1 - Growth Curve Coefficients</a></li>
      </ul></li>
      <li><a href="#supplemental-figure-1---drone-data"
      id="toc-supplemental-figure-1---drone-data">Supplemental Figure 1
      - Drone Data</a></li>
      <li><a href="#supplemental-figure-2---correlation-plots"
      id="toc-supplemental-figure-2---correlation-plots">Supplemental
      Figure 2 - Correlation Plots</a>
      <ul>
      <li><a href="#additional-figures-2---volume-x-yield-x-arch"
      id="toc-additional-figures-2---volume-x-yield-x-arch">Additional
      Figures 2 - Volume x Yield x Arch</a></li>
      </ul></li>
      <li><a href="#figure-3---growth-curves"
      id="toc-figure-3---growth-curves">Figure 3 - Growth Curves</a>
      <ul>
      <li><a href="#additional-figures-3---growth-curves"
      id="toc-additional-figures-3---growth-curves">Additional Figures 3
      - Growth Curves</a></li>
      </ul></li>
      <li><a href="#supplemental-figure-3"
      id="toc-supplemental-figure-3">Supplemental Figure 3</a></li>
      <li><a href="#figure-4---canada-vs-iran-vs-india"
      id="toc-figure-4---canada-vs-iran-vs-india">Figure 4 - Canada vs
      Iran vs India</a></li>
      <li><a href="#pca" id="toc-pca">PCA</a>
      <ul>
      <li><a href="#additional-figures---cluster-tests"
      id="toc-additional-figures---cluster-tests">Additional Figures -
      Cluster Tests</a></li>
      </ul></li>
      <li><a href="#supplemental-figure-4---pca"
      id="toc-supplemental-figure-4---pca">Supplemental Figure 4 -
      PCA</a></li>
      <li><a href="#figure-5---pca-summary"
      id="toc-figure-5---pca-summary">Figure 5 - PCA Summary</a></li>
      <li><a href="#supplemental-figure-5---pca-inputs"
      id="toc-supplemental-figure-5---pca-inputs">Supplemental Figure 5
      - PCA Inputs</a>
      <ul>
      <li><a href="#additional-figures-4---pca-map"
      id="toc-additional-figures-4---pca-map">Additional Figures 4 - PCA
      Map</a></li>
      <li><a href="#additional-figures-5---ah-x-clusters"
      id="toc-additional-figures-5---ah-x-clusters">Additional Figures 5
      - AH x Clusters</a></li>
      <li><a href="#additional-figures-6---dtf-x-volume"
      id="toc-additional-figures-6---dtf-x-volume">Additional Figures 6
      - DTF x Volume</a></li>
      <li><a href="#additional-figures-7---vha-x-seed-mass"
      id="toc-additional-figures-7---vha-x-seed-mass">Additional Figures
      7 - VHA x Seed Mass</a></li>
      <li><a href="#additional-figures-8---vha-x-cluster"
      id="toc-additional-figures-8---vha-x-cluster">Additional Figures 8
      - VH/A x Cluster</a></li>
      <li><a href="#additional-figures-9---harvest-index"
      id="toc-additional-figures-9---harvest-index">Additional Figures 9
      - Harvest Index</a></li>
      <li><a href="#additional-figures-10---harvest-index-x-dtf"
      id="toc-additional-figures-10---harvest-index-x-dtf">Additional
      Figures 10 - Harvest Index x DTF</a></li>
      </ul></li>
      <li><a href="#figure-06---envchange"
      id="toc-figure-06---envchange">Figure 06 - EnvChange</a></li>
      <li><a href="#prepare-data-for-gwas"
      id="toc-prepare-data-for-gwas">Prepare Data for GWAS</a>
      <ul>
      <li><a href="#raw-drone-data" id="toc-raw-drone-data">Raw Drone
      Data</a></li>
      <li><a href="#growth-curve-data" id="toc-growth-curve-data">Growth
      Curve Data</a></li>
      <li><a href="#manual-phenotypes-1"
      id="toc-manual-phenotypes-1">Manual Phenotypes</a></li>
      </ul></li>
      <li><a href="#run-gwas" id="toc-run-gwas">Run GWAS</a></li>
      <li><a href="#post-gwas" id="toc-post-gwas">Post GWAS</a>
      <ul>
      <li><a href="#significant-markers"
      id="toc-significant-markers">Significant Markers</a></li>
      <li><a href="#manhattan-plots" id="toc-manhattan-plots">Manhattan
      Plots</a></li>
      </ul></li>
      <li><a href="#figure-07---gwas-summary"
      id="toc-figure-07---gwas-summary">Figure 07 - GWAS
      Summary</a></li>
      <li><a href="#supplemental-figure-6"
      id="toc-supplemental-figure-6">Supplemental Figure 6</a></li>
      <li><a href="#supplemental-figure-7"
      id="toc-supplemental-figure-7">Supplemental Figure 7</a></li>
      <li><a href="#figure-08---markers"
      id="toc-figure-08---markers">Figure 08 - Markers</a>
      <ul>
      <li><a href="#additional-figures-11---ah-by-ftb"
      id="toc-additional-figures-11---ah-by-ftb">Additional Figures 11 -
      AH by FTb</a></li>
      </ul></li>
      <li><a href="#supplemental-figure-8---dtf-markers"
      id="toc-supplemental-figure-8---dtf-markers">Supplemental Figure 8
      - DTF Markers</a>
      <ul>
      <li><a href="#additional-figures-12"
      id="toc-additional-figures-12">Additional Figures 12</a></li>
      <li><a href="#additional-figures-13"
      id="toc-additional-figures-13">Additional Figures 13</a></li>
      </ul></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> Derek
Michael Wright <a href="mailto:derek.wright@usask.ca"
class="email">derek.wright@usask.ca</a></p>
                        <p class="date"><span class="glyphicon glyphicon-calendar"></span> 01-10-2025</p>
          </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<hr />
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This vignette contains the <code>R</code> code and analysis done for
the paper:</p>
<blockquote>
<ul>
<li><i class="far fa-newspaper" role="presentation" aria-label="newspaper icon"></i>
<a href="https://doi.org/10.1002/ppj2.70040" target="_blank">Derek M.
Wright, Sandesh Neupane, Steve Shirtliffe, Tania Gioia, Giuseppina
Logozzo, Stefania Marzario, Karsten M.E. Neilson &amp; Kirstin E. Bett.
<strong>Dissecting lentil crop growth in contrasting environments using
digital imaging and and genome-wide association studies</strong>.
<em>The Plant Phenome Journal</em>. (<strong>2025</strong>) 8(1):
e70040. doi.org/10.1002/ppj2.70040</a></li>
<li><i class="fab fa-github" role="presentation" aria-label="github icon"></i>
<a href="https://github.com/derekmichaelwright/AGILE_LDP_UAV"
target="_blank">https://github.com/derekmichaelwright/AGILE_LDP_UAV</a></li>
</ul>
</blockquote>
<p>which is follow-up to:</p>
<blockquote>
<ul>
<li><i class="far fa-newspaper" role="presentation" aria-label="newspaper icon"></i>
<a href="https://doi.org/10.1002/tpg2.20269" target="_blank">Sandesh
Neupane, Derek Wright, Raul Martinez, Jakob Butler, Jim Weller, Kirstin
Bett. <strong>Focusing the GWAS <em>Lens</em> on days to flower using
latent variable phenotypes derived from global multi-environment
trials</strong>. <em>The Plant Genome</em>. (<strong>2022</strong>)
16(1): e20269. doi.org/10.1002/tpg2.20269</a></li>
<li><i class="fab fa-github" role="presentation" aria-label="github icon"></i>
<a href="https://github.com/derekmichaelwright/AGILE_LDP_GWAS_Phenology"
target="_blank">https://github.com/derekmichaelwright/AGILE_LDP_GWAS_Phenology</a></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><i class="far fa-newspaper" role="presentation" aria-label="newspaper icon"></i>
<a href="https://doi.org/10.1002/ppp3.10158" target="_blank">Derek M.
Wright, Sandesh Neupane, Taryn Heidecker, Teketel A. Haile, Crystal
Chan, Clarice J. Coyne, Rebecca J. McGee, Sripada Udupa, Fatima Henkrar,
Eleonora Barilli, Diego Rubiales, Tania Gioia, Giuseppina Logozzo,
Stefania Marzario, Reena Mehra, Ashutosh Sarker, Rajeev Dhakal, Babul
Anwar, Debashish Sarker, Albert Vandenberg &amp; Kirstin E. Bett.
<strong>Understanding photothermal interactions can help expand
production range and increase genetic diversity of lentil (<em>Lens
culinaris</em> Medik.)</strong>. <em>Plants, People, Planet</em>.
(<strong>2021</strong>) 3(2): 171-181.
doi.org/10.1002/ppp3.10158</a></li>
<li><i class="fab fa-github" role="presentation" aria-label="github icon"></i>
<a href="https://github.com/derekmichaelwright/AGILE_LDP_Phenology"
target="_blank">https://github.com/derekmichaelwright/AGILE_LDP_Phenology</a></li>
</ul>
</blockquote>
<hr />
<p>This work done as part of the AGILE and P<sup>2</sup>IRC projects at
the University of Saskatchewan:</p>
<p><img src="Additional/img_Agile.png" style="width:50.0%" /></p>
<blockquote>
<p><a
href="https://knowpulse.usask.ca/study/AGILE-Application-of-Genomic-Innovation-in-the-Lentil-Economy"
class="uri">https://knowpulse.usask.ca/study/AGILE-Application-of-Genomic-Innovation-in-the-Lentil-Economy</a></p>
</blockquote>
<p><img src="Additional/img_P2IRC.png" style="width:50.0%" /></p>
<blockquote>
<p><a href="https://p2irc.usask.ca/"
class="uri">https://p2irc.usask.ca/</a></p>
</blockquote>
<hr />
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Load Libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(growthcurver)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>theme_AGL <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background   =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>        <span class="at">panel.background   =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>        <span class="at">panel.border       =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>        <span class="at">panel.grid         =</span> <span class="fu">element_line</span>(<span class="at">color  =</span> <span class="fu">alpha</span>(<span class="st">&quot;black&quot;</span>, <span class="fl">0.1</span>), <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>myExpts1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Metaponto, Italy 2017&quot;</span>, <span class="st">&quot;Rosthern, Canada 2017&quot;</span>, </span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>              <span class="st">&quot;Sutherland, Canada 2017&quot;</span>, <span class="st">&quot;Sutherland, Canada 2018&quot;</span>)</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>myExpts2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;It17&quot;</span>, <span class="st">&quot;Ro17&quot;</span>, <span class="st">&quot;Su17&quot;</span>, <span class="st">&quot;Su18&quot;</span>)</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>myColors_Expt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>myColors_Cluster <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red4&quot;</span>, <span class="st">&quot;darkorange3&quot;</span>, <span class="st">&quot;blue2&quot;</span>, <span class="st">&quot;deeppink3&quot;</span>, </span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>                      <span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;darkorchid4&quot;</span>, <span class="st">&quot;darkslategray&quot;</span>, <span class="st">&quot;chartreuse4&quot;</span>)</span></code></pre></div>
<hr />
<div id="manual-phenotypes" class="section level2">
<h2>Manual Phenotypes</h2>
<blockquote>
<ul>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a href="Data_Manual/myLDP.csv">Data_Manual/myLDP.csv</a></li>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a
href="Data_Manual/LDP_Italy_2017_Phenotypes.csv">Data_Manual/LDP_Italy_2017_Phenotypes.csv</a></li>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a
href="Data_Manual/LDP_Rosthern_2017_Phenotypes.csv">Data_Manual/LDP_Rosthern_2017_Phenotypes.csv</a></li>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a
href="Data_Manual/LDP_Sutherland_2017_Phenotypes.csv">Data_Manual/LDP_Sutherland_2017_Phenotypes.csv</a></li>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a
href="Data_Manual/LDP_Sutherland_2018_Phenotypes.csv">Data_Manual/LDP_Sutherland_2018_Phenotypes.csv</a></li>
</ul>
</blockquote>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># LDP Metadata</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>myLDP <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_Manual/myLDP.csv&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># Manual Phenotypes</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>it17_f <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_Manual/LDP_Italy_2017_Phenotypes.csv&quot;</span>) </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>ro17_f <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_Manual/LDP_Rosthern_2017_Phenotypes.csv&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>su17_f <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_Manual/LDP_Sutherland_2017_Phenotypes.csv&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>su18_f <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_Manual/LDP_Sutherland_2018_Phenotypes.csv&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="drone-phenotypes" class="section level2">
<h2>Drone phenotypes</h2>
<p>Raw Data</p>
<blockquote>
<ul>
<li><i class="fas fa-globe" role="presentation" aria-label="globe icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/tree/main/Data_Drone/LDP_Italy_2017/"
target="_blank">Data_Drone/LDP_Italy_2017/</a></li>
<li><i class="fas fa-globe" role="presentation" aria-label="globe icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/tree/main/Data_Drone/LDP_Rosthern_2017/"
target="_blank">Data_Drone/LDP_Rosthern_2017/</a></li>
<li><i class="fas fa-globe" role="presentation" aria-label="globe icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/tree/main/Data_Drone/LDP_Sutherland_2017/"
target="_blank">Data_Drone/LDP_Sutherland_2017/</a></li>
<li><i class="fas fa-globe" role="presentation" aria-label="globe icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/tree/main/Data_Drone/LDP_Sutherland_2018/"
target="_blank">Data_Drone/LDP_Sutherland_2018/</a></li>
</ul>
</blockquote>
<p>Compiled Data</p>
<blockquote>
<ul>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a
href="Data_Drone/UAV_LDP_It17_data.csv">Data_Drone/UAV_LDP_It17_data.csv</a></li>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a
href="Data_Drone/UAV_LDP_Rot17_data.csv">Data_Drone/UAV_LDP_Ro17_data.csv</a></li>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a
href="Data_Drone/UAV_LDP_Su17_data.csv">Data_Drone/UAV_LDP_Su17_data.csv</a></li>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a
href="Data_Drone/UAV_LDP_Su18_data.csv">Data_Drone/UAV_LDP_Su18_data.csv</a></li>
</ul>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Function to read in the drone data</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>readDrone <span class="ot">&lt;-</span> <span class="cf">function</span>(folder, colNum, xf) {</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  fnames <span class="ot">&lt;-</span> <span class="fu">list.files</span>(folder)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> fnames) {</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    xi <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(folder, i))</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(xx, xi)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  }</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> </span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Plot=</span>plot_name, <span class="at">Date=</span>mission_date, <span class="at">Sensor=</span>sensor_type) <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Plot =</span> <span class="fu">as.integer</span>(Plot)) <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>    <span class="fu">gather</span>(Trait, Value, colNum<span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    <span class="fu">left_join</span>(xf[,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Entry), <span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">DAP =</span> <span class="fu">as.numeric</span>(<span class="fu">as.Date</span>(Date) <span class="sc">-</span> <span class="fu">as.Date</span>(Planting.Date)),</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>           <span class="at">Value_f =</span> Value) <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>    <span class="fu">select</span>(Expt, Row, Column, Plot, Rep, Entry, Name, </span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>           Planting.Date, DAP, Date, Sensor, Trait, Value, Value_f)</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>  xx</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>}</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co"># Load drone data</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">readDrone</span>(<span class="at">folder =</span> <span class="st">&quot;Data_Drone/LDP_Italy_2017/&quot;</span>,</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>                    <span class="at">colNum =</span> <span class="dv">6</span>, <span class="at">xf =</span> it17_f)</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>ro17_d <span class="ot">&lt;-</span> <span class="fu">readDrone</span>(<span class="at">folder =</span> <span class="st">&quot;Data_Drone/LDP_Rosthern_2017/&quot;</span>,</span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>                    <span class="at">colNum =</span> <span class="dv">7</span>, <span class="at">xf =</span> ro17_f)</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> <span class="fu">readDrone</span>(<span class="at">folder =</span> <span class="st">&quot;Data_Drone/LDP_Sutherland_2017/&quot;</span>,</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>                    <span class="at">colNum =</span> <span class="dv">7</span>, <span class="at">xf =</span> su17_f)</span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">readDrone</span>(<span class="at">folder =</span> <span class="st">&quot;Data_Drone/LDP_Sutherland_2018/&quot;</span>,</span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>                    <span class="at">colNum =</span> <span class="dv">7</span>, <span class="at">xf =</span> su18_f)</span></code></pre></div>
<p>Gather manual phenotypes</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>it17_f <span class="ot">&lt;-</span> it17_f <span class="sc">%&gt;%</span> <span class="fu">gather</span>(Trait, Value, <span class="dv">11</span><span class="sc">:</span><span class="fu">ncol</span>(.))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>ro17_f <span class="ot">&lt;-</span> ro17_f <span class="sc">%&gt;%</span> <span class="fu">gather</span>(Trait, Value, <span class="dv">11</span><span class="sc">:</span><span class="fu">ncol</span>(.))</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>su17_f <span class="ot">&lt;-</span> su17_f <span class="sc">%&gt;%</span> <span class="fu">gather</span>(Trait, Value, <span class="dv">11</span><span class="sc">:</span><span class="fu">ncol</span>(.))</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>su18_f <span class="ot">&lt;-</span> su18_f <span class="sc">%&gt;%</span> <span class="fu">gather</span>(Trait, Value, <span class="dv">11</span><span class="sc">:</span><span class="fu">ncol</span>(.))</span></code></pre></div>
<hr />
</div>
</div>
<div id="prepare-the-data" class="section level1">
<h1>Prepare the Data</h1>
<p>Filter Outliers and add extra data points for aiding growth
curves</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Function to add pseudo-data points to aid growthcurve creation</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>traitAdd <span class="ot">&lt;-</span> <span class="cf">function</span>(xx, myTrait, myDAP, myValue) {</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(xx<span class="sc">$</span>Plot)) {</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    xi <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>      <span class="fu">filter</span>(Trait <span class="sc">==</span> myTrait, Plot <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>      <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">DAP =</span> myDAP, <span class="at">Sensor =</span> <span class="st">&quot;NA&quot;</span>, </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>             <span class="at">Date =</span> <span class="fu">as.character</span>(<span class="fu">as.Date</span>(Planting.Date) <span class="sc">+</span> myDAP), </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>             <span class="at">Value =</span> <span class="cn">NA</span>, <span class="at">Value_f =</span> myValue)</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(xi,xx)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  }</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  xx</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>}</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co"># Function to add pseudo-data points during the &quot;stationary phase&quot;</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>traitPredict <span class="ot">&lt;-</span> <span class="cf">function</span>(xx, myDAP, myTrait) {</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(xx<span class="sc">$</span>Plot)) {</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>    xi <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Plot <span class="sc">==</span> i, Trait <span class="sc">==</span> myTrait)</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(xi<span class="sc">$</span>Value_f)) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>      myVal <span class="ot">&lt;-</span> xi <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Value_f) <span class="sc">%&gt;%</span> <span class="fu">max</span>(<span class="at">na.rm =</span> T)</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>      xi <span class="ot">&lt;-</span> xi <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">DAP =</span> myDAP, <span class="at">Sensor =</span> <span class="st">&quot;NA&quot;</span>, </span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>               <span class="at">Date =</span> <span class="fu">as.character</span>(<span class="fu">as.Date</span>(Planting.Date) <span class="sc">+</span> myDAP), </span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>               <span class="at">Value =</span> <span class="cn">NA</span>,</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>               <span class="at">Value_f =</span> myVal)</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>      xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(xx, xi)</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>    }</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>  }</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>  xx</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>}</span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="co"># Function to find outliers after a certain DAP based on decreases from max</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>outliers_Maturity <span class="ot">&lt;-</span> <span class="cf">function</span>(xx, myDAP, <span class="at">myThreshold =</span> <span class="dv">1</span>, <span class="at">predict =</span> T,</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>                              myTrait, myOtherTraits ) {</span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a>  yy <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(xx<span class="sc">$</span>Plot)) {</span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a>    myMax <span class="ot">&lt;-</span> <span class="fu">max</span>(xx <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Plot <span class="sc">==</span> i, Trait <span class="sc">==</span> myTrait) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Value_f), <span class="at">na.rm =</span> T)</span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a>    xi <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Plot <span class="sc">==</span> i)</span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a>    daps_r <span class="ot">&lt;-</span> xi <span class="sc">%&gt;%</span> </span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a>      <span class="fu">filter</span>(DAP <span class="sc">&gt;=</span> myDAP, Trait <span class="sc">==</span> myTrait, Value_f <span class="sc">&lt;</span> myMax <span class="sc">*</span> myThreshold ) <span class="sc">%&gt;%</span> </span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a>      <span class="fu">pull</span>(DAP)</span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a>    daps_r <span class="ot">&lt;-</span> <span class="fu">c</span>(daps_r, <span class="fu">unique</span>(xi<span class="sc">$</span>DAP)[<span class="fu">unique</span>(xi<span class="sc">$</span>DAP)<span class="sc">&gt;</span>daps_r])</span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a>    xi <span class="ot">&lt;-</span> xi <span class="sc">%&gt;%</span></span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Value_f =</span> <span class="fu">ifelse</span>(DAP <span class="sc">%in%</span> daps_r, <span class="cn">NA</span>, Value_f))</span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a>    <span class="cf">if</span>(predict <span class="sc">==</span> T) {</span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a>      xi <span class="ot">&lt;-</span> xi <span class="sc">%&gt;%</span></span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">Value_f =</span> <span class="fu">ifelse</span>(DAP <span class="sc">%in%</span> daps_r <span class="sc">&amp;</span> Trait <span class="sc">==</span> myTrait, </span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a>                                myMax<span class="sc">*</span><span class="fl">0.99</span>, Value_f))</span>
<span id="cb5-47"><a href="#cb5-47" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> myOtherTraits) {</span>
<span id="cb5-48"><a href="#cb5-48" tabindex="-1"></a>        myMax <span class="ot">&lt;-</span> <span class="fu">max</span>(xi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> k) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Value_f), <span class="at">na.rm =</span> T)</span>
<span id="cb5-49"><a href="#cb5-49" tabindex="-1"></a>        xi <span class="ot">&lt;-</span> xi <span class="sc">%&gt;%</span></span>
<span id="cb5-50"><a href="#cb5-50" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">Value_f =</span> <span class="fu">ifelse</span>(DAP <span class="sc">%in%</span> daps_r <span class="sc">&amp;</span> Trait <span class="sc">==</span> k, </span>
<span id="cb5-51"><a href="#cb5-51" tabindex="-1"></a>                                  myMax<span class="sc">*</span><span class="fl">0.99</span>, Value_f))</span>
<span id="cb5-52"><a href="#cb5-52" tabindex="-1"></a>      }</span>
<span id="cb5-53"><a href="#cb5-53" tabindex="-1"></a>    }</span>
<span id="cb5-54"><a href="#cb5-54" tabindex="-1"></a>    yy <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(yy, xi)</span>
<span id="cb5-55"><a href="#cb5-55" tabindex="-1"></a>  }</span>
<span id="cb5-56"><a href="#cb5-56" tabindex="-1"></a>  yy</span>
<span id="cb5-57"><a href="#cb5-57" tabindex="-1"></a>}</span></code></pre></div>
<div id="italy-2017" class="section level2">
<h2>Italy 2017</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Add pseudo-data for day 0</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> it17_d, <span class="at">myDAP =</span> <span class="dv">0</span>, <span class="at">myValue =</span> <span class="dv">0</span>, </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> it17_d, <span class="at">myDAP =</span> <span class="dv">0</span>, <span class="at">myValue =</span> <span class="dv">0</span>,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> it17_d, <span class="at">myDAP =</span> <span class="dv">0</span>, <span class="at">myValue =</span> <span class="dv">0</span>,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co"># Plots with bad data</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>myPs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">619</span>, <span class="dv">782</span>, <span class="dv">713</span>, <span class="dv">746</span>, <span class="dv">10</span>, <span class="dv">722</span>, <span class="dv">796</span>, <span class="dv">717</span>, <span class="dv">829</span>, </span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>          <span class="dv">874</span>, <span class="dv">767</span>, <span class="dv">903</span>, <span class="dv">866</span>, <span class="dv">8</span>, <span class="dv">707</span>, <span class="dv">876</span>, <span class="dv">24</span>, <span class="dv">958</span>, <span class="dv">614</span>, <span class="dv">618</span>,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>          <span class="dv">397</span>, <span class="dv">2</span>, <span class="dv">687</span>, <span class="dv">12</span>, <span class="dv">456</span>, <span class="dv">665</span>)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co"># Manually remove outlier data</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> it17_d <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value_f =</span> <span class="fu">ifelse</span>(Plot <span class="sc">%in%</span> myPs, <span class="cn">NA</span>, Value_f),</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Plot <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">&quot;height|Volume&quot;</span>,Trait) <span class="sc">&amp;</span> DAP <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">101</span>,<span class="dv">119</span>), </span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f),</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Plot <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">&quot;height|Volume&quot;</span>,Trait) <span class="sc">&amp;</span> DAP <span class="sc">==</span> <span class="dv">119</span>, </span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f),</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Plot <span class="sc">==</span> <span class="dv">4</span> <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">&quot;height|Volume&quot;</span>,Trait) <span class="sc">&amp;</span> DAP <span class="sc">==</span> <span class="dv">101</span>, </span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f),</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Plot <span class="sc">==</span> <span class="dv">5</span> <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">&quot;height|Volume&quot;</span>,Trait) <span class="sc">&amp;</span> DAP <span class="sc">==</span> <span class="dv">164</span>, </span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f),</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Plot <span class="sc">==</span> <span class="dv">17</span> <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">&quot;height|Volume&quot;</span>,Trait) <span class="sc">&amp;</span> DAP <span class="sc">==</span> <span class="dv">164</span>, </span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f) )</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">outliers_Maturity</span>(<span class="at">xx =</span> it17_d, <span class="at">myDAP =</span> <span class="dv">163</span>,</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>            <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>,</span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>            <span class="at">myOtherTraits =</span> <span class="fu">c</span>(<span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>,</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>                              <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>,</span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>                              <span class="st">&quot;median_crop_height_m_excess.green.based&quot;</span>,</span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>                              <span class="st">&quot;max_crop_height_m_excess.green.based&quot;</span>) )</span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">outliers_Maturity</span>(<span class="at">xx =</span> it17_d, <span class="at">myDAP =</span> <span class="dv">163</span>, </span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a>            <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>,</span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>            <span class="at">myOtherTraits =</span> <span class="fu">c</span>(<span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>,</span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>                              <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>,</span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a>                              <span class="st">&quot;median_crop_height_m_excess.green.based&quot;</span>,</span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a>                              <span class="st">&quot;max_crop_height_m_excess.green.based&quot;</span>) )</span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> it17_d, <span class="at">myDAP =</span> <span class="dv">180</span>,</span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>)</span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> it17_d, <span class="at">myDAP =</span> <span class="dv">180</span>,</span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>)</span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> it17_d, <span class="at">myDAP =</span> <span class="dv">180</span>,</span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>)</span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> it17_d, <span class="at">myDAP =</span> <span class="dv">210</span>,</span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>)</span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> it17_d, <span class="at">myDAP =</span> <span class="dv">210</span>,</span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>)</span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> it17_d, <span class="at">myDAP =</span> <span class="dv">210</span>,</span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>)</span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-52"><a href="#cb6-52" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> it17_d, <span class="at">myDAP =</span> <span class="dv">200</span>,</span>
<span id="cb6-53"><a href="#cb6-53" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>)</span>
<span id="cb6-54"><a href="#cb6-54" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-55"><a href="#cb6-55" tabindex="-1"></a>xx <span class="ot">&lt;-</span> it17_d <span class="sc">%&gt;%</span> </span>
<span id="cb6-56"><a href="#cb6-56" tabindex="-1"></a>  <span class="fu">filter</span>(Plot <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">456</span>,<span class="dv">665</span>) <span class="sc">&amp;</span> DAP <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">93</span>,<span class="dv">94</span>),</span>
<span id="cb6-57"><a href="#cb6-57" tabindex="-1"></a>         Trait <span class="sc">==</span> <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-58"><a href="#cb6-58" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sensor =</span> <span class="st">&quot;NA&quot;</span>, <span class="at">DAP =</span> <span class="dv">10</span>, </span>
<span id="cb6-59"><a href="#cb6-59" tabindex="-1"></a>         <span class="at">Date =</span> <span class="fu">as.character</span>(<span class="fu">as.Date</span>(Planting.Date) <span class="sc">+</span> DAP),</span>
<span id="cb6-60"><a href="#cb6-60" tabindex="-1"></a>         <span class="at">Value =</span> <span class="cn">NA</span>, <span class="at">Value_f =</span> <span class="fl">0.001</span>)</span>
<span id="cb6-61"><a href="#cb6-61" tabindex="-1"></a>it17_d <span class="ot">&lt;-</span> it17_d <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(xx)</span>
<span id="cb6-62"><a href="#cb6-62" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-63"><a href="#cb6-63" tabindex="-1"></a><span class="fu">write.csv</span>(it17_d, <span class="st">&quot;Data_Drone/UAV_LDP_It17_data.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="rosthern-2017" class="section level2">
<h2>Rosthern 2017</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Add pseudo-data for day 0</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>ro17_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> ro17_d, <span class="at">myDAP =</span> <span class="dv">0</span>, <span class="at">myValue =</span> <span class="dv">0</span>,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>ro17_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> ro17_d, <span class="at">myDAP =</span> <span class="dv">0</span>, <span class="at">myValue =</span> <span class="dv">0</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>ro17_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> ro17_d, <span class="at">myDAP =</span> <span class="dv">0</span>, <span class="at">myValue =</span> <span class="dv">0</span>,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># Manually remove outlier data</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>ro17_d <span class="ot">&lt;-</span> ro17_d <span class="sc">%&gt;%</span> </span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value_f =</span> <span class="fu">ifelse</span>(Trait <span class="sc">==</span> <span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>                          Date <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;2017-06-12&quot;</span>, <span class="st">&quot;2017-06-20&quot;</span>), </span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f),</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Trait <span class="sc">==</span> <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>                          Date <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;2017-06-12&quot;</span>,<span class="st">&quot;2017-06-20&quot;</span>,<span class="st">&quot;2017-06-27&quot;</span>), </span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f),</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Trait <span class="sc">==</span> <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>                          Date <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;2017-06-12&quot;</span>,<span class="st">&quot;2017-06-20&quot;</span>) <span class="sc">&amp;</span> Value <span class="sc">&gt;</span> <span class="fl">0.2</span>, </span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f),</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Trait <span class="sc">==</span> <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>                          Date <span class="sc">==</span> <span class="st">&quot;2017-06-28&quot;</span> <span class="sc">&amp;</span> Value <span class="sc">&gt;</span> <span class="fl">0.3</span>, </span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f) )</span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>ro17_d <span class="ot">&lt;-</span> <span class="fu">outliers_Maturity</span>(<span class="at">xx =</span> ro17_d, <span class="at">myDAP =</span> <span class="dv">75</span>,</span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>            <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>,</span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>            <span class="at">myOtherTraits =</span> <span class="fu">c</span>(<span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>,</span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>                              <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>,</span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>                              <span class="st">&quot;median_crop_height_m_blue.ndvi.based&quot;</span>,</span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>                              <span class="st">&quot;max_crop_height_m_blue.ndvi.based&quot;</span>))</span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a>ro17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> ro17_d, <span class="at">myDAP =</span> <span class="dv">105</span>,</span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>)</span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a>ro17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> ro17_d, <span class="at">myDAP =</span> <span class="dv">105</span>,</span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>)</span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a>ro17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> ro17_d, <span class="at">myDAP =</span> <span class="dv">105</span>,</span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>)</span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a>ro17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> ro17_d, <span class="at">myDAP =</span> <span class="dv">110</span>,</span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>)</span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a>ro17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> ro17_d, <span class="at">myDAP =</span> <span class="dv">110</span>,</span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>)</span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a>ro17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> ro17_d, <span class="at">myDAP =</span> <span class="dv">110</span>,</span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>)</span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a><span class="fu">write.csv</span>(ro17_d, <span class="st">&quot;Data_Drone/UAV_LDP_Ro17_data.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="sutherland-2017" class="section level2">
<h2>Sutherland 2017</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> su17_d <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value_f =</span> <span class="fu">ifelse</span>(Value_f <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, Value_f))</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># Add pseudo-data for day 0</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> su17_d, <span class="at">myDAP =</span> <span class="dv">0</span>, <span class="at">myValue =</span> <span class="dv">0</span>,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> su17_d, <span class="at">myDAP =</span> <span class="dv">0</span>, <span class="at">myValue =</span> <span class="dv">0</span>,</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> su17_d, <span class="at">myDAP =</span> <span class="dv">0</span>, <span class="at">myValue =</span> <span class="dv">0</span>,</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co"># Manually remove outlier data</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> su17_d <span class="sc">%&gt;%</span> </span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value_f =</span> <span class="fu">ifelse</span>(Sensor <span class="sc">==</span> <span class="st">&quot;ILCE-QX1&quot;</span> <span class="sc">&amp;</span> Date <span class="sc">==</span> <span class="st">&quot;2017-07-04&quot;</span>,</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f),</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Trait <span class="sc">==</span> <span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span> <span class="sc">&amp;</span> </span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>                          Date <span class="sc">==</span> <span class="st">&quot;2017-06-05&quot;</span>, <span class="cn">NA</span>, Value_f),</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Trait <span class="sc">==</span> <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>                          Date <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;2017-06-05&quot;</span>, <span class="st">&quot;2017-06-12&quot;</span>), </span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f),</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Trait <span class="sc">==</span> <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>                          Date <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;2017-06-05&quot;</span>, <span class="st">&quot;2017-06-13&quot;</span>, <span class="st">&quot;2017-06-19&quot;</span>, <span class="st">&quot;2017-06-24&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>                          Value_f <span class="sc">&gt;</span> <span class="fl">0.2</span>, <span class="cn">NA</span>, Value_f),</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Trait <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>,</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>                                       <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>) <span class="sc">&amp;</span> </span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>                          Plot <span class="sc">==</span> <span class="dv">5573</span> <span class="sc">&amp;</span> DAP <span class="sc">==</span> <span class="dv">51</span>, </span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f),</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Trait <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>,</span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a>                                       <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>) <span class="sc">&amp;</span> </span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>                          Plot <span class="sc">==</span> <span class="dv">5588</span>, <span class="cn">NA</span>, Value_f),</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Plot <span class="sc">==</span> <span class="dv">6030</span>, <span class="cn">NA</span>, Value_f))</span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> <span class="fu">outliers_Maturity</span>(<span class="at">xx =</span> su17_d, <span class="at">myDAP =</span> <span class="dv">76</span>,</span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a>                            <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>,</span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a>                            <span class="at">myOtherTraits =</span> <span class="fu">c</span>(<span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>,</span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a>                                             <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>,</span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a>                                             <span class="st">&quot;median_crop_height_m_blue.ndvi.based&quot;</span>,</span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a>                                             <span class="st">&quot;max_crop_height_m_blue.ndvi.based&quot;</span>))</span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> su17_d, <span class="at">myDAP =</span> <span class="dv">95</span>,</span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>)</span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> su17_d, <span class="at">myDAP =</span> <span class="dv">95</span>,</span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>)</span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> su17_d, <span class="at">myDAP =</span> <span class="dv">95</span>,</span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>)</span>
<span id="cb8-45"><a href="#cb8-45" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> su17_d, <span class="at">myDAP =</span> <span class="dv">105</span>,</span>
<span id="cb8-46"><a href="#cb8-46" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>)</span>
<span id="cb8-47"><a href="#cb8-47" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> su17_d, <span class="at">myDAP =</span> <span class="dv">105</span>,</span>
<span id="cb8-48"><a href="#cb8-48" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>)</span>
<span id="cb8-49"><a href="#cb8-49" tabindex="-1"></a>su17_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> su17_d, <span class="at">myDAP =</span> <span class="dv">105</span>,</span>
<span id="cb8-50"><a href="#cb8-50" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>)</span>
<span id="cb8-51"><a href="#cb8-51" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb8-52"><a href="#cb8-52" tabindex="-1"></a><span class="fu">write.csv</span>(su17_d, <span class="st">&quot;Data_Drone/UAV_LDP_Su17_data.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="sutherland-2018" class="section level2">
<h2>Sutherland 2018</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Add pseudo-data for day 0 and day 30</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> su18_d, <span class="at">myDAP =</span> <span class="dv">0</span>, <span class="at">myValue =</span> <span class="dv">0</span>,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> su18_d, <span class="at">myDAP =</span> <span class="dv">0</span>, <span class="at">myValue =</span> <span class="dv">0</span>,</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> su18_d, <span class="at">myDAP =</span> <span class="dv">0</span>, <span class="at">myValue =</span> <span class="dv">0</span>,</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> su18_d, <span class="at">myDAP =</span> <span class="dv">30</span>, <span class="at">myValue =</span> <span class="fl">0.01</span>,</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> su18_d, <span class="at">myDAP =</span> <span class="dv">30</span>, <span class="at">myValue =</span> <span class="fl">0.05</span>,</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">traitAdd</span>(<span class="at">xx =</span> su18_d, <span class="at">myDAP =</span> <span class="dv">30</span>, <span class="at">myValue =</span> <span class="fl">0.01</span>,</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>)</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co"># Manually remove outlier data</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> su18_d <span class="sc">%&gt;%</span> </span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value_f =</span> <span class="fu">ifelse</span>(DAP <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">42</span>,<span class="dv">55</span>,<span class="dv">58</span>), <span class="cn">NA</span>, Value_f),</span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Trait <span class="sc">==</span> <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>                          DAP <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">&amp;</span> Value_f <span class="sc">&gt;</span> <span class="fl">0.2</span>, </span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f),</span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Plot <span class="sc">==</span> <span class="dv">5689</span>, <span class="cn">NA</span>, Value_f),</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>         <span class="at">Value_f =</span> <span class="fu">ifelse</span>(Plot <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5301</span>,<span class="dv">5648</span>) <span class="sc">&amp;</span> DAP <span class="sc">==</span> <span class="dv">61</span>, <span class="cn">NA</span>, Value_f))</span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>xx <span class="ot">&lt;-</span> su18_d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span> <span class="sc">&amp;</span> </span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a>                        DAP <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">&amp;</span> Value <span class="sc">&gt;</span> <span class="fl">0.2</span>)</span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> su18_d <span class="sc">%&gt;%</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value_f =</span> <span class="fu">ifelse</span>(<span class="fu">paste</span>(Plot, DAP, Trait) <span class="sc">%in%</span> </span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a>                            <span class="fu">paste</span>(xx<span class="sc">$</span>Plot, xx<span class="sc">$</span>DAP, <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>), </span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a>                          <span class="cn">NA</span>, Value_f))</span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> su18_d, <span class="at">myDAP =</span> <span class="dv">95</span>,</span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>)</span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> su18_d, <span class="at">myDAP =</span> <span class="dv">95</span>,</span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>)</span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> su18_d, <span class="at">myDAP =</span> <span class="dv">95</span>,</span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>)</span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> su18_d, <span class="at">myDAP =</span> <span class="dv">105</span>,</span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>)</span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> su18_d, <span class="at">myDAP =</span> <span class="dv">105</span>,</span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>)</span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a>su18_d <span class="ot">&lt;-</span> <span class="fu">traitPredict</span>(<span class="at">xx =</span> su18_d, <span class="at">myDAP =</span> <span class="dv">105</span>,</span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a>                       <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>)</span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a><span class="fu">write.csv</span>(su18_d, <span class="st">&quot;Data_Drone/UAV_LDP_Su18_data.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
<hr />
</div>
</div>
<div id="check-data" class="section level1">
<h1>Check Data</h1>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Create plotting function</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>ggDroneCheck <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">xd =</span> it17_d, <span class="at">xf =</span> it17_f,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                         <span class="at">myTitle =</span> <span class="cn">NULL</span>,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                         <span class="at">myFilename =</span> <span class="st">&quot;DataCheck/RawDrone_Italy_2017.pdf&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                         <span class="at">xt =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                                <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>                                <span class="st">&quot;mean_ndyi&quot;</span>, </span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>                                <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>,</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>                                <span class="st">&quot;median_crop_height_m_excess.green.based&quot;</span>, </span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>                                <span class="st">&quot;max_crop_height_m_excess.green.based&quot;</span>) ) {</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  myColors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>  xd <span class="ot">&lt;-</span> xd <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Entry)</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>  <span class="fu">pdf</span>(myFilename, <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(xd<span class="sc">$</span>Entry)) {</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>    xdi <span class="ot">&lt;-</span> xd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Entry <span class="sc">==</span> i)</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>    xfi <span class="ot">&lt;-</span> xf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Entry <span class="sc">==</span> i)</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>    j <span class="ot">&lt;-</span> <span class="fu">unique</span>(xdi<span class="sc">$</span>Name)</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>    ggPlotDrone <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">xti=</span>xt[<span class="dv">1</span>]) {</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>      yMax <span class="ot">&lt;-</span> <span class="fu">max</span>(xd<span class="sc">%&gt;%</span><span class="fu">filter</span>(Trait<span class="sc">==</span>xti)<span class="sc">%&gt;%</span><span class="fu">pull</span>(Value_f), <span class="at">na.rm =</span> T)</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>      xMax <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(xd<span class="sc">$</span>DAP, xf<span class="sc">%&gt;%</span><span class="fu">filter</span>(Trait<span class="sc">==</span><span class="st">&quot;DTM&quot;</span>)<span class="sc">%&gt;%</span><span class="fu">pull</span>(Value)), <span class="at">na.rm =</span> T)</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>      xdtf <span class="ot">&lt;-</span> xfi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>) </span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>      xdtm <span class="ot">&lt;-</span> xfi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTM&quot;</span>) </span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>      xd <span class="ot">&lt;-</span> xdi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> xti)</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>      xd2 <span class="ot">&lt;-</span> xd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value_f))</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>      <span class="fu">ggplot</span>(xd, <span class="fu">aes</span>(<span class="at">x =</span> DAP, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">data =</span> xd2, <span class="fu">aes</span>(<span class="at">y =</span> Value_f, <span class="at">color =</span> <span class="fu">as.factor</span>(Rep)), </span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value_f), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Sensor)) <span class="sc">+</span> </span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a>        <span class="fu">geom_vline</span>(<span class="at">data =</span> xdtf, <span class="fu">aes</span>(<span class="at">xintercept =</span> Value), </span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a>                   <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a>        <span class="fu">geom_vline</span>(<span class="at">data =</span> xdtm, <span class="fu">aes</span>(<span class="at">xintercept =</span> Value), </span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a>                   <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a>        <span class="fu">facet_grid</span>(. <span class="sc">~</span> <span class="fu">paste</span>(Rep, <span class="st">&quot;-&quot;</span>, Plot), <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors) <span class="sc">+</span></span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a>        theme_AGL <span class="sc">+</span></span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a>        <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,yMax), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,xMax)) <span class="sc">+</span> </span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">y =</span> xti)</span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a>    }</span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a>    mp1 <span class="ot">&lt;-</span> <span class="fu">ggPlotDrone</span>(<span class="at">xti =</span> xt[<span class="dv">1</span>])</span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a>    mp2 <span class="ot">&lt;-</span> <span class="fu">ggPlotDrone</span>(<span class="at">xti =</span> xt[<span class="dv">2</span>])</span>
<span id="cb10-47"><a href="#cb10-47" tabindex="-1"></a>    mp3 <span class="ot">&lt;-</span> <span class="fu">ggPlotDrone</span>(<span class="at">xti =</span> xt[<span class="dv">3</span>])</span>
<span id="cb10-48"><a href="#cb10-48" tabindex="-1"></a>    <span class="co"># Append</span></span>
<span id="cb10-49"><a href="#cb10-49" tabindex="-1"></a>    mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-50"><a href="#cb10-50" tabindex="-1"></a>      <span class="fu">annotate_figure</span>(<span class="at">top =</span> <span class="fu">text_grob</span>(<span class="fu">paste</span>(myTitle, <span class="st">&quot;Entry&quot;</span>, i, j)))</span>
<span id="cb10-51"><a href="#cb10-51" tabindex="-1"></a>    <span class="fu">print</span>(mp)</span>
<span id="cb10-52"><a href="#cb10-52" tabindex="-1"></a>  }</span>
<span id="cb10-53"><a href="#cb10-53" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb10-54"><a href="#cb10-54" tabindex="-1"></a>}</span></code></pre></div>
<div id="italy-2017-1" class="section level2">
<h2>Italy 2017</h2>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/ggDroneCheck_It17.pdf"
target="_blank">Additional/ggDroneCheck_It17.pdf</a></li>
</ul>
</blockquote>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">ggDroneCheck</span>(<span class="at">xd =</span> it17_d, <span class="at">xf =</span> it17_f, <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017&quot;</span>,</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>             <span class="at">myFilename =</span> <span class="st">&quot;Additional/ggDroneCheck_It17.pdf&quot;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>             <span class="at">xt =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>, </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>                    <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>                    <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>) ) </span></code></pre></div>
</div>
<div id="rosthern-2017-1" class="section level2">
<h2>Rosthern 2017</h2>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/ggDroneCheck_Ro17.pdf"
target="_blank">Additional/ggDroneCheck_Ro17.pdf</a></li>
</ul>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggDroneCheck</span>(<span class="at">xd =</span> ro17_d, <span class="at">xf =</span> ro17_f, <span class="at">myTitle =</span> <span class="st">&quot;Rosthern 2017&quot;</span>,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>             <span class="at">myFilename =</span> <span class="st">&quot;Additional/ggDroneCheck_Ro17.pdf&quot;</span>,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>             <span class="at">xt =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>, </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                    <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>                    <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>) )</span></code></pre></div>
</div>
<div id="sutherland-2017-1" class="section level2">
<h2>Sutherland 2017</h2>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/ggDroneCheck_Su17.pdf"
target="_blank">Additional/ggDroneCheck_Su17.pdf</a></li>
</ul>
</blockquote>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggDroneCheck</span>(<span class="at">xd =</span> su17_d, <span class="at">xf =</span> su17_f, <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017&quot;</span>,</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>             <span class="at">myFilename =</span> <span class="st">&quot;Additional/ggDroneCheck_Su17.pdf&quot;</span>,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>             <span class="at">xt =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>, </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>                    <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>                    <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>) )</span></code></pre></div>
</div>
<div id="sutherland-2018-1" class="section level2">
<h2>Sutherland 2018</h2>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/ggDroneCheck_Su18.pdf"
target="_blank">Additional/ggDroneCheck_Su18.pdf</a></li>
</ul>
</blockquote>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">ggDroneCheck</span>(<span class="at">xd =</span> su18_d, <span class="at">xf =</span> su18_f, <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2018&quot;</span>,</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>             <span class="at">myFilename =</span> <span class="st">&quot;Additional/ggDroneCheck_Su18.pdf&quot;</span>,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>             <span class="at">xt =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>, </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                    <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>                    <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>) )</span></code></pre></div>
<hr />
</div>
</div>
<div id="summarise-drone-data" class="section level1">
<h1>Summarise Drone Data</h1>
<p><img src="Additional/ggDroneTrait_It17.png" /></p>
<p><img src="Additional/ggDroneTrait_Ro17.png" /></p>
<p><img src="Additional/ggDroneTrait_Su17.png" /></p>
<p><img src="Additional/ggDroneTrait_Su18.png" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Create plotting function</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>ggDroneTrait <span class="ot">&lt;-</span> <span class="cf">function</span>(xx, myTitle, <span class="at">myDAPs =</span> <span class="cn">NULL</span>, myTraits, myTraitNames) {</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="co"># Prep data</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(myDAPs)) { myDAPs <span class="ot">&lt;-</span> <span class="fu">unique</span>(xx<span class="sc">$</span>DAP)[<span class="fu">order</span>(<span class="fu">unique</span>(xx<span class="sc">$</span>DAP))] }</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">%in%</span> myTraits, DAP <span class="sc">%in%</span> myDAPs) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Trait =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Trait, myTraits, myTraitNames),</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>           <span class="at">Trait =</span> <span class="fu">factor</span>(Trait, <span class="at">levels =</span> myTraitNames),</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>           <span class="at">Group =</span> <span class="fu">factor</span>(<span class="fu">paste</span>(<span class="st">&quot;Rep&quot;</span>, Rep), </span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Rep 1&quot;</span>, <span class="st">&quot;Rep 2&quot;</span>, <span class="st">&quot;Rep 3&quot;</span>, <span class="st">&quot;Outliers&quot;</span>)),</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>           <span class="at">DAP =</span> <span class="fu">paste</span>(<span class="st">&quot;DAP&quot;</span>, DAP),</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>           <span class="at">DAP =</span> <span class="fu">factor</span>(DAP, <span class="at">levels =</span> <span class="fu">paste</span>(<span class="st">&quot;DAP&quot;</span>, myDAPs)))</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value_f))</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Rep, <span class="at">color =</span> Group, <span class="at">pch =</span> Group)) <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>    <span class="fu">geom_quasirandom</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value_f), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>    <span class="fu">facet_grid</span>(Trait <span class="sc">~</span> DAP, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, </span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>                       <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkslategray&quot;</span>,<span class="st">&quot;steelblue&quot;</span>,<span class="st">&quot;darkslategray4&quot;</span>,<span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> .)) <span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>    theme_AGL <span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>          <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> myTitle, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="cn">NULL</span>)</span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>}</span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co"># Italy 2017</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>xx <span class="ot">&lt;-</span> it17_d <span class="sc">%&gt;%</span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DAP =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(DAP, <span class="fu">c</span>(<span class="dv">93</span>, <span class="dv">101</span>, <span class="dv">119</span>, <span class="dv">133</span>, <span class="dv">163</span>), </span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="dv">94</span>, <span class="dv">100</span>, <span class="dv">118</span>, <span class="dv">132</span>, <span class="dv">164</span>)))</span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggDroneTrait</span>(<span class="at">xx =</span> xx, <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017&quot;</span>, </span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a>                   <span class="at">myDAPs =</span> <span class="fu">c</span>(<span class="dv">94</span>,<span class="dv">100</span>,<span class="dv">118</span>,<span class="dv">132</span>,<span class="dv">164</span>),</span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a>                   <span class="at">myTraits =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>,</span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a>                                <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>,</span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a>                                <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>),</span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a>                   <span class="at">myTraitNames =</span> <span class="fu">c</span>(<span class="st">&quot;Volume&quot;</span>, <span class="st">&quot;Height&quot;</span>, <span class="st">&quot;Area&quot;</span>))</span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggDroneTrait_It17.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="fl">4.5</span>)</span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a><span class="co"># Rosthern 2017</span></span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggDroneTrait</span>(<span class="at">xx =</span> ro17_d, <span class="at">myTitle =</span> <span class="st">&quot;Rosthern 2017&quot;</span>, </span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a>                   <span class="at">myDAPs =</span> <span class="fu">c</span>(<span class="dv">24</span>,<span class="dv">32</span>,<span class="dv">40</span>,<span class="dv">54</span>,<span class="dv">61</span>,<span class="dv">67</span>,<span class="dv">74</span>,<span class="dv">80</span>,<span class="dv">89</span>,<span class="dv">95</span>),</span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a>                   <span class="at">myTraits =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>,</span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a>                                <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>,</span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a>                                <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>),</span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a>                   <span class="at">myTraitNames =</span> <span class="fu">c</span>(<span class="st">&quot;Volume&quot;</span>, <span class="st">&quot;Height&quot;</span>, <span class="st">&quot;Area&quot;</span>))</span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggDroneTrait_Ro17.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="fl">3.5</span>)</span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a><span class="co"># Sutherland 2017</span></span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggDroneTrait</span>(<span class="at">xx =</span> su17_d, <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017&quot;</span>, </span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a>                   <span class="at">myDAPs =</span> <span class="fu">c</span>(<span class="dv">32</span>,<span class="dv">40</span>,<span class="dv">46</span>,<span class="dv">51</span>,<span class="dv">57</span>,<span class="dv">61</span>,<span class="dv">68</span>,<span class="dv">72</span>,<span class="dv">75</span>,<span class="dv">77</span>,<span class="dv">83</span>),</span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a>                   <span class="at">myTraits =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>,</span>
<span id="cb15-50"><a href="#cb15-50" tabindex="-1"></a>                                <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>, </span>
<span id="cb15-51"><a href="#cb15-51" tabindex="-1"></a>                                <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>),</span>
<span id="cb15-52"><a href="#cb15-52" tabindex="-1"></a>                   <span class="at">myTraitNames =</span> <span class="fu">c</span>(<span class="st">&quot;Volume&quot;</span>, <span class="st">&quot;Height&quot;</span>, <span class="st">&quot;Area&quot;</span>))</span>
<span id="cb15-53"><a href="#cb15-53" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggDroneTrait_Su17.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="fl">3.5</span>)</span>
<span id="cb15-54"><a href="#cb15-54" tabindex="-1"></a><span class="co"># Sutherland 2018</span></span>
<span id="cb15-55"><a href="#cb15-55" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggDroneTrait</span>(<span class="at">xx =</span> su18_d, <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2018&quot;</span>, </span>
<span id="cb15-56"><a href="#cb15-56" tabindex="-1"></a>                   <span class="at">myDAPs =</span> <span class="fu">c</span>(<span class="dv">42</span>,<span class="dv">55</span>,<span class="dv">58</span>,<span class="dv">61</span>,<span class="dv">65</span>,<span class="dv">68</span>,<span class="dv">72</span>,<span class="dv">76</span>,<span class="dv">79</span>,<span class="dv">86</span>),</span>
<span id="cb15-57"><a href="#cb15-57" tabindex="-1"></a>                   <span class="at">myTraits =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>,</span>
<span id="cb15-58"><a href="#cb15-58" tabindex="-1"></a>                                <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>,</span>
<span id="cb15-59"><a href="#cb15-59" tabindex="-1"></a>                                <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>),</span>
<span id="cb15-60"><a href="#cb15-60" tabindex="-1"></a>                   <span class="at">myTraitNames =</span> <span class="fu">c</span>(<span class="st">&quot;Volume&quot;</span>, <span class="st">&quot;Height&quot;</span>, <span class="st">&quot;Area&quot;</span>))</span>
<span id="cb15-61"><a href="#cb15-61" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggDroneTrait_Su18.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="fl">3.5</span>)</span></code></pre></div>
<hr />
</div>
<div id="model-growth-curves" class="section level1">
<h1>Model Growth Curves</h1>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Create function for modeling growth curves</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>myGrowthCurve <span class="ot">&lt;-</span> <span class="cf">function</span>(xd, xf, myFolder, myFilename, </span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>                          myTrait, <span class="at">myOrder =</span> <span class="st">&quot;Entries&quot;</span>) {</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="co"># Prep data</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  xd <span class="ot">&lt;-</span> xd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> myTrait)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  xm <span class="ot">&lt;-</span> xf <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Rep, Entry, Name, Expt, Planting.Date) <span class="sc">%&gt;%</span> </span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(Plot))</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  xg <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Growth curve coefficients</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  xp <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Predicted Values</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(xd<span class="sc">$</span>Plot)) {</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>    xgi <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>    xdi <span class="ot">&lt;-</span> xd <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(DAP) <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>      <span class="fu">filter</span>(Plot <span class="sc">==</span> i, <span class="sc">!</span><span class="fu">is.na</span>(Value_f))</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(xdi) <span class="sc">&gt;</span> <span class="dv">2</span>) {</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>      fit <span class="ot">&lt;-</span> <span class="fu">SummarizeGrowth</span>(<span class="at">data_t =</span> xdi<span class="sc">$</span>DAP, </span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>                             <span class="at">data_n =</span> xdi<span class="sc">$</span>Value_f,</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>                             <span class="at">bg_correct =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>      <span class="co">#</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>      <span class="fu">suppressMessages</span>( xgi <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(xgi, <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">c</span>(i, <span class="fu">unlist</span>(fit<span class="sc">$</span>vals))))) )</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>      <span class="co">#</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>      xgi <span class="ot">&lt;-</span> xgi <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">y0=</span>n0, <span class="at">y0_se=</span>n0_se, <span class="at">y0_p=</span>n0_p, <span class="at">x_mid=</span>t_mid)</span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(xgi)<span class="sc">-</span><span class="dv">1</span>)) { xgi[,k] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(xgi[,k]) }</span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a>      xgi <span class="ot">&lt;-</span> xgi <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y_mid =</span> k<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> ((k <span class="sc">-</span> y0)<span class="sc">/</span>y0) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> x_mid)),</span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a>                          <span class="at">b =</span> <span class="sc">-</span>((r <span class="sc">*</span> x_mid) <span class="sc">-</span> y_mid) )</span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a>      <span class="co">#</span></span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a>      myDays <span class="ot">&lt;-</span> <span class="fu">min</span>(xd<span class="sc">$</span>DAP)<span class="sc">:</span><span class="fu">max</span>(xd<span class="sc">$</span>DAP)</span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a>      xpi <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Plot =</span> i, <span class="at">DAP =</span> myDays,</span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a>                       <span class="at">Predicted.Values =</span> xgi<span class="sc">$</span>k<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> ((xgi<span class="sc">$</span>k <span class="sc">-</span> xgi<span class="sc">$</span>y0)<span class="sc">/</span>xgi<span class="sc">$</span>y0) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>xgi<span class="sc">$</span>r <span class="sc">*</span> myDays)))</span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a>      xp <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(xp, xpi)</span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a>      <span class="co">#</span></span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a>      gdays <span class="ot">&lt;-</span> xpi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(DAP <span class="sc">&gt;</span> (xgi<span class="sc">$</span>x_mid <span class="sc">-</span> <span class="dv">3</span>), DAP <span class="sc">&lt;</span> (xgi<span class="sc">$</span>x_mid <span class="sc">+</span> <span class="dv">3</span>))</span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">nrow</span>(gdays)<span class="sc">&gt;</span><span class="dv">0</span>) {</span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a>        myLM <span class="ot">&lt;-</span> <span class="fu">lm</span>(Predicted.Values <span class="sc">~</span> DAP, gdays)</span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a>        xgi <span class="ot">&lt;-</span> xgi <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">g.b =</span> myLM[[<span class="dv">1</span>]][<span class="dv">1</span>],</span>
<span id="cb16-37"><a href="#cb16-37" tabindex="-1"></a>                              <span class="at">g.r =</span> myLM[[<span class="dv">1</span>]][<span class="dv">2</span>] )</span>
<span id="cb16-38"><a href="#cb16-38" tabindex="-1"></a>      }</span>
<span id="cb16-39"><a href="#cb16-39" tabindex="-1"></a>      <span class="co">#</span></span>
<span id="cb16-40"><a href="#cb16-40" tabindex="-1"></a>      xpi_max <span class="ot">&lt;-</span> xpi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Predicted.Values <span class="sc">&gt;=</span> xgi<span class="sc">$</span>k<span class="sc">*</span><span class="fl">0.95</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Predicted.Values) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb16-41"><a href="#cb16-41" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">nrow</span>(xpi_max)<span class="sc">==</span><span class="dv">0</span>) { </span>
<span id="cb16-42"><a href="#cb16-42" tabindex="-1"></a>        xpi_max <span class="ot">&lt;-</span> xpi <span class="sc">%&gt;%</span> </span>
<span id="cb16-43"><a href="#cb16-43" tabindex="-1"></a>          <span class="fu">filter</span>(Predicted.Values <span class="sc">&gt;=</span> xgi<span class="sc">$</span>k<span class="sc">*</span><span class="fl">0.94</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-44"><a href="#cb16-44" tabindex="-1"></a>          <span class="fu">arrange</span>(Predicted.Values) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) </span>
<span id="cb16-45"><a href="#cb16-45" tabindex="-1"></a>      }</span>
<span id="cb16-46"><a href="#cb16-46" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">nrow</span>(xpi_max)<span class="sc">==</span><span class="dv">0</span>) { </span>
<span id="cb16-47"><a href="#cb16-47" tabindex="-1"></a>        xpi_max <span class="ot">&lt;-</span> xpi <span class="sc">%&gt;%</span> </span>
<span id="cb16-48"><a href="#cb16-48" tabindex="-1"></a>          <span class="fu">filter</span>(Predicted.Values <span class="sc">&gt;=</span> xgi<span class="sc">$</span>k<span class="sc">*</span><span class="fl">0.90</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-49"><a href="#cb16-49" tabindex="-1"></a>          <span class="fu">arrange</span>(Predicted.Values) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) </span>
<span id="cb16-50"><a href="#cb16-50" tabindex="-1"></a>      }</span>
<span id="cb16-51"><a href="#cb16-51" tabindex="-1"></a>      xpi_min <span class="ot">&lt;-</span> xpi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Predicted.Values <span class="sc">&gt;=</span> xgi<span class="sc">$</span>k<span class="sc">*</span><span class="fl">0.05</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Predicted.Values) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb16-52"><a href="#cb16-52" tabindex="-1"></a>      xgi<span class="sc">$</span>x.max <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(<span class="fu">nrow</span>(xpi_max)), <span class="fu">max</span>(xpi<span class="sc">$</span>DAP), xpi_max<span class="sc">$</span>DAP)</span>
<span id="cb16-53"><a href="#cb16-53" tabindex="-1"></a>      xgi<span class="sc">$</span>x.min <span class="ot">&lt;-</span> xpi_min<span class="sc">$</span>DAP</span>
<span id="cb16-54"><a href="#cb16-54" tabindex="-1"></a>      xgi<span class="sc">$</span>x.d <span class="ot">&lt;-</span> xgi<span class="sc">$</span>x.max <span class="sc">-</span> xgi<span class="sc">$</span>x_mid </span>
<span id="cb16-55"><a href="#cb16-55" tabindex="-1"></a>      xg <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(xg, xgi)</span>
<span id="cb16-56"><a href="#cb16-56" tabindex="-1"></a>    }</span>
<span id="cb16-57"><a href="#cb16-57" tabindex="-1"></a>  }</span>
<span id="cb16-58"><a href="#cb16-58" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb16-59"><a href="#cb16-59" tabindex="-1"></a>  xg[xg<span class="sc">==</span><span class="st">&quot;0&quot;</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb16-60"><a href="#cb16-60" tabindex="-1"></a>  xg <span class="ot">&lt;-</span> xg <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Plot=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-61"><a href="#cb16-61" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Plot =</span> <span class="fu">as.integer</span>(Plot)) <span class="sc">%&gt;%</span></span>
<span id="cb16-62"><a href="#cb16-62" tabindex="-1"></a>    <span class="fu">left_join</span>(xm, <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-63"><a href="#cb16-63" tabindex="-1"></a>    <span class="fu">select</span>(Plot, Rep, Entry, Name, Expt, Planting.Date,</span>
<span id="cb16-64"><a href="#cb16-64" tabindex="-1"></a>           r, b, g.r, g.b, k, x.min, <span class="at">x.mid=</span>x_mid, x.max, </span>
<span id="cb16-65"><a href="#cb16-65" tabindex="-1"></a>           x.d, <span class="at">x.gen=</span>t_gen, <span class="at">auc.l=</span>auc_l, <span class="at">auc.e=</span>auc_e, y0, sigma, </span>
<span id="cb16-66"><a href="#cb16-66" tabindex="-1"></a>           <span class="at">r.se=</span>r_se, <span class="at">r.p=</span>r_p, <span class="at">k.se=</span>k_se, <span class="at">k.p=</span>k_p, <span class="at">y0.se=</span>y0_se, <span class="at">y0.p=</span>y0_p, df, note)</span>
<span id="cb16-67"><a href="#cb16-67" tabindex="-1"></a>  xp <span class="ot">&lt;-</span> xp <span class="sc">%&gt;%</span> </span>
<span id="cb16-68"><a href="#cb16-68" tabindex="-1"></a>    <span class="fu">left_join</span>(xm, <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-69"><a href="#cb16-69" tabindex="-1"></a>    <span class="fu">select</span>(Plot, Rep, Entry, Name, Expt, Planting.Date, DAP, Predicted.Values)</span>
<span id="cb16-70"><a href="#cb16-70" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb16-71"><a href="#cb16-71" tabindex="-1"></a>  yMax <span class="ot">&lt;-</span> <span class="fu">max</span>(xd<span class="sc">$</span>Value_f, <span class="at">na.rm =</span> T)</span>
<span id="cb16-72"><a href="#cb16-72" tabindex="-1"></a>  xMax <span class="ot">&lt;-</span> <span class="fu">max</span>(xd<span class="sc">$</span>DAP, <span class="at">na.rm =</span> T)</span>
<span id="cb16-73"><a href="#cb16-73" tabindex="-1"></a>  xpm <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb16-74"><a href="#cb16-74" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb16-75"><a href="#cb16-75" tabindex="-1"></a>  <span class="cf">if</span>(myOrder <span class="sc">==</span> <span class="st">&quot;Entries&quot;</span>) { myOrders <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">324</span> }</span>
<span id="cb16-76"><a href="#cb16-76" tabindex="-1"></a>  <span class="cf">if</span>(myOrder <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>) { myOrders <span class="ot">&lt;-</span> xg <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(k) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Entries) <span class="sc">%&gt;%</span> <span class="fu">unique</span>() }</span>
<span id="cb16-77"><a href="#cb16-77" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb16-78"><a href="#cb16-78" tabindex="-1"></a>  <span class="fu">pdf</span>(<span class="fu">paste0</span>(myFolder, <span class="st">&quot;PDF_&quot;</span>, myFilename, <span class="st">&quot;.pdf&quot;</span>), <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb16-79"><a href="#cb16-79" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> myOrders) {</span>
<span id="cb16-80"><a href="#cb16-80" tabindex="-1"></a>    xdi <span class="ot">&lt;-</span> xd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Entry <span class="sc">==</span> i, <span class="sc">!</span><span class="fu">is.na</span>(Value_f))</span>
<span id="cb16-81"><a href="#cb16-81" tabindex="-1"></a>    xfi <span class="ot">&lt;-</span> xf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Entry <span class="sc">==</span> i)</span>
<span id="cb16-82"><a href="#cb16-82" tabindex="-1"></a>    xgi <span class="ot">&lt;-</span> xg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Entry <span class="sc">==</span> i)</span>
<span id="cb16-83"><a href="#cb16-83" tabindex="-1"></a>    xpi <span class="ot">&lt;-</span> xp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Entry <span class="sc">==</span> i)</span>
<span id="cb16-84"><a href="#cb16-84" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb16-85"><a href="#cb16-85" tabindex="-1"></a>    xpmi <span class="ot">&lt;-</span> xpi <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Entry, Name, DAP) <span class="sc">%&gt;%</span></span>
<span id="cb16-86"><a href="#cb16-86" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">Predicted.Values =</span> <span class="fu">mean</span>(Predicted.Values, <span class="at">na.rm =</span> T))</span>
<span id="cb16-87"><a href="#cb16-87" tabindex="-1"></a>    xpm <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(xpm, xpmi)</span>
<span id="cb16-88"><a href="#cb16-88" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb16-89"><a href="#cb16-89" tabindex="-1"></a>    xdtf <span class="ot">&lt;-</span> xfi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>) </span>
<span id="cb16-90"><a href="#cb16-90" tabindex="-1"></a>    xdtm <span class="ot">&lt;-</span> xfi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTM&quot;</span>) </span>
<span id="cb16-91"><a href="#cb16-91" tabindex="-1"></a>    xdtf2 <span class="ot">&lt;-</span> xdtf <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Entry) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span>T))</span>
<span id="cb16-92"><a href="#cb16-92" tabindex="-1"></a>    xdtm2 <span class="ot">&lt;-</span> xdtm <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Entry) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span>T))</span>
<span id="cb16-93"><a href="#cb16-93" tabindex="-1"></a>    myDays <span class="ot">&lt;-</span> <span class="fu">min</span>(xdi<span class="sc">$</span>DAP)<span class="sc">:</span><span class="fu">max</span>(xdi<span class="sc">$</span>DAP)  </span>
<span id="cb16-94"><a href="#cb16-94" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb16-95"><a href="#cb16-95" tabindex="-1"></a>    myTitle <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">paste</span>(stringr<span class="sc">::</span><span class="fu">str_pad</span>(xdi<span class="sc">$</span>Entry, <span class="dv">3</span>, <span class="at">pad =</span> <span class="st">&quot;0&quot;</span>), <span class="st">&quot;|&quot;</span>, xdi<span class="sc">$</span>Name))</span>
<span id="cb16-96"><a href="#cb16-96" tabindex="-1"></a>    <span class="co"># Plot</span></span>
<span id="cb16-97"><a href="#cb16-97" tabindex="-1"></a>    mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xdi, <span class="fu">aes</span>(<span class="at">x =</span> DAP)) <span class="sc">+</span></span>
<span id="cb16-98"><a href="#cb16-98" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">data =</span> xdtf, <span class="fu">aes</span>(<span class="at">xintercept =</span> Value), <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-99"><a href="#cb16-99" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">data =</span> xdtm, <span class="fu">aes</span>(<span class="at">xintercept =</span> Value), <span class="at">color =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-100"><a href="#cb16-100" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value_f), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb16-101"><a href="#cb16-101" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-102"><a href="#cb16-102" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> xpi, <span class="fu">aes</span>(<span class="at">y =</span> Predicted.Values), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb16-103"><a href="#cb16-103" tabindex="-1"></a>      <span class="fu">facet_grid</span>(. <span class="sc">~</span> <span class="fu">paste</span>(Rep, Plot, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>)) <span class="sc">+</span></span>
<span id="cb16-104"><a href="#cb16-104" tabindex="-1"></a>      <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,yMax), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,xMax)) <span class="sc">+</span></span>
<span id="cb16-105"><a href="#cb16-105" tabindex="-1"></a>      theme_AGL <span class="sc">+</span></span>
<span id="cb16-106"><a href="#cb16-106" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> myTitle, <span class="at">y =</span> myTrait)</span>
<span id="cb16-107"><a href="#cb16-107" tabindex="-1"></a>    mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xpi, <span class="fu">aes</span>(<span class="at">x =</span> DAP, <span class="at">y =</span> Predicted.Values)) <span class="sc">+</span></span>
<span id="cb16-108"><a href="#cb16-108" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">data =</span> xdtf2, <span class="fu">aes</span>(<span class="at">xintercept =</span> Value), <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-109"><a href="#cb16-109" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">data =</span> xdtm2, <span class="fu">aes</span>(<span class="at">xintercept =</span> Value), <span class="at">color =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-110"><a href="#cb16-110" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="fu">aes</span>(<span class="at">group =</span> Plot)) <span class="sc">+</span></span>
<span id="cb16-111"><a href="#cb16-111" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> xpmi, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-112"><a href="#cb16-112" tabindex="-1"></a>      <span class="fu">facet_grid</span>(. <span class="sc">~</span> <span class="fu">paste</span>(<span class="st">&quot;Entry&quot;</span>,Entry)) <span class="sc">+</span></span>
<span id="cb16-113"><a href="#cb16-113" tabindex="-1"></a>      <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,yMax), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,xMax)) <span class="sc">+</span></span>
<span id="cb16-114"><a href="#cb16-114" tabindex="-1"></a>      theme_AGL <span class="sc">+</span></span>
<span id="cb16-115"><a href="#cb16-115" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb16-116"><a href="#cb16-116" tabindex="-1"></a>    <span class="co"># Append</span></span>
<span id="cb16-117"><a href="#cb16-117" tabindex="-1"></a>    mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>))</span>
<span id="cb16-118"><a href="#cb16-118" tabindex="-1"></a>    <span class="fu">print</span>(mp)</span>
<span id="cb16-119"><a href="#cb16-119" tabindex="-1"></a>  }</span>
<span id="cb16-120"><a href="#cb16-120" tabindex="-1"></a>  <span class="fu">dev.off</span>()</span>
<span id="cb16-121"><a href="#cb16-121" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb16-122"><a href="#cb16-122" tabindex="-1"></a>  <span class="fu">list</span>(xd, <span class="co"># Input data </span></span>
<span id="cb16-123"><a href="#cb16-123" tabindex="-1"></a>       xg, <span class="co"># Growth curve coefficients</span></span>
<span id="cb16-124"><a href="#cb16-124" tabindex="-1"></a>       xp, <span class="co"># Predicted Values</span></span>
<span id="cb16-125"><a href="#cb16-125" tabindex="-1"></a>       xpm) <span class="co"># Predicted Values (means)</span></span>
<span id="cb16-126"><a href="#cb16-126" tabindex="-1"></a>}</span>
<span id="cb16-127"><a href="#cb16-127" tabindex="-1"></a><span class="co"># Create function for plotting the growth curves</span></span>
<span id="cb16-128"><a href="#cb16-128" tabindex="-1"></a>ggGrowthCurve <span class="ot">&lt;-</span> <span class="cf">function</span>(xpm, <span class="at">myTitle =</span> <span class="cn">NULL</span>, </span>
<span id="cb16-129"><a href="#cb16-129" tabindex="-1"></a>                          <span class="at">myEntries =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">35</span>, <span class="dv">73</span>, <span class="dv">94</span>, <span class="dv">113</span>),</span>
<span id="cb16-130"><a href="#cb16-130" tabindex="-1"></a>                          <span class="at">myColors =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkgoldenrod3&quot;</span>, <span class="st">&quot;darkred&quot;</span>,</span>
<span id="cb16-131"><a href="#cb16-131" tabindex="-1"></a>                                       <span class="st">&quot;steelblue4&quot;</span>, <span class="st">&quot;darkslategray&quot;</span>) ) {</span>
<span id="cb16-132"><a href="#cb16-132" tabindex="-1"></a>  <span class="co"># Prep data</span></span>
<span id="cb16-133"><a href="#cb16-133" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">sum</span>(<span class="fu">colnames</span>(xpm)<span class="sc">==</span><span class="st">&quot;Expt&quot;</span>)<span class="sc">==</span><span class="dv">0</span>) { xpm <span class="ot">&lt;-</span> xpm <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Expt =</span> myTitle) }</span>
<span id="cb16-134"><a href="#cb16-134" tabindex="-1"></a>  xpe <span class="ot">&lt;-</span> xpm <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Entry <span class="sc">%in%</span> myEntries) <span class="sc">%&gt;%</span></span>
<span id="cb16-135"><a href="#cb16-135" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Entry =</span> <span class="fu">factor</span>(Entry, <span class="at">levels =</span> myEntries))</span>
<span id="cb16-136"><a href="#cb16-136" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb16-137"><a href="#cb16-137" tabindex="-1"></a>  mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xpm, <span class="fu">aes</span>(<span class="at">x =</span> DAP, <span class="at">y =</span> Predicted.Values, <span class="at">group =</span> Entry, <span class="at">key1 =</span> Name)) <span class="sc">+</span></span>
<span id="cb16-138"><a href="#cb16-138" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb16-139"><a href="#cb16-139" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> xpe, <span class="at">size =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">paste0</span>(Name,<span class="st">&quot; (&quot;</span>,Entry,<span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb16-140"><a href="#cb16-140" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> Expt, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">space =</span> <span class="st">&quot;free_x&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-141"><a href="#cb16-141" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> myColors) <span class="sc">+</span></span>
<span id="cb16-142"><a href="#cb16-142" tabindex="-1"></a>    theme_AGL <span class="sc">+</span> </span>
<span id="cb16-143"><a href="#cb16-143" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days After Planting&quot;</span>)</span>
<span id="cb16-144"><a href="#cb16-144" tabindex="-1"></a>  mp</span>
<span id="cb16-145"><a href="#cb16-145" tabindex="-1"></a>}</span></code></pre></div>
<div id="italy-2017-2" class="section level2">
<h2>Italy 2017</h2>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/PDF_It17_volume.pdf"
target="_blank">Additional/PDF_It17_volume.pdf</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/ggpGrowthCurves_It17_volume.html"
target="_blank">Additional/ggpGrowthCurves_It17_volume.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/ggGrowthCurves_It17_volume.png" /></p>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/PDF_It17_area.pdf"
target="_blank">Additional/PDF_It17_area.pdf</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/ggpGrowthCurves_It17_area.html"
target="_blank">Additional/ggpGrowthCurves_It17_area.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/ggGrowthCurves_It17_area.png" /></p>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/PDF_It17_height.pdf"
target="_blank">Additional/PDF_It17_height.pdf</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/ggpGrowthCurves_It17_height.html"
target="_blank">Additional/ggpGrowthCurves_It17_height.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/ggGrowthCurves_It17_height.png" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Volume</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>it17_gc.v <span class="ot">&lt;-</span> <span class="fu">myGrowthCurve</span>(<span class="at">xd =</span> it17_d, <span class="at">xf =</span> it17_f,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                           <span class="at">myFolder =</span> <span class="st">&quot;Additional/&quot;</span>, <span class="at">myFilename =</span> <span class="st">&quot;It17_volume&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                           <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.v[[<span class="dv">4</span>]], <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Volume&quot;</span>)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggGrowthCurves_It17_volume.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(mp)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="fu">saveWidget</span>(mp, <span class="at">file=</span><span class="st">&quot;Additional/ggpGrowthCurves_It17_volume.html&quot;</span>)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co"># Area</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>it17_gc.a <span class="ot">&lt;-</span> <span class="fu">myGrowthCurve</span>(<span class="at">xd =</span> it17_d, <span class="at">xf =</span> it17_f,</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>                           <span class="at">myFolder =</span> <span class="st">&quot;Additional/&quot;</span>, <span class="at">myFilename =</span> <span class="st">&quot;It17_area&quot;</span>,</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>                           <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>)</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.a[[<span class="dv">4</span>]], <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Area&quot;</span>)</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggGrowthCurves_It17_area.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(mp)</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="fu">saveWidget</span>(mp, <span class="at">file=</span><span class="st">&quot;Additional/ggpGrowthCurves_It17_area.html&quot;</span>)</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co"># Height</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>it17_gc.h <span class="ot">&lt;-</span> <span class="fu">myGrowthCurve</span>(<span class="at">xd =</span> it17_d, <span class="at">xf =</span> it17_f,</span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>                           <span class="at">myFolder =</span> <span class="st">&quot;Additional/&quot;</span>, <span class="at">myFilename =</span> <span class="st">&quot;It17_height&quot;</span>,</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>                           <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>)</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.h[[<span class="dv">4</span>]], <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Height&quot;</span>)</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggGrowthCurves_It17_height.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(mp)</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(mp, <span class="at">file=</span><span class="st">&quot;Additional/ggpGrowthCurves_It17_height.html&quot;</span>)</span></code></pre></div>
</div>
<div id="rosthern-2017-2" class="section level2">
<h2>Rosthern 2017</h2>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/PDF_Ro17_volume.pdf"
target="_blank">Additional/PDF_Ro17_volume.pdf</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/ggpGrowthCurves_Ro17_volume.html"
target="_blank">Additional/ggpGrowthCurves_Ro17_volume.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/ggGrowthCurves_Ro17_volume.png" /></p>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/PDF_Ro17_area.pdf"
target="_blank">Additional/PDF_Ro17_area.pdf</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/ggpGrowthCurves_Ro17_area.html"
target="_blank">Additional/ggpGrowthCurves_Ro17_area.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/ggGrowthCurves_Ro17_area.png" /></p>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/PDF_Ro17_height.pdf"
target="_blank">Additional/PDF_Ro17_height.pdf</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/ggpGrowthCurves_Ro17_height.html"
target="_blank">Additional/ggpGrowthCurves_Ro17_height.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/ggGrowthCurves_Ro17_height.png" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Volume</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>ro17_gc.v <span class="ot">&lt;-</span> <span class="fu">myGrowthCurve</span>(<span class="at">xd =</span> ro17_d, <span class="at">xf =</span> ro17_f,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>                           <span class="at">myFolder =</span> <span class="st">&quot;Additional/&quot;</span>, <span class="at">myFilename =</span> <span class="st">&quot;Ro17_volume&quot;</span>,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>                           <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> ro17_gc.v[[<span class="dv">4</span>]], <span class="at">myTitle =</span> <span class="st">&quot;Rosthern 2017 - Volume&quot;</span>)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggGrowthCurves_Ro17_volume.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>) </span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(mp)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(mp, <span class="at">file=</span><span class="st">&quot;Additional/ggpGrowthCurves_Ro17_volume.html&quot;</span>)</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co"># Area</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>ro17_gc.a <span class="ot">&lt;-</span> <span class="fu">myGrowthCurve</span>(<span class="at">xd =</span> ro17_d, <span class="at">xf =</span> ro17_f,</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>                           <span class="at">myFolder =</span> <span class="st">&quot;Additional/&quot;</span>, <span class="at">myFilename =</span> <span class="st">&quot;Ro17_area&quot;</span>,</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>                           <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>)</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> ro17_gc.a[[<span class="dv">4</span>]], <span class="at">myTitle =</span> <span class="st">&quot;Rosthern 2017 - Area&quot;</span>)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggGrowthCurves_Ro17_area.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>) </span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(mp)</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(mp, <span class="at">file=</span><span class="st">&quot;Additional/ggpGrowthCurves_Ro17_area.html&quot;</span>)</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co"># Height</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>ro17_gc.h <span class="ot">&lt;-</span> <span class="fu">myGrowthCurve</span>(<span class="at">xd =</span> ro17_d, <span class="at">xf =</span> ro17_f,</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>                           <span class="at">myFolder =</span> <span class="st">&quot;Additional/&quot;</span>, <span class="at">myFilename =</span> <span class="st">&quot;Ro17_height&quot;</span>,</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>                           <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>)</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> ro17_gc.h[[<span class="dv">4</span>]], <span class="at">myTitle =</span> <span class="st">&quot;Rosthern 2017 - Height&quot;</span>)</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggGrowthCurves_Ro17_height.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>) </span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(mp)</span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(mp, <span class="at">file=</span><span class="st">&quot;Additional/ggpGrowthCurves_Ro17_height.html&quot;</span>)</span></code></pre></div>
</div>
<div id="sutherland-2017-2" class="section level2">
<h2>Sutherland 2017</h2>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/PDF_Su17_volume.pdf"
target="_blank">Additional/PDF_Su17_volume.pdf</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/ggpGrowthCurves_Su17_volume.html"
target="_blank">Additional/ggpGrowthCurves_Su17_volume.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/ggGrowthCurves_Su17_volume.png" /></p>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/PDF_Su17_area.pdf"
target="_blank">Additional/PDF_Su17_area.pdf</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/ggpGrowthCurves_Su17_area.html"
target="_blank">Additional/ggpGrowthCurves_Su17_area.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/ggGrowthCurves_Su17_area.png" /></p>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/PDF_Su17_height.pdf"
target="_blank">Additional/PDF_Su17_height.pdf</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/ggpGrowthCurves_Su17_height.html"
target="_blank">Additional/ggpGrowthCurves_Su17_height.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/ggGrowthCurves_Su17_height.png" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Volume</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>su17_gc.v <span class="ot">&lt;-</span> <span class="fu">myGrowthCurve</span>(<span class="at">xd =</span> su17_d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Plot<span class="sc">!=</span><span class="dv">5604</span>), </span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>                           <span class="at">xf =</span> su17_f, </span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>                           <span class="at">myFolder =</span> <span class="st">&quot;Additional/&quot;</span>, <span class="at">myFilename =</span> <span class="st">&quot;Su17_volume&quot;</span>,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>                           <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.v[[<span class="dv">4</span>]], <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Volume&quot;</span>)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggGrowthCurves_Su17_volume.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(mp)</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(mp, <span class="at">file=</span><span class="st">&quot;Additional/ggpGrowthCurves_Su17_volume.html&quot;</span>)</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co"># Area</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>su17_gc.a <span class="ot">&lt;-</span> <span class="fu">myGrowthCurve</span>(<span class="at">xd =</span> su17_d, <span class="at">xf =</span> su17_f,</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>                           <span class="at">myFolder =</span> <span class="st">&quot;Additional/&quot;</span>, <span class="at">myFilename =</span> <span class="st">&quot;Su17_area&quot;</span>,</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>                           <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>)</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.a[[<span class="dv">4</span>]], <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Area&quot;</span>)</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggGrowthCurves_Su17_area.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(mp)</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(mp, <span class="at">file=</span><span class="st">&quot;Additional/ggpGrowthCurves_Su17_area.html&quot;</span>)</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co"># Height</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a>su17_gc.h <span class="ot">&lt;-</span> <span class="fu">myGrowthCurve</span>(<span class="at">xd =</span> su17_d, <span class="at">xf =</span> su17_f,</span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>                           <span class="at">myFolder =</span> <span class="st">&quot;Additional/&quot;</span>, <span class="at">myFilename =</span> <span class="st">&quot;Su17_height&quot;</span>,</span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>                           <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>)</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.h[[<span class="dv">4</span>]], <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Height&quot;</span>)</span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggGrowthCurves_Su17_height.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(mp)</span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(mp, <span class="at">file=</span><span class="st">&quot;Additional/ggpGrowthCurves_Su17_height.html&quot;</span>)</span></code></pre></div>
</div>
<div id="sutherland-2018-2" class="section level2">
<h2>Sutherland 2018</h2>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/PDF_Su18_volume.pdf"
target="_blank">Additional/PDF_Su18_volume.pdf</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/ggpGrowthCurves_Su18_volume.html"
target="_blank">Additional/ggpGrowthCurves_Su18_volume.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/ggGrowthCurves_Su18_volume.png" /></p>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/PDF_Su18_area.pdf"
target="_blank">Additional/PDF_Su18_area.pdf</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/ggpGrowthCurves_Su18_area.html"
target="_blank">Additional/ggpGrowthCurves_Su18_area.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/ggGrowthCurves_Su18_area.png" /></p>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/PDF_Su18_height.pdf"
target="_blank">Additional/PDF_Su18_height.pdf</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/ggpGrowthCurves_Su18_height.html"
target="_blank">Additional/ggpGrowthCurves_Su18_height.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/ggGrowthCurves_Su18_height.png" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Volume</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>su18_gc.v <span class="ot">&lt;-</span> <span class="fu">myGrowthCurve</span>(<span class="at">xd =</span> su18_d, <span class="at">xf =</span> su18_f, </span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>                           <span class="at">myFolder =</span> <span class="st">&quot;Additional/&quot;</span>, <span class="at">myFilename =</span> <span class="st">&quot;Su18_volume&quot;</span>,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>                           <span class="at">myTrait =</span> <span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su18_gc.v[[<span class="dv">4</span>]], <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2018 - Volume&quot;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggGrowthCurves_Su18_volume.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(mp)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(mp, <span class="at">file=</span><span class="st">&quot;Additional/ggpGrowthCurves_Su18_volume.html&quot;</span>)</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co"># Area</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>su18_gc.a <span class="ot">&lt;-</span> <span class="fu">myGrowthCurve</span>(<span class="at">xd =</span> su18_d, <span class="at">xf =</span> su18_f,</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>                           <span class="at">myFolder =</span> <span class="st">&quot;Additional/&quot;</span>, <span class="at">myFilename =</span> <span class="st">&quot;Su18_area&quot;</span>,</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>                           <span class="at">myTrait =</span> <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>)</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su18_gc.a[[<span class="dv">4</span>]], <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2018 - Area&quot;</span>)</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggGrowthCurves_Su18_area.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(mp)</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(mp, <span class="at">file=</span><span class="st">&quot;Additional/ggpGrowthCurves_Su18_area.html&quot;</span>)</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="co"># Height</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>su18_gc.h <span class="ot">&lt;-</span> <span class="fu">myGrowthCurve</span>(<span class="at">xd =</span> su18_d, <span class="at">xf =</span> su18_f,</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>                           <span class="at">myFolder =</span> <span class="st">&quot;Additional/&quot;</span>, <span class="at">myFilename =</span> <span class="st">&quot;Su18_height&quot;</span>,</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>                           <span class="at">myTrait =</span> <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>)</span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su18_gc.h[[<span class="dv">4</span>]], <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2018 - Height&quot;</span>)</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/ggGrowthCurves_Su18_height.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(mp)</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(mp, <span class="at">file=</span><span class="st">&quot;Additional/ggpGrowthCurves_Su18_height.html&quot;</span>)</span></code></pre></div>
<hr />
</div>
</div>
<div id="figure-1---envdata" class="section level1">
<h1>Figure 1 - EnvData</h1>
<p><img src="Figure_01.jpg" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>xE <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/derekmichaelwright/AGILE_LDP_Phenology/master/data/data_env.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Days After Planting</span><span class="st">`</span><span class="ot">=</span>DaysAfterPlanting) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="fu">filter</span>(Expt <span class="sc">%in%</span> myExpts1) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="fu">select</span>(Expt, <span class="st">`</span><span class="at">Days After Planting</span><span class="st">`</span>, DayLength, Temp_mean) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="fu">gather</span>(Trait, Value, DayLength, Temp_mean) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Unit =</span> <span class="fu">ifelse</span>(Trait <span class="sc">==</span> <span class="st">&quot;DayLength&quot;</span>, <span class="st">&quot;Hours&quot;</span>, <span class="st">&quot;Degrees Celcius&quot;</span>),</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>         <span class="at">Trait =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Trait, <span class="fu">c</span>(<span class="st">&quot;DayLength&quot;</span>, <span class="st">&quot;Temp_mean&quot;</span>), </span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>                                 <span class="fu">c</span>(<span class="st">&quot;DayLength&quot;</span>, <span class="st">&quot;Mean Temperature&quot;</span>)))</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>yy <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(it17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>),</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>                ro17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>),</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>                su17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>),</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>                su18_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>) ) <span class="sc">%&gt;%</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Expt, myExpts2, myExpts1)) <span class="sc">%&gt;%</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  <span class="fu">group_by</span>(Expt, Name) <span class="sc">%&gt;%</span> </span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T))</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(yy, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Expt)) <span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> myColors_Expt) <span class="sc">+</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">160</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;A) Days To Flower&quot;</span>, </span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Days After Planting&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>)</span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xE <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DayLength&quot;</span>), </span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Days After Planting</span><span class="st">`</span>, <span class="at">y =</span> Value, <span class="at">color =</span> Expt)) <span class="sc">+</span></span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Expt) <span class="sc">+</span></span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;B) Day Length&quot;</span>, </span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Hours&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Days After Planting&quot;</span>)</span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xE <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Mean Temperature&quot;</span>), </span>
<span id="cb21-37"><a href="#cb21-37" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Days After Planting</span><span class="st">`</span>, <span class="at">y =</span> Value, <span class="at">color =</span> Expt)) <span class="sc">+</span></span>
<span id="cb21-38"><a href="#cb21-38" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-39"><a href="#cb21-39" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Expt) <span class="sc">+</span></span>
<span id="cb21-40"><a href="#cb21-40" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb21-41"><a href="#cb21-41" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-42"><a href="#cb21-42" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;C) Mean Temperature&quot;</span>, </span>
<span id="cb21-43"><a href="#cb21-43" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Degrees Celcius&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Days After Planting&quot;</span>)</span>
<span id="cb21-44"><a href="#cb21-44" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb21-45"><a href="#cb21-45" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, <span class="fu">ggarrange</span>(mp2, mp3, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>, </span>
<span id="cb21-46"><a href="#cb21-46" tabindex="-1"></a>                               <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>), </span>
<span id="cb21-47"><a href="#cb21-47" tabindex="-1"></a>                <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.75</span>,<span class="dv">1</span>) )</span>
<span id="cb21-48"><a href="#cb21-48" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Figure_01.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="figure-2---growth-curve-coefficients" class="section level1">
<h1>Figure 2 - Growth Curve Coefficients</h1>
<p><img src="Figure_02.jpg" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Create plotting function</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>ggGrowthCoefs <span class="ot">&lt;-</span> <span class="cf">function</span>(xd, xf, myPlot, <span class="at">myYmax =</span> <span class="cn">NULL</span>, </span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>                          <span class="at">minDAP =</span> <span class="cn">NULL</span>, <span class="at">maxDAP =</span> <span class="cn">NULL</span>, </span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>                          <span class="at">myTitle =</span> <span class="cn">NULL</span>, <span class="at">mySubtitle =</span> F) {</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  <span class="co"># Prep data</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(minDAP)) { minDAP <span class="ot">&lt;-</span> <span class="fu">min</span>(xd[[<span class="dv">3</span>]]<span class="sc">$</span>DAP) }</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(maxDAP)) { maxDAP <span class="ot">&lt;-</span> <span class="fu">max</span>(xd[[<span class="dv">3</span>]]<span class="sc">$</span>DAP) }</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(myYmax)) { myYmax <span class="ot">&lt;-</span> <span class="fu">max</span>(xd[[<span class="dv">2</span>]]<span class="sc">$</span>k) }</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> xd[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Plot <span class="sc">==</span> myPlot)</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> xd[[<span class="dv">3</span>]] <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Plot <span class="sc">==</span> myPlot)</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>  <span class="cf">if</span>(mySubtitle <span class="sc">==</span> T) { </span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>    mySubtitle <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Plot&quot;</span>, x1<span class="sc">$</span>Plot, <span class="st">&quot;| Entry&quot;</span>, x1<span class="sc">$</span>Entry, <span class="st">&quot;|&quot;</span>,  x1<span class="sc">$</span>Name) </span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>  } <span class="cf">else</span> { mySubtitle <span class="ot">&lt;-</span> <span class="cn">NULL</span> }</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>  <span class="fu">ggplot</span>(x1) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> x2, <span class="fu">aes</span>(<span class="at">x =</span> DAP, <span class="at">y =</span> Predicted.Values), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> k, <span class="at">color =</span> <span class="st">&quot;k&quot;</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> g.r, <span class="at">intercept =</span> g.b, <span class="at">color =</span> <span class="st">&quot;g.r&quot;</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x.mid, <span class="at">y =</span> k<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x.min), <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> x.min), <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.01</span>, <span class="at">label =</span> <span class="st">&quot;x.min&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="fu">aes</span>(<span class="at">x =</span> x.mid, <span class="at">xend =</span> x.mid, <span class="at">yend =</span> k<span class="sc">/</span><span class="dv">2</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="fu">aes</span>(<span class="at">x =</span> x.mid)) <span class="sc">+</span></span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">y =</span> <span class="sc">-</span><span class="fl">0.01</span>, <span class="fu">aes</span>(<span class="at">x =</span> x.mid, <span class="at">label =</span> <span class="st">&quot;x.mid&quot;</span>)) <span class="sc">+</span></span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="fu">aes</span>(<span class="at">x =</span> x.max, <span class="at">xend =</span> x.max, <span class="at">yend =</span> k), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x.max, <span class="at">y =</span> k)) <span class="sc">+</span></span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x.max, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> x.max, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.01</span>), <span class="at">label =</span> <span class="st">&quot;x.max&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x.mid, <span class="at">xend =</span> x.max, <span class="at">y =</span> k<span class="sc">/</span><span class="dv">10</span>, <span class="at">yend =</span> k<span class="sc">/</span><span class="dv">10</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> x.max<span class="sc">-</span>((x.max<span class="sc">-</span>x.mid)<span class="sc">/</span><span class="dv">2</span>), <span class="at">y =</span> <span class="fl">1.5</span><span class="sc">*</span>k<span class="sc">/</span><span class="dv">10</span>), <span class="at">label =</span> <span class="st">&quot;x.d&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb22-41"><a href="#cb22-41" tabindex="-1"></a>    theme_AGL <span class="sc">+</span></span>
<span id="cb22-42"><a href="#cb22-42" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;Coeff&quot;</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;r&quot;</span>,<span class="st">&quot;g.r&quot;</span>),</span>
<span id="cb22-43"><a href="#cb22-43" tabindex="-1"></a>                       <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;purple&quot;</span>,<span class="st">&quot;steelblue&quot;</span>,<span class="st">&quot;darkgreen&quot;</span>)) <span class="sc">+</span></span>
<span id="cb22-44"><a href="#cb22-44" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(minDAP, maxDAP), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb22-45"><a href="#cb22-45" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.01</span>, myYmax)) <span class="sc">+</span></span>
<span id="cb22-46"><a href="#cb22-46" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> myTitle, <span class="at">subtitle =</span> mySubtitle,</span>
<span id="cb22-47"><a href="#cb22-47" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Predicted Value (y)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Days After Planting (x)&quot;</span>,</span>
<span id="cb22-48"><a href="#cb22-48" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">&quot;y = k / (1 + ((k - y0) / y0) * exp(-g.r * x))&quot;</span>)</span>
<span id="cb22-49"><a href="#cb22-49" tabindex="-1"></a>}</span>
<span id="cb22-50"><a href="#cb22-50" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-51"><a href="#cb22-51" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggGrowthCoefs</span>(<span class="at">xd =</span> ro17_gc.v, <span class="at">xf =</span> ro17_f, <span class="at">myPlot =</span> <span class="dv">6322</span>, </span>
<span id="cb22-52"><a href="#cb22-52" tabindex="-1"></a>                     <span class="at">myYmax =</span> <span class="fl">0.175</span>, <span class="at">minDAP =</span> <span class="dv">20</span>, <span class="at">maxDAP =</span> <span class="dv">65</span>)</span>
<span id="cb22-53"><a href="#cb22-53" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Figure_02.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
<hr />
<div id="additional-figures-1---growth-curve-coefficients"
class="section level2">
<h2>Additional Figures 1 - Growth Curve Coefficients</h2>
<p><img src="Additional/Additional_Figure_01_1.png" /></p>
<p><img src="Additional/Additional_Figure_01_2.png" /></p>
<p><img src="Additional/Additional_Figure_01_3.png" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Italy - Entry 221 vs 295</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCoefs</span>(<span class="at">xd =</span> it17_gc.v, <span class="at">xf =</span> it17_f, <span class="at">myPlot =</span> <span class="dv">229</span>, </span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Entry 221&quot;</span>,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>                     <span class="at">myYmax =</span> <span class="fl">0.5</span>, <span class="at">minDAP =</span> <span class="dv">100</span>, <span class="at">maxDAP =</span> <span class="dv">145</span>)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCoefs</span>(<span class="at">xd =</span> it17_gc.v, <span class="at">xf =</span> it17_f, <span class="at">myPlot =</span> <span class="dv">225</span>, </span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Entry 295&quot;</span>, </span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>                     <span class="at">myYmax =</span> <span class="fl">0.5</span>, <span class="at">minDAP =</span> <span class="dv">100</span>, <span class="at">maxDAP =</span> <span class="dv">145</span>)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_01_1.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co"># Rosthern - Entry 76 vs 94</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCoefs</span>(<span class="at">xd =</span> ro17_gc.v, <span class="at">xf =</span> ro17_f, <span class="at">myPlot =</span> <span class="dv">6986</span>, </span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Rosthern 2017 - Entry 76&quot;</span>, </span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>                     <span class="at">myYmax =</span> <span class="fl">0.25</span>, <span class="at">minDAP =</span> <span class="dv">25</span>, <span class="at">maxDAP =</span> <span class="dv">65</span>)</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCoefs</span>(<span class="at">xd =</span> ro17_gc.v, <span class="at">xf =</span> ro17_f, <span class="at">myPlot =</span> <span class="dv">6322</span>, </span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Rosthern 2017 - Entry 94&quot;</span>,</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>                     <span class="at">myYmax =</span> <span class="fl">0.25</span>, <span class="at">minDAP =</span> <span class="dv">25</span>, <span class="at">maxDAP =</span> <span class="dv">65</span>)</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_01_2.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co"># Entry 107 - Italy vs Rosthern</span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCoefs</span>(<span class="at">xd =</span> it17_gc.v, <span class="at">xf =</span> it17_f, <span class="at">myPlot =</span> <span class="dv">242</span>, </span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Entry 107&quot;</span>, </span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a>                     <span class="at">myYmax =</span> <span class="fl">0.45</span>, <span class="at">minDAP =</span> <span class="dv">0</span>, <span class="at">maxDAP =</span> <span class="dv">155</span>)</span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCoefs</span>(<span class="at">xd =</span> ro17_gc.v, <span class="at">xf =</span> ro17_f, <span class="at">myPlot =</span> <span class="dv">6380</span>, </span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Rosthern 2017 - Entry 107&quot;</span>,</span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a>                     <span class="at">myYmax =</span> <span class="fl">0.45</span>, <span class="at">minDAP =</span> <span class="dv">0</span>, <span class="at">maxDAP =</span> <span class="dv">155</span>)</span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_01_3.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code></pre></div>
<hr />
</div>
</div>
<div id="supplemental-figure-1---drone-data" class="section level1">
<h1>Supplemental Figure 1 - Drone Data</h1>
<p><img src="Supplemental_Figure_01.jpg" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Create plotting function</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>ggDroneTrait <span class="ot">&lt;-</span> <span class="cf">function</span>(xx, myTitle, <span class="at">myDAPs =</span> <span class="cn">NULL</span>, myTraits, </span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>                         <span class="at">myTraitNames =</span> myTraits ) {</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  <span class="co"># Prep data</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(myDAPs)) { myDAPs <span class="ot">&lt;-</span> <span class="fu">unique</span>(xx<span class="sc">$</span>DAP)[<span class="fu">order</span>(<span class="fu">unique</span>(xx<span class="sc">$</span>DAP))] }</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">%in%</span> myTraits, DAP <span class="sc">%in%</span> myDAPs) <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Trait =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Trait, myTraits, myTraitNames),</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>           <span class="at">Trait =</span> <span class="fu">factor</span>(Trait, <span class="at">levels =</span> myTraitNames),</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>           <span class="at">Rep =</span> <span class="fu">factor</span>(Rep),</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>           <span class="at">DAP =</span> <span class="fu">paste</span>(<span class="st">&quot;DAP&quot;</span>, DAP),</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>           <span class="at">DAP =</span> <span class="fu">factor</span>(DAP, <span class="at">levels =</span> <span class="fu">paste</span>(<span class="st">&quot;DAP&quot;</span>, myDAPs)) ) <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value_f), <span class="sc">!</span><span class="fu">is.na</span>(Value))</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Rep, <span class="at">color =</span> Rep, <span class="at">pch =</span> Rep)) <span class="sc">+</span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>    <span class="fu">geom_quasirandom</span>(<span class="fu">aes</span>(<span class="at">y =</span> Value_f), <span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>    <span class="fu">facet_grid</span>(Trait <span class="sc">~</span> DAP, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkslategray&quot;</span>,<span class="st">&quot;slategray4&quot;</span>,<span class="st">&quot;darkslategray4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">15</span>,<span class="dv">18</span>)) <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> .)) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a>    theme_AGL <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.placement =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a>          <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> myTitle, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="cn">NULL</span>, </span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Number of data points =&quot;</span>, <span class="fu">nrow</span>(xx)))</span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a>}</span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a><span class="co"># Italy 2017</span></span>
<span id="cb24-29"><a href="#cb24-29" tabindex="-1"></a>xx <span class="ot">&lt;-</span> it17_d <span class="sc">%&gt;%</span></span>
<span id="cb24-30"><a href="#cb24-30" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DAP =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(DAP, <span class="fu">c</span>(<span class="dv">93</span>, <span class="dv">101</span>, <span class="dv">119</span>, <span class="dv">133</span>, <span class="dv">163</span>), </span>
<span id="cb24-31"><a href="#cb24-31" tabindex="-1"></a>                                    <span class="fu">c</span>(<span class="dv">94</span>, <span class="dv">100</span>, <span class="dv">118</span>, <span class="dv">132</span>, <span class="dv">164</span>)))</span>
<span id="cb24-32"><a href="#cb24-32" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggDroneTrait</span>(<span class="at">xx =</span> xx, <span class="at">myTitle =</span> <span class="st">&quot;A) Metaponto, Italy 2017 (It17)&quot;</span>, </span>
<span id="cb24-33"><a href="#cb24-33" tabindex="-1"></a>                   <span class="at">myDAPs =</span> <span class="fu">c</span>(<span class="dv">94</span>,<span class="dv">100</span>,<span class="dv">118</span>,<span class="dv">132</span>,<span class="dv">164</span>),</span>
<span id="cb24-34"><a href="#cb24-34" tabindex="-1"></a>                   <span class="at">myTraits =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>,</span>
<span id="cb24-35"><a href="#cb24-35" tabindex="-1"></a>                                <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>,</span>
<span id="cb24-36"><a href="#cb24-36" tabindex="-1"></a>                                <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>),</span>
<span id="cb24-37"><a href="#cb24-37" tabindex="-1"></a>                   <span class="at">myTraitNames =</span> <span class="fu">c</span>(<span class="st">&quot;Volume&quot;</span>, <span class="st">&quot;Height&quot;</span>, <span class="st">&quot;Area&quot;</span>))</span>
<span id="cb24-38"><a href="#cb24-38" tabindex="-1"></a><span class="co"># Rosthern 2017</span></span>
<span id="cb24-39"><a href="#cb24-39" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggDroneTrait</span>(<span class="at">xx =</span> ro17_d, <span class="at">myTitle =</span> <span class="st">&quot;B) Rosthern, Canada 2017 (Ro17)&quot;</span>, </span>
<span id="cb24-40"><a href="#cb24-40" tabindex="-1"></a>                   <span class="at">myDAPs =</span> <span class="fu">c</span>(<span class="dv">24</span>,<span class="dv">32</span>,<span class="dv">40</span>,<span class="dv">54</span>,<span class="dv">61</span>,<span class="dv">67</span>,<span class="dv">74</span>,<span class="dv">80</span>,<span class="dv">89</span>,<span class="dv">95</span>),</span>
<span id="cb24-41"><a href="#cb24-41" tabindex="-1"></a>                   <span class="at">myTraits =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>,</span>
<span id="cb24-42"><a href="#cb24-42" tabindex="-1"></a>                                <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>,</span>
<span id="cb24-43"><a href="#cb24-43" tabindex="-1"></a>                                <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>),</span>
<span id="cb24-44"><a href="#cb24-44" tabindex="-1"></a>                   <span class="at">myTraitNames =</span> <span class="fu">c</span>(<span class="st">&quot;Volume&quot;</span>, <span class="st">&quot;Height&quot;</span>, <span class="st">&quot;Area&quot;</span>))</span>
<span id="cb24-45"><a href="#cb24-45" tabindex="-1"></a><span class="co"># Sutherland 2017</span></span>
<span id="cb24-46"><a href="#cb24-46" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggDroneTrait</span>(<span class="at">xx =</span> su17_d, <span class="at">myTitle =</span> <span class="st">&quot;C) Sutherland, Canada 2017 (Su17)&quot;</span>, </span>
<span id="cb24-47"><a href="#cb24-47" tabindex="-1"></a>                   <span class="at">myDAPs =</span> <span class="fu">c</span>(<span class="dv">32</span>,<span class="dv">40</span>,<span class="dv">46</span>,<span class="dv">51</span>,<span class="dv">57</span>,<span class="dv">61</span>,<span class="dv">68</span>,<span class="dv">72</span>,<span class="dv">75</span>,<span class="dv">77</span>,<span class="dv">83</span>),</span>
<span id="cb24-48"><a href="#cb24-48" tabindex="-1"></a>                   <span class="at">myTraits =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>,</span>
<span id="cb24-49"><a href="#cb24-49" tabindex="-1"></a>                                <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>,</span>
<span id="cb24-50"><a href="#cb24-50" tabindex="-1"></a>                                <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>),</span>
<span id="cb24-51"><a href="#cb24-51" tabindex="-1"></a>                   <span class="at">myTraitNames =</span> <span class="fu">c</span>(<span class="st">&quot;Volume&quot;</span>, <span class="st">&quot;Height&quot;</span>, <span class="st">&quot;Area&quot;</span>))</span>
<span id="cb24-52"><a href="#cb24-52" tabindex="-1"></a><span class="co"># Sutherland 2018</span></span>
<span id="cb24-53"><a href="#cb24-53" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggDroneTrait</span>(<span class="at">xx =</span> su18_d, <span class="at">myTitle =</span> <span class="st">&quot;D) Sutherland, Canada 2018 (Su18)&quot;</span>, </span>
<span id="cb24-54"><a href="#cb24-54" tabindex="-1"></a>                   <span class="at">myDAPs =</span> <span class="fu">c</span>(<span class="dv">42</span>,<span class="dv">55</span>,<span class="dv">58</span>,<span class="dv">61</span>,<span class="dv">65</span>,<span class="dv">68</span>,<span class="dv">72</span>,<span class="dv">76</span>,<span class="dv">79</span>,<span class="dv">86</span>),</span>
<span id="cb24-55"><a href="#cb24-55" tabindex="-1"></a>                   <span class="at">myTraits =</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>,</span>
<span id="cb24-56"><a href="#cb24-56" tabindex="-1"></a>                                <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>,</span>
<span id="cb24-57"><a href="#cb24-57" tabindex="-1"></a>                                <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>),</span>
<span id="cb24-58"><a href="#cb24-58" tabindex="-1"></a>                   <span class="at">myTraitNames =</span> <span class="fu">c</span>(<span class="st">&quot;Volume&quot;</span>, <span class="st">&quot;Height&quot;</span>, <span class="st">&quot;Area&quot;</span>))</span>
<span id="cb24-59"><a href="#cb24-59" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb24-60"><a href="#cb24-60" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, mp4, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">4</span>, </span>
<span id="cb24-61"><a href="#cb24-61" tabindex="-1"></a>                <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb24-62"><a href="#cb24-62" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Supplemental_Figure_01.jpg&quot;</span>, mp, </span>
<span id="cb24-63"><a href="#cb24-63" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">11</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="Additional/Supplemental_Figure_01_A.png" /></p>
<p><img src="Additional/Supplemental_Figure_01_B.png" /></p>
<p><img src="Additional/Supplemental_Figure_01_C.png" /></p>
<p><img src="Additional/Supplemental_Figure_01_D.png" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Supplemental_Figure_01_A.png&quot;</span>, mp1, <span class="at">width =</span> <span class="dv">8</span>,  <span class="at">height =</span> <span class="fl">3.5</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Supplemental_Figure_01_B.png&quot;</span>, mp2, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="fl">3.5</span>)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Supplemental_Figure_01_C.png&quot;</span>, mp3, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="fl">3.5</span>)</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Supplemental_Figure_01_D.png&quot;</span>, mp4, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="fl">3.5</span>)</span></code></pre></div>
<hr />
</div>
<div id="supplemental-figure-2---correlation-plots"
class="section level1">
<h1>Supplemental Figure 2 - Correlation Plots</h1>
<p><img src="Supplemental_Figure_02.jpg" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Create plotting function</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>ggDroneCorr <span class="ot">&lt;-</span> <span class="cf">function</span>(xd, xf, myTitle, myTrait, xLab, yLab, <span class="at">myColor =</span> <span class="st">&quot;darkgreen&quot;</span>) {</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="co"># Prep data</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  xd <span class="ot">&lt;-</span> xd[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, k)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>  xf <span class="ot">&lt;-</span> xf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> myTrait) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Entry, Name, Value)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> <span class="fu">left_join</span>(xf, xd, <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>    <span class="fu">group_by</span>(Entry, Name) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T),</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>              <span class="at">k =</span> <span class="fu">mean</span>(k, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>  myCorr <span class="ot">&lt;-</span> <span class="fu">cor</span>(xx<span class="sc">$</span>Value, xx<span class="sc">$</span>k, <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>  myLabel <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;italic(R)^2 ==&quot;</span>, <span class="fu">round</span>(myCorr,<span class="dv">2</span>))</span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>  <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> k)) <span class="sc">+</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>    <span class="fu">stat_smooth</span>(<span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, </span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">color =</span> myColor) <span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="at">label =</span> myLabel, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">parse =</span> T,</span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a>              <span class="at">x =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">vjust =</span> <span class="dv">1</span> ) <span class="sc">+</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> <span class="fu">as.character</span>(myTitle)) <span class="sc">+</span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a>    theme_AGL <span class="sc">+</span> </span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> xLab, <span class="at">y =</span> yLab)</span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a>}</span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a><span class="co"># Height x Height</span></span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb26-28"><a href="#cb26-28" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> it17_gc.h, <span class="at">xf =</span> it17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">1</span>],</span>
<span id="cb26-29"><a href="#cb26-29" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Metaponto, Italy 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Height (UAV)&quot;</span>,</span>
<span id="cb26-30"><a href="#cb26-30" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Canopy.Height&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Canopy Height (Manual)&quot;</span>)</span>
<span id="cb26-31"><a href="#cb26-31" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> ro17_gc.h, <span class="at">xf =</span> ro17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">2</span>],</span>
<span id="cb26-32"><a href="#cb26-32" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Rosthern, Canada 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Height (UAV)&quot;</span>, </span>
<span id="cb26-33"><a href="#cb26-33" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Canopy.Height&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Canopy Height (Manual)&quot;</span>)</span>
<span id="cb26-34"><a href="#cb26-34" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> su17_gc.h, <span class="at">xf =</span> su17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">3</span>], </span>
<span id="cb26-35"><a href="#cb26-35" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Sutherland, Canada 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Height (UAV)&quot;</span>, </span>
<span id="cb26-36"><a href="#cb26-36" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Canopy.Height&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Canopy Height (Manual)&quot;</span>)</span>
<span id="cb26-37"><a href="#cb26-37" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> su18_gc.h, <span class="at">xf =</span> su18_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">4</span>],</span>
<span id="cb26-38"><a href="#cb26-38" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Sutherland, Canada 2018&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Height (UAV)&quot;</span>, </span>
<span id="cb26-39"><a href="#cb26-39" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;CanopyHeight&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Canopy Height (Manual)&quot;</span>)</span>
<span id="cb26-40"><a href="#cb26-40" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb26-41"><a href="#cb26-41" tabindex="-1"></a>mp_a <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, mp4, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-42"><a href="#cb26-42" tabindex="-1"></a>  <span class="fu">annotate_figure</span>(<span class="at">fig.lab =</span> <span class="st">&quot;A) Plot Height (UAV) x Canopy Height (Manual)&quot;</span>,</span>
<span id="cb26-43"><a href="#cb26-43" tabindex="-1"></a>                  <span class="at">fig.lab.pos =</span> <span class="st">&quot;top.left&quot;</span>, <span class="at">fig.lab.size =</span> <span class="dv">13</span>, <span class="at">top =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-44"><a href="#cb26-44" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">&#39;cm&#39;</span>)) </span>
<span id="cb26-45"><a href="#cb26-45" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb26-46"><a href="#cb26-46" tabindex="-1"></a><span class="co"># Volume x Biomass</span></span>
<span id="cb26-47"><a href="#cb26-47" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb26-48"><a href="#cb26-48" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> it17_gc.v, <span class="at">xf =</span> it17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">1</span>],</span>
<span id="cb26-49"><a href="#cb26-49" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Metaponto, Italy 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (UAV)&quot;</span>, </span>
<span id="cb26-50"><a href="#cb26-50" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Plot.Biomass&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Total Biomass (Manual)&quot;</span>)</span>
<span id="cb26-51"><a href="#cb26-51" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> ro17_gc.v, <span class="at">xf =</span> ro17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">2</span>],</span>
<span id="cb26-52"><a href="#cb26-52" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Rosthern, Canada 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (UAV)&quot;</span>, </span>
<span id="cb26-53"><a href="#cb26-53" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Plot.Biomass&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Total Biomass (Manual)&quot;</span>)</span>
<span id="cb26-54"><a href="#cb26-54" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> su17_gc.v, <span class="at">xf =</span> su17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">3</span>],</span>
<span id="cb26-55"><a href="#cb26-55" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Sutherland, Canada 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (UAV)&quot;</span>, </span>
<span id="cb26-56"><a href="#cb26-56" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Plot.Biomass&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Total Biomass (Manual)&quot;</span>)</span>
<span id="cb26-57"><a href="#cb26-57" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> su18_gc.v, <span class="at">xf =</span> su18_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">4</span>],</span>
<span id="cb26-58"><a href="#cb26-58" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Sutherland, Canada 2018&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (UAV)&quot;</span>, </span>
<span id="cb26-59"><a href="#cb26-59" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Plot.Biomass&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Total Biomass (Manual)&quot;</span>)</span>
<span id="cb26-60"><a href="#cb26-60" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb26-61"><a href="#cb26-61" tabindex="-1"></a>mp_b <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, mp4, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-62"><a href="#cb26-62" tabindex="-1"></a>  <span class="fu">annotate_figure</span>(<span class="at">fig.lab =</span> <span class="st">&quot;B) Plot Volume (UAV) x Total Biomass (Manual)&quot;</span>,</span>
<span id="cb26-63"><a href="#cb26-63" tabindex="-1"></a>                  <span class="at">fig.lab.pos =</span> <span class="st">&quot;top.left&quot;</span>, <span class="at">fig.lab.size =</span> <span class="dv">13</span>, <span class="at">top =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-64"><a href="#cb26-64" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">&#39;cm&#39;</span>))</span>
<span id="cb26-65"><a href="#cb26-65" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb26-66"><a href="#cb26-66" tabindex="-1"></a><span class="co"># Volume x Biomass</span></span>
<span id="cb26-67"><a href="#cb26-67" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb26-68"><a href="#cb26-68" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> it17_gc.v, <span class="at">xf =</span> it17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">1</span>],</span>
<span id="cb26-69"><a href="#cb26-69" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Metaponto, Italy 2017&quot;</span>,    <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (UAV)&quot;</span>,</span>
<span id="cb26-70"><a href="#cb26-70" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Straw.Biomass&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Straw Biomass (Manual)&quot;</span>)</span>
<span id="cb26-71"><a href="#cb26-71" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> ro17_gc.v, <span class="at">xf =</span> ro17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">2</span>],</span>
<span id="cb26-72"><a href="#cb26-72" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Rosthern, Canada 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (UAV)&quot;</span>,</span>
<span id="cb26-73"><a href="#cb26-73" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Straw.Biomass&quot;</span>,  <span class="at">xLab =</span> <span class="st">&quot;Straw Biomass (Manual)&quot;</span>)</span>
<span id="cb26-74"><a href="#cb26-74" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> su17_gc.v, <span class="at">xf =</span> su17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">3</span>],</span>
<span id="cb26-75"><a href="#cb26-75" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Sutherland, Canada 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (UAV)&quot;</span>,</span>
<span id="cb26-76"><a href="#cb26-76" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Straw.Biomass&quot;</span>,  <span class="at">xLab =</span> <span class="st">&quot;Straw Biomass (Manual)&quot;</span>)</span>
<span id="cb26-77"><a href="#cb26-77" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> su18_gc.v, <span class="at">xf =</span> su18_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">4</span>],</span>
<span id="cb26-78"><a href="#cb26-78" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Sutherland, Canada 2018&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (UAV)&quot;</span>,</span>
<span id="cb26-79"><a href="#cb26-79" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Straw.Biomass&quot;</span>,  <span class="at">xLab =</span> <span class="st">&quot;Straw Biomass (Manual)&quot;</span>)</span>
<span id="cb26-80"><a href="#cb26-80" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb26-81"><a href="#cb26-81" tabindex="-1"></a>mp_c <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, mp4, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">1</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb26-82"><a href="#cb26-82" tabindex="-1"></a>  <span class="fu">annotate_figure</span>(<span class="at">fig.lab =</span> <span class="st">&quot;C) Plot Volume (UAV) x Straw Biomass (Manual)&quot;</span>,</span>
<span id="cb26-83"><a href="#cb26-83" tabindex="-1"></a>                  <span class="at">fig.lab.pos =</span> <span class="st">&quot;top.left&quot;</span>, <span class="at">fig.lab.size =</span> <span class="dv">13</span>, <span class="at">top =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-84"><a href="#cb26-84" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">&#39;cm&#39;</span>))</span>
<span id="cb26-85"><a href="#cb26-85" tabindex="-1"></a><span class="co"># Append All</span></span>
<span id="cb26-86"><a href="#cb26-86" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp_a, mp_b, mp_c, <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb26-87"><a href="#cb26-87" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Supplemental_Figure_02.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
<div id="additional-figures-2---volume-x-yield-x-arch"
class="section level2">
<h2>Additional Figures 2 - Volume x Yield x Arch</h2>
<p><img src="Additional/Additional_Figure_02.png" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># Volume x Yield</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> it17_gc.v, <span class="at">xf =</span> it17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">1</span>],</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (UAV)&quot;</span>,</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Seed.Mass&quot;</span>,  <span class="at">xLab =</span> <span class="st">&quot;Plot Yield (Manual)&quot;</span>)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> ro17_gc.v, <span class="at">xf =</span> ro17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">2</span>],</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>                  <span class="at">myTitle =</span> <span class="st">&quot;Rosthern 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (UAV)&quot;</span>,</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>                  <span class="at">myTrait =</span> <span class="st">&quot;Seed.Mass&quot;</span>,     <span class="at">xLab =</span> <span class="st">&quot;Plot Yeild (Manual)&quot;</span>)</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> su17_gc.v, <span class="at">xf =</span> su17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">3</span>],</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>                  <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (UAV)&quot;</span>,</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>                  <span class="at">myTrait =</span> <span class="st">&quot;Seed.Mass&quot;</span>,        <span class="at">xLab =</span> <span class="st">&quot;Plot Yield (Manual)&quot;</span>)</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> su18_gc.v, <span class="at">xf =</span> su18_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">4</span>],</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>                  <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2018&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (UAV)&quot;</span>,</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>                  <span class="at">myTrait =</span> <span class="st">&quot;Seed.Mass&quot;</span>,        <span class="at">xLab =</span> <span class="st">&quot;Plot Yield (Manual)&quot;</span>)</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>mp_a <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, mp4, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">1</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>  <span class="fu">annotate_figure</span>(<span class="at">fig.lab =</span> <span class="st">&quot;A) Plot Volume (UAV) x Plot Yield (Manual)&quot;</span>,</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>                  <span class="at">fig.lab.pos =</span> <span class="st">&quot;top.left&quot;</span>, <span class="at">fig.lab.size =</span> <span class="dv">13</span>, <span class="at">top =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">&#39;cm&#39;</span>))</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a><span class="co"># Volume x Growth Habit</span></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> it17_gc.v, <span class="at">xf =</span> it17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">1</span>],</span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (Drone)&quot;</span>,</span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a>                   <span class="at">myTrait =</span> <span class="st">&quot;Nodes.At.Flower&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Nodes at Flowering (Manual)&quot;</span>)</span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> ro17_gc.v, <span class="at">xf =</span> ro17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">2</span>],</span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a>                  <span class="at">myTitle =</span> <span class="st">&quot;Rosthern 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (Drone)&quot;</span>,</span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a>                  <span class="at">myTrait =</span> <span class="st">&quot;Nodes.At.Flower&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Nodes at Flowering (Manual)&quot;</span>)</span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> su17_gc.v, <span class="at">xf =</span> su17_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">3</span>],</span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a>                  <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (Drone)&quot;</span>,</span>
<span id="cb27-30"><a href="#cb27-30" tabindex="-1"></a>                  <span class="at">myTrait =</span> <span class="st">&quot;Nodes.At.Flower&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Nodes at Flowering (Manual)&quot;</span>)</span>
<span id="cb27-31"><a href="#cb27-31" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggDroneCorr</span>(<span class="at">xd =</span> su18_gc.v, <span class="at">xf =</span> su18_f, <span class="at">myColor =</span> myColors_Expt[<span class="dv">4</span>], </span>
<span id="cb27-32"><a href="#cb27-32" tabindex="-1"></a>                  <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2018&quot;</span>, <span class="at">yLab =</span> <span class="st">&quot;Plot Volume (Drone)&quot;</span>,</span>
<span id="cb27-33"><a href="#cb27-33" tabindex="-1"></a>                  <span class="at">myTrait =</span> <span class="st">&quot;Growth.Habit&quot;</span>, <span class="at">xLab =</span> <span class="st">&quot;Growth Habit (Manual)&quot;</span>)</span>
<span id="cb27-34"><a href="#cb27-34" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb27-35"><a href="#cb27-35" tabindex="-1"></a>mp_b <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, mp4, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">1</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb27-36"><a href="#cb27-36" tabindex="-1"></a>  <span class="fu">annotate_figure</span>(<span class="at">fig.lab =</span> <span class="st">&quot;A) Plot Volume (UAV) x Growth Habit (Manual)&quot;</span>,</span>
<span id="cb27-37"><a href="#cb27-37" tabindex="-1"></a>                  <span class="at">fig.lab.pos =</span> <span class="st">&quot;top.left&quot;</span>, <span class="at">fig.lab.size =</span> <span class="dv">13</span>, <span class="at">top =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb27-38"><a href="#cb27-38" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">&#39;cm&#39;</span>))</span>
<span id="cb27-39"><a href="#cb27-39" tabindex="-1"></a><span class="co"># Append All</span></span>
<span id="cb27-40"><a href="#cb27-40" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp_a, mp_b, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb27-41"><a href="#cb27-41" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_02.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
</div>
<div id="figure-3---growth-curves" class="section level1">
<h1>Figure 3 - Growth Curves</h1>
<p><img src="Figure_03.jpg" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Create plotting function</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>ggGrowthCurve <span class="ot">&lt;-</span> <span class="cf">function</span>(xpm, xF, <span class="at">myTitle =</span> <span class="cn">NULL</span>, </span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>                          <span class="at">xlab =</span> <span class="st">&quot;Days After Planting&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Predicted Values&quot;</span>, </span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>                          <span class="at">myEntries =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">94</span>, <span class="dv">107</span>, <span class="dv">27</span>),</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>                          <span class="at">myColors =</span> <span class="fu">c</span>(<span class="st">&quot;chartreuse4&quot;</span>, <span class="st">&quot;red4&quot;</span>, <span class="st">&quot;blue2&quot;</span>, <span class="st">&quot;steelblue&quot;</span>), </span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>                          <span class="at">linesize =</span> <span class="fl">1.75</span> ) {</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  <span class="co"># Prep data</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>  xF <span class="ot">&lt;-</span> xF <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>, Entry <span class="sc">%in%</span> myEntries) <span class="sc">%&gt;%</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>    <span class="fu">group_by</span>(Name, Entry) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T))</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">sum</span>(<span class="fu">colnames</span>(xpm)<span class="sc">==</span><span class="st">&quot;Expt&quot;</span>)<span class="sc">==</span><span class="dv">0</span>) { xpm <span class="ot">&lt;-</span> xpm <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Expt =</span> myTitle) }</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>  xpe <span class="ot">&lt;-</span> xpm <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Entry <span class="sc">%in%</span> myEntries) <span class="sc">%&gt;%</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Entry =</span> <span class="fu">factor</span>(Entry, <span class="at">levels =</span> myEntries)) <span class="sc">%&gt;%</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>    <span class="fu">arrange</span>(Entry) <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Name =</span> <span class="fu">factor</span>(Name))</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>  mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xpm, <span class="fu">aes</span>(<span class="at">x =</span> DAP, <span class="at">y =</span> Predicted.Values, <span class="at">group =</span> Entry, <span class="at">key1 =</span> Name)) <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> xpe, <span class="at">size =</span> linesize, <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">color =</span> Name)) <span class="sc">+</span> </span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> xF, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">color =</span> Name)) <span class="sc">+</span></span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> Expt, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">space =</span> <span class="st">&quot;free_x&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;Accession&quot;</span>, <span class="at">values =</span> myColors) <span class="sc">+</span></span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a>    theme_AGL <span class="sc">+</span> </span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> xlab, <span class="at">y =</span> ylab)</span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a>  mp</span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># Italy 2017</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.v[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">&quot;Plot Volume&quot;</span>, <span class="at">myTitle =</span> <span class="st">&quot;Metaponto, Italy 2017&quot;</span>)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">&quot;Plot Height&quot;</span>, <span class="at">myTitle =</span> <span class="st">&quot;Metaponto, Italy 2017&quot;</span>)</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">&quot;Plot Area&quot;</span>,  <span class="at">myTitle =</span> <span class="st">&quot;Metaponto, Italy 2017&quot;</span>)</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="co"># Sutherland 2017</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.v[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">myTitle =</span> <span class="st">&quot;Sutherland, Canada 2017&quot;</span>)</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>mp5 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">myTitle =</span> <span class="st">&quot;Sutherland, Canada 2017&quot;</span>)</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>mp6 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, <span class="at">xlab =</span> <span class="st">&quot;Days After Planting&quot;</span>,</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">myTitle =</span> <span class="st">&quot;Sutherland, Canada 2017&quot;</span>)</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a><span class="co"># Rosthern 2017</span></span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>mp7 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> ro17_gc.v[[<span class="dv">4</span>]], <span class="at">xF =</span> ro17_f, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">myTitle =</span> <span class="st">&quot;Rosthern, Canada 2017&quot;</span>)</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>mp8 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> ro17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> ro17_f, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">myTitle =</span> <span class="st">&quot;Rosthern, Canada 2017&quot;</span>)</span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a>mp9 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> ro17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> ro17_f, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">myTitle =</span> <span class="st">&quot;Rosthern, Canada 2017&quot;</span>)</span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp4, mp7, mp2, mp5, mp8, mp3, mp6, mp9, </span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a>                <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> T)</span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Figure_03.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
<div id="additional-figures-3---growth-curves" class="section level2">
<h2>Additional Figures 3 - Growth Curves</h2>
<p><img src="Additional/Additional_Figure_03_1.png" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">&quot;Days After Planting&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Plot Height&quot;</span>, </span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Metaponto, Italy 2017&quot;</span>)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">&quot;Days After Planting&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland, Canada 2017&quot;</span>)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">&quot;Days After Planting&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Plot Area&quot;</span>,  </span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Metaponto, Italy 2017&quot;</span>)</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">&quot;Days After Planting&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland, Canada 2017&quot;</span>)</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, mp4, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> T)</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_03_1.png&quot;</span>, mp, </span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="Additional/Additional_Figure_03_2.png" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># Prep data - Clusters 1 + 7</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>myEntries <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">83</span>, <span class="dv">94</span>)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>myColors <span class="ot">=</span> myColors_Cluster[<span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">1</span>)]</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.v[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Volume&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Height&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Area&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.v[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Volume&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>mp5 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Height&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>mp6 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Area&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a>mpA <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp4, mp2, mp5, mp3, mp6, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> T)</span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_03_2.png&quot;</span>, mpA, </span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="Additional/Additional_Figure_03_3.png" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># Prep data - Clusters 4 + 5</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>myEntries <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">107</span>, <span class="dv">27</span>)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>myColors <span class="ot">=</span> myColors_Cluster[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)] </span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.v[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Volume&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Height&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Area&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.v[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Volume&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>mp5 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Height&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a>mp6 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Area&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a>mpB <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp4, mp2, mp5, mp3, mp6, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> T)</span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_03_3.png&quot;</span>, mpB, </span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="Additional/Additional_Figure_03_4.png" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># Prep data - Clusters 6 + 8</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>myEntries <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">311</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>myColors <span class="ot">=</span> myColors_Cluster[<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">6</span>)]</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.v[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Volume&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Height&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Area&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.v[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Volume&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a>mp5 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Height&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a>mp6 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Area&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a>mpC <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp4, mp2, mp5, mp3, mp6, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> T)</span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_03_4.png&quot;</span>, mpC, </span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="Additional/Additional_Figure_03_5.png" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># Prep data - Clusters 2 + 3</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>myEntries <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">33</span>, <span class="dv">30</span>)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>myColors <span class="ot">=</span> myColors_Cluster[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.v[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Volume&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Height&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Italy 2017 - Area&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.v[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Volume&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a>mp5 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Height&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a>mp6 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a>                     <span class="at">myEntries =</span> myEntries, <span class="at">myColors =</span> myColors,</span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a>                     <span class="at">myTitle =</span> <span class="st">&quot;Sutherland 2017 - Area&quot;</span>, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb34-25"><a href="#cb34-25" tabindex="-1"></a>mpD <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp4, mp2, mp5, mp3, mp6, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> T)</span>
<span id="cb34-26"><a href="#cb34-26" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_03_5.png&quot;</span>, mpD, </span>
<span id="cb34-27"><a href="#cb34-27" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<blockquote>
<ul>
<li><i class="far fa-file-pdf" role="presentation" aria-label="file-pdf icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/blob/main/Additional/Additional_Figure_03.pdf"
target="_blank">Additional/Additional_Figure_03.pdf</a></li>
</ul>
</blockquote>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co"># Note: this code chunk must be ran after the PCA analysis</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>myPCA <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;myPCA.csv&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">factor</span>(Cluster))</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;Additional/Additional_Figure_03.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="fl">5.5</span>)</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> myPCA <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Cluster) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Entry) ) {</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>  myColors <span class="ot">=</span> myColors_Cluster[myPCA<span class="sc">$</span>Cluster[myPCA<span class="sc">$</span>Entry<span class="sc">==</span>i]]</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>  mp1 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>                       <span class="at">myEntries =</span> i, <span class="at">myTitle =</span> <span class="st">&quot;It17 - Canopy Height&quot;</span>,</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>                       <span class="at">myColors =</span> myColors, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>  mp2 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> it17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> it17_f, </span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a>                       <span class="at">myEntries =</span> i, <span class="at">myTitle =</span> <span class="st">&quot;It17 - Plot Area&quot;</span>,</span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>                       <span class="at">myColors =</span> myColors, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>  mp3 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.h[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a>                       <span class="at">myEntries =</span> i, <span class="at">myTitle =</span> <span class="st">&quot;Su17 - Canopy Height&quot;</span>,</span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a>                       <span class="at">myColors =</span> myColors, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a>  mp4 <span class="ot">&lt;-</span> <span class="fu">ggGrowthCurve</span>(<span class="at">xpm =</span> su17_gc.a[[<span class="dv">4</span>]], <span class="at">xF =</span> su17_f, </span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a>                       <span class="at">myEntries =</span> i, <span class="at">myTitle =</span> <span class="st">&quot;Su17 - Plot Area&quot;</span>,</span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a>                       <span class="at">myColors =</span> myColors, <span class="at">linesize =</span> <span class="dv">3</span>)</span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a>  <span class="co"># Append</span></span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a>  mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp3, mp2, mp4, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> T)</span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a>  <span class="fu">print</span>(mp)</span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a>}</span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a><span class="fu">dev.off</span>() <span class="co">#dev.set(dev.next())</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="supplemental-figure-3" class="section level1">
<h1>Supplemental Figure 3</h1>
<p><img src="Supplemental_Figure_03.jpg" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>gg_GxE <span class="ot">&lt;-</span> <span class="cf">function</span>(x1, x2, x3, traitName, myTitle, <span class="at">myYlab =</span> <span class="st">&quot;Proportion of Total Variance (%)&quot;</span>) {</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>  <span class="co"># Prep data</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> x1[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Rep, Entry, Name, Expt, k, x.mid, x.d, g.r, auc.l)</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> x2[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Rep, Entry, Name, Expt, k, x.mid, x.d, g.r, auc.l)</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> x3[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Rep, Entry, Name, Expt, k, x.mid, x.d, g.r, auc.l)</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(x1, x2, x3)</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>  <span class="co"># Define your traits (replace with your actual trait names)</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>  traits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;k&quot;</span>, <span class="st">&quot;auc.l&quot;</span>, <span class="st">&quot;g.r&quot;</span>, <span class="st">&quot;x.mid&quot;</span>, <span class="st">&quot;x.d&quot;</span>)</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>  <span class="co"># Initialize an empty list to store variance component data</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>  vc_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>  blup_list <span class="ot">&lt;-</span> <span class="fu">list</span>() <span class="co">#store blups values</span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>  <span class="co"># Loop over each trait</span></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>  <span class="cf">for</span> (trait <span class="cf">in</span> traits) {</span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>    <span class="co"># Define the model formula with ENV as a fixed factor</span></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>    formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(trait, <span class="st">&quot;~ Expt + (1 | Name) + (1 | Name:Expt) + (1 | Expt:Rep)&quot;</span>))</span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>    <span class="co"># Fit the mixed-effects model</span></span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(formula, <span class="at">data =</span> xx)  <span class="co"># Replace with your actual data</span></span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>    <span class="co"># Extract variance components for random effects</span></span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>    vc <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(model)</span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a>    vc_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(vc)</span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a>    <span class="co"># Calculate total phenotypic variance </span></span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a>    total_variance <span class="ot">&lt;-</span> <span class="fu">sum</span>(vc_df<span class="sc">$</span>vcov) </span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a>    <span class="co"># Calculate proportions as percentages</span></span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a>    vc_df<span class="sc">$</span>proportion <span class="ot">&lt;-</span> (vc_df<span class="sc">$</span>vcov <span class="sc">/</span> total_variance) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a>    vc_df<span class="sc">$</span>trait <span class="ot">&lt;-</span> trait</span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a>    <span class="co"># Store results in the list</span></span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a>    vc_list[[trait]] <span class="ot">&lt;-</span> vc_df</span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a>  }</span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a>  <span class="co"># Combine all trait data into one data frame</span></span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a>  vc_all <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, vc_list)</span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a>  <span class="fu">write.csv</span>(vc_all, <span class="fu">paste0</span>(<span class="st">&quot;Additional/vc_all&quot;</span>,traitName,<span class="st">&quot;.csv&quot;</span>))</span>
<span id="cb36-33"><a href="#cb36-33" tabindex="-1"></a>  <span class="co"># Define and order variance component labels for the plot</span></span>
<span id="cb36-34"><a href="#cb36-34" tabindex="-1"></a>  vc_all<span class="sc">$</span>grp <span class="ot">&lt;-</span> <span class="fu">factor</span>(vc_all<span class="sc">$</span>grp, </span>
<span id="cb36-35"><a href="#cb36-35" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Name&quot;</span>, <span class="st">&quot;Name:Expt&quot;</span>, <span class="st">&quot;Expt:Rep&quot;</span>, <span class="st">&quot;Residual&quot;</span>),</span>
<span id="cb36-36"><a href="#cb36-36" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Genetic&quot;</span>, <span class="st">&quot;G x E&quot;</span>, <span class="st">&quot;Rep:Env&quot;</span>, <span class="st">&quot;Residual + Env&quot;</span>))</span>
<span id="cb36-37"><a href="#cb36-37" tabindex="-1"></a>  vc_all<span class="sc">$</span>trait <span class="ot">&lt;-</span> <span class="fu">factor</span>(vc_all<span class="sc">$</span>trait, <span class="at">levels =</span> traits)</span>
<span id="cb36-38"><a href="#cb36-38" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb36-39"><a href="#cb36-39" tabindex="-1"></a>  <span class="co"># Create the stacked bar plot</span></span>
<span id="cb36-40"><a href="#cb36-40" tabindex="-1"></a>  <span class="fu">ggplot</span>(vc_all, <span class="fu">aes</span>(<span class="at">x =</span> trait, <span class="at">y =</span> proportion, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb36-41"><a href="#cb36-41" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb36-42"><a href="#cb36-42" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set3&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-43"><a href="#cb36-43" tabindex="-1"></a>    theme_AGL <span class="sc">+</span></span>
<span id="cb36-44"><a href="#cb36-44" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> myTitle, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> myYlab, <span class="at">fill =</span> <span class="st">&quot;Component&quot;</span>)</span>
<span id="cb36-45"><a href="#cb36-45" tabindex="-1"></a>}</span>
<span id="cb36-46"><a href="#cb36-46" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">gg_GxE</span>(it17_gc.a, ro17_gc.a, su17_gc.a, <span class="at">traitName =</span> <span class="st">&quot;Area&quot;</span>, <span class="at">myYlab =</span> <span class="cn">NULL</span>,</span>
<span id="cb36-47"><a href="#cb36-47" tabindex="-1"></a>              <span class="at">myTitle =</span> <span class="st">&quot;A) Plot Area Growth Curve Coefficients&quot;</span>)</span>
<span id="cb36-48"><a href="#cb36-48" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">gg_GxE</span>(it17_gc.h, ro17_gc.h, su17_gc.h, <span class="at">traitName =</span> <span class="st">&quot;Height&quot;</span>, </span>
<span id="cb36-49"><a href="#cb36-49" tabindex="-1"></a>              <span class="at">myTitle =</span> <span class="st">&quot;B) Plot Height Growth Curve Coefficients&quot;</span>)</span>
<span id="cb36-50"><a href="#cb36-50" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">gg_GxE</span>(it17_gc.v, ro17_gc.v, su17_gc.v, <span class="at">traitName =</span> <span class="st">&quot;Volume&quot;</span>, <span class="at">myYlab =</span> <span class="cn">NULL</span>,</span>
<span id="cb36-51"><a href="#cb36-51" tabindex="-1"></a>              <span class="at">myTitle =</span> <span class="st">&quot;C) Plot Volume Growth Curve Coefficients&quot;</span>)</span>
<span id="cb36-52"><a href="#cb36-52" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb36-53"><a href="#cb36-53" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">align =</span> <span class="st">&quot;v&quot;</span>,</span>
<span id="cb36-54"><a href="#cb36-54" tabindex="-1"></a>                <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb36-55"><a href="#cb36-55" tabindex="-1"></a><span class="co">#mp</span></span>
<span id="cb36-56"><a href="#cb36-56" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Supplemental_Figure_03.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="figure-4---canada-vs-iran-vs-india" class="section level1">
<h1>Figure 4 - Canada vs Iran vs India</h1>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Figure_04_A.html"
target="_blank">Additional/Figure_04_A.html</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Figure_04_B.html"
target="_blank">Additional/Figure_04_B.html</a></li>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Figure_04_C.html"
target="_blank">Additional/Figure_04_C.html</a></li>
</ul>
</blockquote>
<p><img src="Figure_04.jpg" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>myColors_Origins <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;black&quot;</span>)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>myOrigins <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;India&quot;</span>, <span class="st">&quot;Iran&quot;</span>, <span class="st">&quot;Canada&quot;</span>, <span class="st">&quot;Other&quot;</span>)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>myExpts3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Italy 2017&quot;</span>, <span class="st">&quot;Rosthern 2017&quot;</span>, <span class="st">&quot;Sutherland 2017&quot;</span>, <span class="st">&quot;Sutherland 2018&quot;</span>)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>xH <span class="ot">&lt;-</span> <span class="fu">rbind</span>(it17_gc.h[[<span class="dv">2</span>]], ro17_gc.h[[<span class="dv">2</span>]], su17_gc.h[[<span class="dv">2</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name, Expt, <span class="at">Height=</span>k)</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>xA <span class="ot">&lt;-</span> <span class="fu">rbind</span>(it17_gc.a[[<span class="dv">2</span>]], ro17_gc.a[[<span class="dv">2</span>]], su17_gc.a[[<span class="dv">2</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name, Expt, <span class="at">Area=</span>k)</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>xV <span class="ot">&lt;-</span> <span class="fu">rbind</span>(it17_gc.v[[<span class="dv">2</span>]], ro17_gc.v[[<span class="dv">2</span>]], su17_gc.v[[<span class="dv">2</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name, Expt, <span class="at">Volume=</span>k)</span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>xS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(it17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>),</span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>            ro17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>),</span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a>            su17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>),</span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a>            su18_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name, Expt, <span class="at">Seed.Mass=</span>Value)</span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a>xD <span class="ot">&lt;-</span> <span class="fu">rbind</span>(it17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>),</span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a>            ro17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>),</span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a>            su17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>),</span>
<span id="cb37-22"><a href="#cb37-22" tabindex="-1"></a>            su18_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-23"><a href="#cb37-23" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name, Expt, <span class="at">DTF=</span>Value) </span>
<span id="cb37-24"><a href="#cb37-24" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb37-25"><a href="#cb37-25" tabindex="-1"></a>xP <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;myPCA.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-26"><a href="#cb37-26" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">factor</span>(Cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb37-27"><a href="#cb37-27" tabindex="-1"></a>  <span class="fu">select</span>(Entry, Name, Cluster, Origin)</span>
<span id="cb37-28"><a href="#cb37-28" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb37-29"><a href="#cb37-29" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">left_join</span>(xH, xA, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;Entry&quot;</span>,<span class="st">&quot;Name&quot;</span>,<span class="st">&quot;Expt&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-30"><a href="#cb37-30" tabindex="-1"></a>  <span class="fu">left_join</span>(xV, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;Entry&quot;</span>,<span class="st">&quot;Name&quot;</span>,<span class="st">&quot;Expt&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-31"><a href="#cb37-31" tabindex="-1"></a>  <span class="fu">left_join</span>(xS, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;Entry&quot;</span>,<span class="st">&quot;Name&quot;</span>,<span class="st">&quot;Expt&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-32"><a href="#cb37-32" tabindex="-1"></a>  <span class="fu">left_join</span>(xD, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;Entry&quot;</span>,<span class="st">&quot;Name&quot;</span>,<span class="st">&quot;Expt&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-33"><a href="#cb37-33" tabindex="-1"></a>  <span class="fu">group_by</span>(Entry, Name, Expt) <span class="sc">%&gt;%</span></span>
<span id="cb37-34"><a href="#cb37-34" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Height =</span> <span class="fu">mean</span>(Height, <span class="at">na.rm =</span> T),</span>
<span id="cb37-35"><a href="#cb37-35" tabindex="-1"></a>            <span class="at">Area =</span> <span class="fu">mean</span>(Area, <span class="at">na.rm =</span> T),</span>
<span id="cb37-36"><a href="#cb37-36" tabindex="-1"></a>            <span class="at">Volume =</span> <span class="fu">mean</span>(Volume, <span class="at">na.rm =</span> T),</span>
<span id="cb37-37"><a href="#cb37-37" tabindex="-1"></a>            <span class="at">Seed.Mass =</span> <span class="fu">mean</span>(Seed.Mass, <span class="at">na.rm =</span> T),</span>
<span id="cb37-38"><a href="#cb37-38" tabindex="-1"></a>            <span class="at">DTF =</span> <span class="fu">mean</span>(DTF, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb37-39"><a href="#cb37-39" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-40"><a href="#cb37-40" tabindex="-1"></a>  <span class="fu">left_join</span>(xP, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Entry&quot;</span>, <span class="st">&quot;Name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-41"><a href="#cb37-41" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="fu">ifelse</span>(Origin <span class="sc">%in%</span> myOrigins[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], Origin, myOrigins[<span class="dv">4</span>]),</span>
<span id="cb37-42"><a href="#cb37-42" tabindex="-1"></a>         <span class="at">Expt =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Expt, myExpts3, myExpts1)) <span class="sc">%&gt;%</span></span>
<span id="cb37-43"><a href="#cb37-43" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Group))</span>
<span id="cb37-44"><a href="#cb37-44" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb37-45"><a href="#cb37-45" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Area, <span class="at">y =</span> Height, <span class="at">color =</span> Group, <span class="at">alpha =</span> Group)) <span class="sc">+</span></span>
<span id="cb37-46"><a href="#cb37-46" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">key1 =</span> Origin, <span class="at">key2 =</span> Entry, <span class="at">key3 =</span> Name), <span class="at">pch =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb37-47"><a href="#cb37-47" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Expt) <span class="sc">+</span></span>
<span id="cb37-48"><a href="#cb37-48" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;Accession Origin&quot;</span>, <span class="at">values =</span> myColors_Origins) <span class="sc">+</span></span>
<span id="cb37-49"><a href="#cb37-49" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">name =</span> <span class="st">&quot;Accession Origin&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb37-50"><a href="#cb37-50" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb37-51"><a href="#cb37-51" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb37-52"><a href="#cb37-52" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;A) Height x Area&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Plot Height&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Plot Area&quot;</span>)</span>
<span id="cb37-53"><a href="#cb37-53" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb37-54"><a href="#cb37-54" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Volume, <span class="at">y =</span> Seed.Mass, <span class="at">color =</span> Group, <span class="at">alpha =</span> Group)) <span class="sc">+</span></span>
<span id="cb37-55"><a href="#cb37-55" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">key1 =</span> Origin, <span class="at">key2 =</span> Entry, <span class="at">key3 =</span> Name), <span class="at">pch =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb37-56"><a href="#cb37-56" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Expt) <span class="sc">+</span></span>
<span id="cb37-57"><a href="#cb37-57" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;Accession Origin&quot;</span>, <span class="at">values =</span> myColors_Origins) <span class="sc">+</span></span>
<span id="cb37-58"><a href="#cb37-58" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">name =</span> <span class="st">&quot;Accession Origin&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb37-59"><a href="#cb37-59" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb37-60"><a href="#cb37-60" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb37-61"><a href="#cb37-61" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;B) Yield x Volume&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Plot Volume&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Plot Yield&quot;</span>)</span>
<span id="cb37-62"><a href="#cb37-62" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb37-63"><a href="#cb37-63" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> DTF, <span class="at">y =</span> Volume, <span class="at">key1 =</span> Origin, <span class="at">color =</span> Group, <span class="at">alpha =</span> Group)) <span class="sc">+</span></span>
<span id="cb37-64"><a href="#cb37-64" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">key1 =</span> Origin, <span class="at">key2 =</span> Entry, <span class="at">key3 =</span> Name), <span class="at">pch =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb37-65"><a href="#cb37-65" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Expt, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-66"><a href="#cb37-66" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;Accession Origin&quot;</span>, <span class="at">values =</span> myColors_Origins) <span class="sc">+</span></span>
<span id="cb37-67"><a href="#cb37-67" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">name =</span> <span class="st">&quot;Accession Origin&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb37-68"><a href="#cb37-68" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb37-69"><a href="#cb37-69" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb37-70"><a href="#cb37-70" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;C) Volume x DTF&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Days From Sowing To Flower (DTF)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Plot Volume&quot;</span>)</span>
<span id="cb37-71"><a href="#cb37-71" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb37-72"><a href="#cb37-72" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb37-73"><a href="#cb37-73" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Figure_04.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb37-74"><a href="#cb37-74" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb37-75"><a href="#cb37-75" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Figure_04_A.png&quot;</span>, mp1, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="fl">2.5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb37-76"><a href="#cb37-76" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Figure_04_B.png&quot;</span>, mp2, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="fl">2.5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb37-77"><a href="#cb37-77" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Figure_04_C.png&quot;</span>, mp3, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="fl">2.5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb37-78"><a href="#cb37-78" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb37-79"><a href="#cb37-79" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(mp1), <span class="at">file=</span><span class="st">&quot;Additional/Figure_04_A.html&quot;</span>)</span>
<span id="cb37-80"><a href="#cb37-80" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(mp2), <span class="at">file=</span><span class="st">&quot;Additional/Figure_04_B.html&quot;</span>)</span>
<span id="cb37-81"><a href="#cb37-81" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(mp3), <span class="at">file=</span><span class="st">&quot;Additional/Figure_04_C.html&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="pca" class="section level1">
<h1>PCA</h1>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># Function for adding phenology related traits with growth data</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>phenolGrowth <span class="ot">&lt;-</span> <span class="cf">function</span>(xd, xf) {</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>  xf1 <span class="ot">&lt;-</span> xf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, <span class="at">DTF=</span>Value)</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>  xf2 <span class="ot">&lt;-</span> xf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTM&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, <span class="at">DTM=</span>Value)</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>  xd <span class="sc">%&gt;%</span> </span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>    <span class="fu">left_join</span>(xf1, <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>    <span class="fu">left_join</span>(xf2, <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">xmid.DTF =</span> x.mid <span class="sc">-</span> DTF,</span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>           <span class="at">xmax.DTF =</span> x.max <span class="sc">-</span> DTF,</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>           <span class="at">perc.DTF =</span> <span class="dv">100</span> <span class="sc">*</span> (k <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> ((k <span class="sc">-</span> y0) <span class="sc">/</span> y0) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> DTF))) <span class="sc">/</span> k,</span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a>           <span class="at">at.DTF =</span> k <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> ((k <span class="sc">-</span> y0) <span class="sc">/</span> y0) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> DTF)),</span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>           <span class="at">at.DTM =</span> k <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> ((k <span class="sc">-</span> y0) <span class="sc">/</span> y0) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> DTM)),</span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a>           <span class="at">xmid.DTM =</span> x.mid <span class="sc">-</span> DTM,</span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a>           <span class="at">xmax.DTM =</span> x.max <span class="sc">-</span> DTM) <span class="sc">%&gt;%</span></span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>    <span class="fu">select</span>(Plot, xmid.DTF, xmax.DTF, perc.DTF, </span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a>           xmid.DTM, xmax.DTM, at.DTF, at.DTM)</span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a>}</span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a><span class="co"># Function for performing PCA</span></span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a>pca_gc <span class="ot">&lt;-</span> <span class="cf">function</span>(xx, <span class="at">clustNum =</span> <span class="dv">8</span>) {</span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a>  mypca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(xx, <span class="at">ncp =</span> <span class="dv">10</span>, <span class="at">graph =</span> F)</span>
<span id="cb38-21"><a href="#cb38-21" tabindex="-1"></a>  mypcaH <span class="ot">&lt;-</span> <span class="fu">HCPC</span>(mypca, <span class="at">nb.clust =</span> clustNum, <span class="at">graph =</span> F)</span>
<span id="cb38-22"><a href="#cb38-22" tabindex="-1"></a>  perc <span class="ot">&lt;-</span> <span class="fu">round</span>(mypca[[<span class="dv">1</span>]][,<span class="dv">2</span>], <span class="dv">1</span>)</span>
<span id="cb38-23"><a href="#cb38-23" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> mypcaH[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;Name&quot;</span>)</span>
<span id="cb38-24"><a href="#cb38-24" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> mypca[[<span class="dv">3</span>]]<span class="sc">$</span>coord <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;Name&quot;</span>)</span>
<span id="cb38-25"><a href="#cb38-25" tabindex="-1"></a>  pca <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x1, x2, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-26"><a href="#cb38-26" tabindex="-1"></a>    <span class="fu">select</span>(Name, <span class="at">Cluster=</span>clust,</span>
<span id="cb38-27"><a href="#cb38-27" tabindex="-1"></a>           <span class="at">PC1=</span>Dim<span class="fl">.1</span>, <span class="at">PC2=</span>Dim<span class="fl">.2</span>, <span class="at">PC3=</span>Dim<span class="fl">.3</span>, <span class="at">PC4=</span>Dim<span class="fl">.4</span>, <span class="at">PC5=</span>Dim<span class="fl">.5</span>, <span class="at">PC6=</span>Dim<span class="fl">.6</span>)</span>
<span id="cb38-28"><a href="#cb38-28" tabindex="-1"></a>  pca</span>
<span id="cb38-29"><a href="#cb38-29" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>myClustnum <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a><span class="co"># Italy 2017 data</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> it17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name, k, x.mid, x.d, g.r) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> it17_gc.v[[<span class="dv">2</span>]], <span class="at">xf =</span> it17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>xmid.DTF, <span class="sc">-</span>xmid.DTM, <span class="sc">-</span>xmax.DTM, <span class="sc">-</span>at.DTM)</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a><span class="fu">colnames</span>(x1)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(x1)] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;It17_v.&quot;</span>, <span class="fu">colnames</span>(x1)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(x1)])</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> it17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name, k, x.mid, x.d, g.r) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> it17_gc.a[[<span class="dv">2</span>]], <span class="at">xf =</span> it17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>xmid.DTF, <span class="sc">-</span>xmid.DTM, <span class="sc">-</span>xmax.DTM, <span class="sc">-</span>at.DTM)</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a><span class="fu">colnames</span>(x2)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(x2)] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;It17_a.&quot;</span>, <span class="fu">colnames</span>(x2)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(x2)])</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> it17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name, k, x.mid, x.d, g.r) <span class="sc">%&gt;%</span></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> it17_gc.h[[<span class="dv">2</span>]], <span class="at">xf =</span> it17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>xmid.DTF, <span class="sc">-</span>xmid.DTM, <span class="sc">-</span>xmax.DTM, <span class="sc">-</span>at.DTM)</span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a><span class="fu">colnames</span>(x3)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(x3)] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;It17_h.&quot;</span>, <span class="fu">colnames</span>(x3)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(x3)])</span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a>myX1 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x2, x3, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;Entry&quot;</span>,<span class="st">&quot;Name&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a>  <span class="fu">left_join</span>(x1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;Entry&quot;</span>,<span class="st">&quot;Name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Plot) <span class="sc">%&gt;%</span></span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a>  <span class="fu">gather</span>(Trait, Value, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb39-24"><a href="#cb39-24" tabindex="-1"></a>  <span class="fu">group_by</span>(Entry, Name, Trait) <span class="sc">%&gt;%</span> </span>
<span id="cb39-25"><a href="#cb39-25" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb39-26"><a href="#cb39-26" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-27"><a href="#cb39-27" tabindex="-1"></a>  <span class="fu">spread</span>(Trait, Value) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Entry)</span>
<span id="cb39-28"><a href="#cb39-28" tabindex="-1"></a><span class="co"># Sutherland 2017 data</span></span>
<span id="cb39-29"><a href="#cb39-29" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> su17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb39-30"><a href="#cb39-30" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name, k, x.mid, x.d, g.r) <span class="sc">%&gt;%</span></span>
<span id="cb39-31"><a href="#cb39-31" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> su17_gc.v[[<span class="dv">2</span>]], <span class="at">xf =</span> su17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-32"><a href="#cb39-32" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>xmid.DTF, <span class="sc">-</span>xmid.DTM, <span class="sc">-</span>xmax.DTM, <span class="sc">-</span>at.DTM)</span>
<span id="cb39-33"><a href="#cb39-33" tabindex="-1"></a><span class="fu">colnames</span>(x1)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(x1)] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Su17_v.&quot;</span>, <span class="fu">colnames</span>(x1)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(x1)])</span>
<span id="cb39-34"><a href="#cb39-34" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> su17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb39-35"><a href="#cb39-35" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name, k, x.mid, x.d, g.r) <span class="sc">%&gt;%</span></span>
<span id="cb39-36"><a href="#cb39-36" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> su17_gc.a[[<span class="dv">2</span>]], <span class="at">xf =</span> su17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-37"><a href="#cb39-37" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>xmid.DTF, <span class="sc">-</span>xmid.DTM, <span class="sc">-</span>xmax.DTM, <span class="sc">-</span>at.DTM)</span>
<span id="cb39-38"><a href="#cb39-38" tabindex="-1"></a><span class="fu">colnames</span>(x2)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(x2)] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Su17_a.&quot;</span>, <span class="fu">colnames</span>(x2)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(x2)])</span>
<span id="cb39-39"><a href="#cb39-39" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> su17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb39-40"><a href="#cb39-40" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name, k, x.mid, x.d, g.r) <span class="sc">%&gt;%</span></span>
<span id="cb39-41"><a href="#cb39-41" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> su17_gc.h[[<span class="dv">2</span>]], <span class="at">xf =</span> su17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-42"><a href="#cb39-42" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>xmid.DTF, <span class="sc">-</span>xmid.DTM, <span class="sc">-</span>xmax.DTM, <span class="sc">-</span>at.DTM)</span>
<span id="cb39-43"><a href="#cb39-43" tabindex="-1"></a><span class="fu">colnames</span>(x3)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(x3)] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Su17_h.&quot;</span>, <span class="fu">colnames</span>(x3)[<span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(x3)])</span>
<span id="cb39-44"><a href="#cb39-44" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb39-45"><a href="#cb39-45" tabindex="-1"></a>myX2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x2, x3, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;Entry&quot;</span>,<span class="st">&quot;Name&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-46"><a href="#cb39-46" tabindex="-1"></a>  <span class="fu">left_join</span>(x1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;Entry&quot;</span>,<span class="st">&quot;Name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-47"><a href="#cb39-47" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Plot) <span class="sc">%&gt;%</span></span>
<span id="cb39-48"><a href="#cb39-48" tabindex="-1"></a>  <span class="fu">gather</span>(Trait, Value, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb39-49"><a href="#cb39-49" tabindex="-1"></a>  <span class="fu">group_by</span>(Entry, Name, Trait) <span class="sc">%&gt;%</span> </span>
<span id="cb39-50"><a href="#cb39-50" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb39-51"><a href="#cb39-51" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-52"><a href="#cb39-52" tabindex="-1"></a>  <span class="fu">spread</span>(Trait, Value) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Entry)</span>
<span id="cb39-53"><a href="#cb39-53" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb39-54"><a href="#cb39-54" tabindex="-1"></a>myPCAinput <span class="ot">&lt;-</span> <span class="fu">left_join</span>(myX1, myX2, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-55"><a href="#cb39-55" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">&quot;Name&quot;</span>)</span>
<span id="cb39-56"><a href="#cb39-56" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(myPCAinput))</span>
<span id="cb39-57"><a href="#cb39-57" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb39-58"><a href="#cb39-58" tabindex="-1"></a>mypca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(myPCAinput, <span class="at">ncp =</span> <span class="dv">10</span>, <span class="at">graph =</span> F)</span>
<span id="cb39-59"><a href="#cb39-59" tabindex="-1"></a>mypcaH <span class="ot">&lt;-</span> <span class="fu">HCPC</span>(mypca, <span class="at">nb.clust =</span> myClustnum, <span class="at">graph =</span> F)</span>
<span id="cb39-60"><a href="#cb39-60" tabindex="-1"></a>perc <span class="ot">&lt;-</span> <span class="fu">round</span>(mypca[[<span class="dv">1</span>]][,<span class="dv">2</span>], <span class="dv">1</span>)</span>
<span id="cb39-61"><a href="#cb39-61" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> mypcaH[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;Name&quot;</span>)</span>
<span id="cb39-62"><a href="#cb39-62" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> mypca[[<span class="dv">3</span>]]<span class="sc">$</span>coord <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;Name&quot;</span>)</span>
<span id="cb39-63"><a href="#cb39-63" tabindex="-1"></a>myPCA <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x1, x2, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-64"><a href="#cb39-64" tabindex="-1"></a>  <span class="fu">select</span>(Name, <span class="at">Cluster=</span>clust,</span>
<span id="cb39-65"><a href="#cb39-65" tabindex="-1"></a>         <span class="at">PC1=</span>Dim<span class="fl">.1</span>, <span class="at">PC2=</span>Dim<span class="fl">.2</span>, <span class="at">PC3=</span>Dim<span class="fl">.3</span>, <span class="at">PC4=</span>Dim<span class="fl">.4</span>, <span class="at">PC5=</span>Dim<span class="fl">.5</span>, <span class="at">PC6=</span>Dim<span class="fl">.6</span>,</span>
<span id="cb39-66"><a href="#cb39-66" tabindex="-1"></a>         <span class="at">PC7=</span>Dim<span class="fl">.7</span>, <span class="at">PC8=</span>Dim<span class="fl">.8</span>, <span class="at">PC9=</span>Dim<span class="fl">.9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-67"><a href="#cb39-67" tabindex="-1"></a>  <span class="fu">left_join</span>(myLDP, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-68"><a href="#cb39-68" tabindex="-1"></a>  <span class="fu">select</span>(Entry, Name, Origin, Region, <span class="fu">everything</span>())</span>
<span id="cb39-69"><a href="#cb39-69" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb39-70"><a href="#cb39-70" tabindex="-1"></a><span class="fu">write.csv</span>(myPCA, <span class="st">&quot;myPCA.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb39-71"><a href="#cb39-71" tabindex="-1"></a><span class="fu">write.csv</span>(myPCAinput, <span class="st">&quot;myPCAinput.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
<hr />
<div id="additional-figures---cluster-tests" class="section level2">
<h2>Additional Figures - Cluster Tests</h2>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/Additional/PCA_tests/"
target="_blank">Additional/PCA_test/</a></li>
</ul>
</blockquote>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># Create function</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>ggHC_test <span class="ot">&lt;-</span> <span class="cf">function</span>(cnum) {</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>  <span class="co"># Prep data</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>  mypcaH <span class="ot">&lt;-</span> <span class="fu">HCPC</span>(mypca, <span class="at">nb.clust =</span> cnum, <span class="at">graph =</span> F)</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> mypcaH[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Name, <span class="at">Cluster=</span>clust)</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>  myTraits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;It17_v.k&quot;</span>, <span class="st">&quot;It17_h.k&quot;</span>, <span class="st">&quot;It17_a.k&quot;</span>, </span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>                <span class="st">&quot;It17_h.x.mid&quot;</span>, <span class="st">&quot;It17_a.x.mid&quot;</span>, </span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a>                <span class="st">&quot;It17_v.perc.DTF&quot;</span>,</span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>                <span class="co">#</span></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>                <span class="st">&quot;Su17_v.k&quot;</span>, <span class="st">&quot;Su17_h.k&quot;</span>, <span class="st">&quot;Su17_a.k&quot;</span>,</span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a>                <span class="st">&quot;Su17_h.x.mid&quot;</span>, <span class="st">&quot;Su17_a.x.mid&quot;</span>,</span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a>                <span class="st">&quot;Su17_v.perc.DTF&quot;</span>) </span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a>  myTraits_new <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A) It17 Max V&quot;</span>, <span class="st">&quot;B) It17 Max H&quot;</span>, <span class="st">&quot;C) It17 Max A&quot;</span>, </span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a>                    <span class="st">&quot;D) It17 H x.mid&quot;</span>, <span class="st">&quot;E) It17 A x.mid&quot;</span>, </span>
<span id="cb40-16"><a href="#cb40-16" tabindex="-1"></a>                    <span class="st">&quot;F) It17 % V at DTF&quot;</span>,</span>
<span id="cb40-17"><a href="#cb40-17" tabindex="-1"></a>                    <span class="co">#</span></span>
<span id="cb40-18"><a href="#cb40-18" tabindex="-1"></a>                    <span class="st">&quot;G) Su17 Max V&quot;</span>, <span class="st">&quot;H) Su17 Max H&quot;</span>, <span class="st">&quot;I) Su17 Max A&quot;</span>,</span>
<span id="cb40-19"><a href="#cb40-19" tabindex="-1"></a>                    <span class="st">&quot;J) Su17 H x.mid&quot;</span>, <span class="st">&quot;K) Su17 A x.mid&quot;</span>,</span>
<span id="cb40-20"><a href="#cb40-20" tabindex="-1"></a>                    <span class="st">&quot;L) Su17 % V at DTF&quot;</span>)</span>
<span id="cb40-21"><a href="#cb40-21" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb40-22"><a href="#cb40-22" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> myPCAinput <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-23"><a href="#cb40-23" tabindex="-1"></a>    <span class="fu">left_join</span>(x1, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-24"><a href="#cb40-24" tabindex="-1"></a>    <span class="fu">select</span>(Name, Cluster, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb40-25"><a href="#cb40-25" tabindex="-1"></a>    <span class="fu">gather</span>(Trait, Value, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb40-26"><a href="#cb40-26" tabindex="-1"></a>    <span class="fu">filter</span>(Trait <span class="sc">%in%</span> myTraits) <span class="sc">%&gt;%</span></span>
<span id="cb40-27"><a href="#cb40-27" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Trait =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Trait, myTraits, myTraits_new),</span>
<span id="cb40-28"><a href="#cb40-28" tabindex="-1"></a>           <span class="at">Trait =</span> <span class="fu">factor</span>(Trait, <span class="at">levels =</span> myTraits_new))</span>
<span id="cb40-29"><a href="#cb40-29" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb40-30"><a href="#cb40-30" tabindex="-1"></a>  mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Cluster, <span class="at">y =</span> Value, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb40-31"><a href="#cb40-31" tabindex="-1"></a>    <span class="fu">geom_quasirandom</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb40-32"><a href="#cb40-32" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(Trait <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb40-33"><a href="#cb40-33" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(myColors_Cluster, <span class="st">&quot;violetred3&quot;</span>, <span class="st">&quot;tan3&quot;</span>) ) <span class="sc">+</span></span>
<span id="cb40-34"><a href="#cb40-34" tabindex="-1"></a>    theme_AGL <span class="sc">+</span></span>
<span id="cb40-35"><a href="#cb40-35" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-36"><a href="#cb40-36" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb40-37"><a href="#cb40-37" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb40-38"><a href="#cb40-38" tabindex="-1"></a>  mp</span>
<span id="cb40-39"><a href="#cb40-39" tabindex="-1"></a>}</span>
<span id="cb40-40"><a href="#cb40-40" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/PCA_test/Cluster02.png&quot;</span>, <span class="fu">ggHC_test</span>(<span class="dv">2</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb40-41"><a href="#cb40-41" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/PCA_test/Cluster03.png&quot;</span>, <span class="fu">ggHC_test</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb40-42"><a href="#cb40-42" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/PCA_test/Cluster04.png&quot;</span>, <span class="fu">ggHC_test</span>(<span class="dv">4</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb40-43"><a href="#cb40-43" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/PCA_test/Cluster05.png&quot;</span>, <span class="fu">ggHC_test</span>(<span class="dv">5</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb40-44"><a href="#cb40-44" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/PCA_test/Cluster06.png&quot;</span>, <span class="fu">ggHC_test</span>(<span class="dv">6</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb40-45"><a href="#cb40-45" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/PCA_test/Cluster07.png&quot;</span>, <span class="fu">ggHC_test</span>(<span class="dv">7</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb40-46"><a href="#cb40-46" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/PCA_test/Cluster08.png&quot;</span>, <span class="fu">ggHC_test</span>(<span class="dv">8</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb40-47"><a href="#cb40-47" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/PCA_test/Cluster09.png&quot;</span>, <span class="fu">ggHC_test</span>(<span class="dv">9</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb40-48"><a href="#cb40-48" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/PCA_test/Cluster10.png&quot;</span>, <span class="fu">ggHC_test</span>(<span class="dv">10</span>), <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
<hr />
</div>
</div>
<div id="supplemental-figure-4---pca" class="section level1">
<h1>Supplemental Figure 4 - PCA</h1>
<p><img src="Supplemental_Figure_04.jpg" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>perc <span class="ot">&lt;-</span> <span class="fu">round</span>(mypca[[<span class="dv">1</span>]][,<span class="dv">2</span>], <span class="dv">1</span>)</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="co"># Plot (a) PCA 1v2</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>find_hull <span class="ot">&lt;-</span> <span class="cf">function</span>(df) df[<span class="fu">chull</span>(df[,<span class="st">&quot;PC1&quot;</span>], df[,<span class="st">&quot;PC2&quot;</span>]), ]</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>polys <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">ddply</span>(myPCA, <span class="st">&quot;Cluster&quot;</span>, find_hull) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">factor</span>(Cluster))</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>mp1<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(myPCA) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> polys, <span class="at">alpha =</span> <span class="fl">0.15</span>, <span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">fill =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">colour =</span> Cluster), <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>  theme_AGL <span class="sc">+</span> </span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;A)&quot;</span>,</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">&quot;PC1 (&quot;</span>, perc[<span class="dv">1</span>], <span class="st">&quot;%)&quot;</span>),</span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">&quot;PC2 (&quot;</span>, perc[<span class="dv">2</span>], <span class="st">&quot;%)&quot;</span>))</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a><span class="co"># Plot (a) PCA 1v3</span></span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a>find_hull <span class="ot">&lt;-</span> <span class="cf">function</span>(df) df[<span class="fu">chull</span>(df[,<span class="st">&quot;PC1&quot;</span>], df[,<span class="st">&quot;PC3&quot;</span>]), ]</span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a>polys <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">ddply</span>(myPCA, <span class="st">&quot;Cluster&quot;</span>, find_hull) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">factor</span>(Cluster))</span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>mp1<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(myPCA) <span class="sc">+</span></span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> polys, <span class="at">alpha =</span> <span class="fl">0.15</span>, <span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC3, <span class="at">fill =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC3, <span class="at">colour =</span> Cluster), <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb41-24"><a href="#cb41-24" tabindex="-1"></a>  theme_AGL <span class="sc">+</span> </span>
<span id="cb41-25"><a href="#cb41-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb41-26"><a href="#cb41-26" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb41-27"><a href="#cb41-27" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">&quot;PC1 (&quot;</span>, perc[<span class="dv">1</span>], <span class="st">&quot;%)&quot;</span>),</span>
<span id="cb41-28"><a href="#cb41-28" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">&quot;PC3 (&quot;</span>, perc[<span class="dv">3</span>], <span class="st">&quot;%)&quot;</span>))</span>
<span id="cb41-29"><a href="#cb41-29" tabindex="-1"></a><span class="co"># Plot (a) PCA 2v3</span></span>
<span id="cb41-30"><a href="#cb41-30" tabindex="-1"></a>find_hull <span class="ot">&lt;-</span> <span class="cf">function</span>(df) df[<span class="fu">chull</span>(df[,<span class="st">&quot;PC2&quot;</span>], df[,<span class="st">&quot;PC3&quot;</span>]), ]</span>
<span id="cb41-31"><a href="#cb41-31" tabindex="-1"></a>polys <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">ddply</span>(myPCA, <span class="st">&quot;Cluster&quot;</span>, find_hull) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">factor</span>(Cluster))</span>
<span id="cb41-32"><a href="#cb41-32" tabindex="-1"></a>mp1<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(myPCA) <span class="sc">+</span></span>
<span id="cb41-33"><a href="#cb41-33" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> polys, <span class="at">alpha =</span> <span class="fl">0.15</span>, <span class="fu">aes</span>(<span class="at">x =</span> PC2, <span class="at">y =</span> PC3, <span class="at">fill =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb41-34"><a href="#cb41-34" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC2, <span class="at">y =</span> PC3, <span class="at">colour =</span> Cluster), <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb41-35"><a href="#cb41-35" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb41-36"><a href="#cb41-36" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb41-37"><a href="#cb41-37" tabindex="-1"></a>  theme_AGL <span class="sc">+</span> </span>
<span id="cb41-38"><a href="#cb41-38" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb41-39"><a href="#cb41-39" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb41-40"><a href="#cb41-40" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">&quot;PC2 (&quot;</span>, perc[<span class="dv">2</span>], <span class="st">&quot;%)&quot;</span>),</span>
<span id="cb41-41"><a href="#cb41-41" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">&quot;PC3 (&quot;</span>, perc[<span class="dv">3</span>], <span class="st">&quot;%)&quot;</span>))</span>
<span id="cb41-42"><a href="#cb41-42" tabindex="-1"></a><span class="co"># Append </span></span>
<span id="cb41-43"><a href="#cb41-43" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1<span class="fl">.1</span>, mp1<span class="fl">.2</span>, mp1<span class="fl">.3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb41-44"><a href="#cb41-44" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb41-45"><a href="#cb41-45" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">y =</span> perc[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>])</span>
<span id="cb41-46"><a href="#cb41-46" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb41-47"><a href="#cb41-47" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb41-48"><a href="#cb41-48" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb41-49"><a href="#cb41-49" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="sc">+</span> </span>
<span id="cb41-50"><a href="#cb41-50" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">&quot;PC&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb41-51"><a href="#cb41-51" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb41-52"><a href="#cb41-52" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;B)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Percent of Variation&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>)</span>
<span id="cb41-53"><a href="#cb41-53" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb41-54"><a href="#cb41-54" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.75</span>,<span class="dv">1</span>))</span>
<span id="cb41-55"><a href="#cb41-55" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Supplemental_Figure_04.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="fl">4.5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
<hr />
</div>
<div id="figure-5---pca-summary" class="section level1">
<h1>Figure 5 - PCA Summary</h1>
<p><img src="Figure_05.jpg" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>myTraits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;It17_v.k&quot;</span>, <span class="st">&quot;It17_h.k&quot;</span>, <span class="st">&quot;It17_a.k&quot;</span>, </span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>              <span class="st">&quot;It17_h.x.mid&quot;</span>, <span class="st">&quot;It17_a.x.mid&quot;</span>, </span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>              <span class="st">&quot;It17_v.perc.DTF&quot;</span>, <span class="st">&quot;It17_v.at.DTF&quot;</span>,</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>              <span class="co">#</span></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>              <span class="st">&quot;Su17_v.k&quot;</span>, <span class="st">&quot;Su17_h.k&quot;</span>, <span class="st">&quot;Su17_a.k&quot;</span>,</span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>              <span class="st">&quot;Su17_h.x.mid&quot;</span>, <span class="st">&quot;Su17_a.x.mid&quot;</span>,</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>              <span class="st">&quot;Su17_v.perc.DTF&quot;</span>, <span class="st">&quot;Su17_v.at.DTF&quot;</span> )</span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a>myTraits_new <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A) It17 Max V&quot;</span>, <span class="st">&quot;B) It17 Max H&quot;</span>, <span class="st">&quot;C) It17 Max A&quot;</span>, </span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a>                  <span class="st">&quot;D) It17 H x.mid&quot;</span>, <span class="st">&quot;E) It17 A x.mid&quot;</span>, </span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a>                  <span class="st">&quot;F) It17 % V at DTF&quot;</span>, <span class="st">&quot;G) It17 V at DTF&quot;</span>,</span>
<span id="cb42-13"><a href="#cb42-13" tabindex="-1"></a>                  <span class="co">#</span></span>
<span id="cb42-14"><a href="#cb42-14" tabindex="-1"></a>                  <span class="st">&quot;H) Su17 Max V&quot;</span>, <span class="st">&quot;I) Su17 Max H&quot;</span>, <span class="st">&quot;J) Su17 Max A&quot;</span>,</span>
<span id="cb42-15"><a href="#cb42-15" tabindex="-1"></a>                  <span class="st">&quot;K) Su17 H x.mid&quot;</span>, <span class="st">&quot;L) Su17 A x.mid&quot;</span>,</span>
<span id="cb42-16"><a href="#cb42-16" tabindex="-1"></a>                  <span class="st">&quot;M) Su17 % V at DTF&quot;</span>, <span class="st">&quot;N) Su17 V at DTF&quot;</span>)</span>
<span id="cb42-17"><a href="#cb42-17" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb42-18"><a href="#cb42-18" tabindex="-1"></a>xx <span class="ot">&lt;-</span> myPCAinput <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-19"><a href="#cb42-19" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(myPCA, Entry, Name, Origin, Cluster), <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-20"><a href="#cb42-20" tabindex="-1"></a>  <span class="fu">select</span>(Entry, Name, Origin, Cluster, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb42-21"><a href="#cb42-21" tabindex="-1"></a>  <span class="fu">gather</span>(Trait, Value, <span class="dv">5</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb42-22"><a href="#cb42-22" tabindex="-1"></a>  <span class="fu">filter</span>(Trait <span class="sc">%in%</span> myTraits) <span class="sc">%&gt;%</span></span>
<span id="cb42-23"><a href="#cb42-23" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Trait, myTraits, myTraits_new),</span>
<span id="cb42-24"><a href="#cb42-24" tabindex="-1"></a>         <span class="at">Trait =</span> <span class="fu">factor</span>(Trait, <span class="at">levels =</span> myTraits_new))</span>
<span id="cb42-25"><a href="#cb42-25" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb42-26"><a href="#cb42-26" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Cluster, <span class="at">y =</span> Value, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb42-27"><a href="#cb42-27" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">pch =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb42-28"><a href="#cb42-28" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Trait <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb42-29"><a href="#cb42-29" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb42-30"><a href="#cb42-30" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb42-31"><a href="#cb42-31" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb42-32"><a href="#cb42-32" tabindex="-1"></a>        <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb42-33"><a href="#cb42-33" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-34"><a href="#cb42-34" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb42-35"><a href="#cb42-35" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb42-36"><a href="#cb42-36" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb42-37"><a href="#cb42-37" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Figure_05.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
<hr />
</div>
<div id="supplemental-figure-5---pca-inputs" class="section level1">
<h1>Supplemental Figure 5 - PCA Inputs</h1>
<p><img src="Supplemental_Figure_05.jpg" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>myTraits1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;It17_v.k&quot;</span>, <span class="st">&quot;It17_h.k&quot;</span>, <span class="st">&quot;It17_a.k&quot;</span>, <span class="st">&quot;It17_v.x.mid&quot;</span>, <span class="st">&quot;It17_h.x.mid&quot;</span>, <span class="st">&quot;It17_a.x.mid&quot;</span>,</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>               <span class="st">&quot;Su17_v.k&quot;</span>, <span class="st">&quot;Su17_h.k&quot;</span>, <span class="st">&quot;Su17_a.k&quot;</span>, <span class="st">&quot;Su17_v.x.mid&quot;</span>, <span class="st">&quot;Su17_h.x.mid&quot;</span>, <span class="st">&quot;Su17_a.x.mid&quot;</span>,</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>               <span class="co">#</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>               <span class="st">&quot;It17_v.perc.DTF&quot;</span>, <span class="st">&quot;It17_h.perc.DTF&quot;</span>, <span class="st">&quot;It17_a.perc.DTF&quot;</span>,</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>               <span class="st">&quot;It17_v.at.DTF&quot;</span>, <span class="st">&quot;It17_h.at.DTF&quot;</span>, <span class="st">&quot;It17_a.at.DTF&quot;</span>,</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>               <span class="co">#</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>               <span class="st">&quot;Su17_v.perc.DTF&quot;</span>, <span class="st">&quot;Su17_h.perc.DTF&quot;</span>, <span class="st">&quot;Su17_a.perc.DTF&quot;</span>,</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>               <span class="st">&quot;Su17_v.at.DTF&quot;</span>, <span class="st">&quot;Su17_h.at.DTF&quot;</span>, <span class="st">&quot;Su17_a.at.DTF&quot;</span>,</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>               <span class="st">&quot;It17_v.xmax.DTF&quot;</span>, <span class="st">&quot;It17_h.xmax.DTF&quot;</span>, <span class="st">&quot;It17_a.xmax.DTF&quot;</span>, </span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>               <span class="st">&quot;Su17_v.xmax.DTF&quot;</span>, <span class="st">&quot;Su17_h.xmax.DTF&quot;</span>, <span class="st">&quot;Su17_a.xmax.DTF&quot;</span>,</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>               <span class="co">#</span></span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>               <span class="st">&quot;It17_v.x.d&quot;</span>, <span class="st">&quot;It17_h.x.d&quot;</span>, <span class="st">&quot;It17_a.x.d&quot;</span>, <span class="st">&quot;It17_v.g.r&quot;</span>, <span class="st">&quot;It17_h.g.r&quot;</span>, <span class="st">&quot;It17_a.g.r&quot;</span>,</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>               <span class="st">&quot;Su17_v.x.d&quot;</span>, <span class="st">&quot;Su17_h.x.d&quot;</span>, <span class="st">&quot;Su17_a.x.d&quot;</span>, <span class="st">&quot;Su17_v.g.r&quot;</span>, <span class="st">&quot;Su17_h.g.r&quot;</span>, <span class="st">&quot;Su17_a.g.r&quot;</span> )</span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>xx <span class="ot">&lt;-</span> myPCAinput <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(myPCA, Entry, Name, Origin, Cluster), <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>  <span class="fu">select</span>(Entry, Name, Origin, Cluster, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a>  <span class="fu">gather</span>(Trait, Value, <span class="dv">5</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">factor</span>(Trait, <span class="at">levels =</span> myTraits1))</span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Cluster, <span class="at">y =</span> Value, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">pch =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Trait <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb43-26"><a href="#cb43-26" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb43-27"><a href="#cb43-27" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb43-28"><a href="#cb43-28" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-29"><a href="#cb43-29" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb43-30"><a href="#cb43-30" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb43-31"><a href="#cb43-31" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb43-32"><a href="#cb43-32" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Supplemental_Figure_05.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">14</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
<hr />
<div id="additional-figures-4---pca-map" class="section level2">
<h2>Additional Figures 4 - PCA Map</h2>
<p><img src="Additional/Additional_Figure_04.png" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="fu">library</span>(rworldmap)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>yy <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/derekmichaelwright/AGILE_LDP_Phenology/master/data/data_countries.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Origin=</span>Country, Lat, Lon)</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>xx <span class="ot">&lt;-</span> myPCA <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>  <span class="fu">left_join</span>(yy, <span class="at">by =</span> <span class="st">&quot;Origin&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Origin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ICARDA&quot;</span>,<span class="st">&quot;USDA&quot;</span>,<span class="st">&quot;Unknown&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>  <span class="fu">group_by</span>(Origin, Cluster, Lat, Lon) <span class="sc">%&gt;%</span> </span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>  <span class="fu">spread</span>(Cluster, Count) <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;Additional/Additional_Figure_04.png&quot;</span>, <span class="at">width =</span> <span class="dv">3600</span>, <span class="at">height =</span> <span class="dv">2055</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mai =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">xaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="at">yaxs =</span> <span class="st">&quot;i&quot;</span>)</span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a><span class="fu">mapPies</span>(<span class="at">dF =</span> xx, <span class="at">nameX =</span> <span class="st">&quot;Lon&quot;</span>, <span class="at">nameY =</span> <span class="st">&quot;Lat&quot;</span>, </span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>        <span class="at">zColours =</span> myColors_Cluster, <span class="at">nameZs =</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>), <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a>        <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">140</span>,<span class="dv">110</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>), <span class="at">addCatLegend =</span> F,</span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>        <span class="at">oceanCol =</span> <span class="st">&quot;grey90&quot;</span>, <span class="at">landCol =</span> <span class="st">&quot;white&quot;</span>, <span class="at">borderCol =</span> <span class="st">&quot;black&quot;</span>) </span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a><span class="fu">legend</span>(<span class="sc">-</span><span class="fl">138.5</span>, <span class="fl">15.5</span>, <span class="at">title =</span> <span class="st">&quot;PCA Cluster&quot;</span>, <span class="at">legend =</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>), </span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a>       <span class="at">col =</span> myColors_Cluster, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pt.cex =</span> <span class="fl">1.25</span>, <span class="at">box.lwd =</span> <span class="dv">2</span>)</span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<hr />
</div>
<div id="additional-figures-5---ah-x-clusters" class="section level2">
<h2>Additional Figures 5 - AH x Clusters</h2>
<p><img src="Additional/Additional_Figure_05.png" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>myPCA <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;myPCA.csv&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">factor</span>(Cluster))</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>  it17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Entry, Expt, <span class="at">Height=</span>k),</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>  it17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Entry, Expt, <span class="at">Area=</span>k),</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>, <span class="st">&quot;Entry&quot;</span>, <span class="st">&quot;Expt&quot;</span>))</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>  su17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Entry, Expt, <span class="at">Height=</span>k),</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>  su17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Entry, Expt, <span class="at">Area=</span>k),</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>, <span class="st">&quot;Entry&quot;</span>, <span class="st">&quot;Expt&quot;</span>))</span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(x1, x2) <span class="sc">%&gt;%</span></span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>  <span class="fu">group_by</span>(Expt, Entry) <span class="sc">%&gt;%</span></span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Area =</span> <span class="fu">mean</span>(Area, <span class="at">na.rm =</span> T),</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>            <span class="at">Height =</span> <span class="fu">mean</span>(Height, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(myPCA, Entry, Cluster), <span class="at">by =</span> <span class="st">&quot;Entry&quot;</span>)</span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Area, <span class="at">y =</span> Height, <span class="at">color =</span> Cluster, <span class="at">alpha =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Expt) <span class="sc">+</span></span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Plot Height&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Plot Area&quot;</span>)</span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> mp <span class="sc">+</span> <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.9</span>), <span class="at">guide =</span> F)</span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> mp <span class="sc">+</span> <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>), <span class="at">guide =</span> F)</span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> mp <span class="sc">+</span> <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="at">guide =</span> F)</span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> mp <span class="sc">+</span> <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="at">guide =</span> F)</span>
<span id="cb45-29"><a href="#cb45-29" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb45-30"><a href="#cb45-30" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, mp4, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb45-31"><a href="#cb45-31" tabindex="-1"></a>                <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>) </span>
<span id="cb45-32"><a href="#cb45-32" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_05.png&quot;</span>, mp, </span>
<span id="cb45-33"><a href="#cb45-33" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="additional-figures-6---dtf-x-volume" class="section level2">
<h2>Additional Figures 6 - DTF x Volume</h2>
<p><img src="Additional/Additional_Figure_06.png" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(it17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;DTF&quot;</span>, <span class="st">&quot;Seed.Mass&quot;</span>)),</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>            ro17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;DTF&quot;</span>, <span class="st">&quot;Seed.Mass&quot;</span>)),</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>            su17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;DTF&quot;</span>, <span class="st">&quot;Seed.Mass&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>  <span class="fu">spread</span>(Trait, Value) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>  <span class="fu">group_by</span>(Expt) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Seed.Mass_scaled =</span> scales<span class="sc">::</span><span class="fu">rescale</span>(Seed.Mass))</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(it17_gc.v[[<span class="dv">2</span>]],</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a>            ro17_gc.v[[<span class="dv">2</span>]],</span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>            su17_gc.v[[<span class="dv">2</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a>  <span class="fu">select</span>(Plot, <span class="at">Volume=</span>k)</span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;myPCA.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a>  <span class="fu">select</span>(Name, Cluster)</span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x1, x2, <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>  <span class="fu">left_join</span>(x3, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">factor</span>(Cluster))</span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> DTF, <span class="at">y =</span> Volume, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Expt <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-21"><a href="#cb46-21" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb46-22"><a href="#cb46-22" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>))) <span class="sc">+</span></span>
<span id="cb46-23"><a href="#cb46-23" tabindex="-1"></a>  theme_AGL</span>
<span id="cb46-24"><a href="#cb46-24" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> DTF, <span class="at">y =</span> Seed.Mass, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb46-25"><a href="#cb46-25" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-26"><a href="#cb46-26" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Expt <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-27"><a href="#cb46-27" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb46-28"><a href="#cb46-28" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>))) <span class="sc">+</span></span>
<span id="cb46-29"><a href="#cb46-29" tabindex="-1"></a>  theme_AGL</span>
<span id="cb46-30"><a href="#cb46-30" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb46-31"><a href="#cb46-31" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb46-32"><a href="#cb46-32" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_06.png&quot;</span>, mp, </span>
<span id="cb46-33"><a href="#cb46-33" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="additional-figures-7---vha-x-seed-mass" class="section level2">
<h2>Additional Figures 7 - VHA x Seed Mass</h2>
<p><img src="Additional/Additional_Figure_07.png" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># Volume</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>x1<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rbind</span>(it17_gc.v[[<span class="dv">2</span>]], ro17_gc.v[[<span class="dv">2</span>]], su17_gc.v[[<span class="dv">2</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Name, Expt, <span class="at">Value=</span>k)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(it17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>),</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>            ro17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>),</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>            su17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>) ) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Name, Expt, <span class="at">Seed.Mass=</span>Value) </span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;myPCA.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">factor</span>(Cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>  <span class="fu">select</span>(Name, Entry, Cluster)</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>xx1 <span class="ot">&lt;-</span> x1<span class="fl">.1</span> <span class="sc">%&gt;%</span> </span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>  <span class="fu">left_join</span>(x2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;Name&quot;</span>,<span class="st">&quot;Expt&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>  <span class="fu">left_join</span>(x3, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>  <span class="fu">group_by</span>(Entry, Name, Expt, Cluster) <span class="sc">%&gt;%</span></span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Seed.Mass =</span> <span class="fu">mean</span>(Seed.Mass, <span class="at">na.rm =</span> T),</span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a>            <span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="fu">ifelse</span>(Expt <span class="sc">==</span> <span class="st">&quot;Italy 2017&quot;</span> <span class="sc">&amp;</span> Seed.Mass <span class="sc">&gt;</span> <span class="dv">150</span>, <span class="st">&quot;Adapted&quot;</span>, <span class="st">&quot;Unadapted&quot;</span>),</span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a>         <span class="at">Group =</span> <span class="fu">ifelse</span>(Expt <span class="sc">==</span> <span class="st">&quot;Sutherland 2017&quot;</span> <span class="sc">&amp;</span> Seed.Mass <span class="sc">&gt;</span> <span class="dv">300</span>, <span class="st">&quot;Adapted&quot;</span>, Group),</span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a>         <span class="at">Group =</span> <span class="fu">ifelse</span>(Expt <span class="sc">==</span> <span class="st">&quot;Rosthern 2017&quot;</span> <span class="sc">&amp;</span> Seed.Mass <span class="sc">&gt;</span> <span class="dv">300</span>, <span class="st">&quot;Adapted&quot;</span>, Group),</span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a>         <span class="at">Trait =</span> <span class="st">&quot;Volume&quot;</span>)</span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx1, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Seed.Mass, <span class="at">color =</span> Cluster, <span class="at">alpha =</span> Group)) <span class="sc">+</span></span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb47-24"><a href="#cb47-24" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Expt <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-25"><a href="#cb47-25" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb47-26"><a href="#cb47-26" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb47-27"><a href="#cb47-27" tabindex="-1"></a>  theme_AGL <span class="sc">+</span> </span>
<span id="cb47-28"><a href="#cb47-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Plot Yield (g)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Volume&quot;</span>)</span>
<span id="cb47-29"><a href="#cb47-29" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_07_1.png&quot;</span>, mp1, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="fl">3.5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb47-30"><a href="#cb47-30" tabindex="-1"></a><span class="co"># Height</span></span>
<span id="cb47-31"><a href="#cb47-31" tabindex="-1"></a>x1<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">rbind</span>(it17_gc.h[[<span class="dv">2</span>]], ro17_gc.h[[<span class="dv">2</span>]], su17_gc.h[[<span class="dv">2</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb47-32"><a href="#cb47-32" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Name, Expt, <span class="at">Value=</span>k)</span>
<span id="cb47-33"><a href="#cb47-33" tabindex="-1"></a>xx2 <span class="ot">&lt;-</span> x1<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb47-34"><a href="#cb47-34" tabindex="-1"></a>  <span class="fu">left_join</span>(x2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;Name&quot;</span>,<span class="st">&quot;Expt&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-35"><a href="#cb47-35" tabindex="-1"></a>  <span class="fu">left_join</span>(x3, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-36"><a href="#cb47-36" tabindex="-1"></a>  <span class="fu">group_by</span>(Entry, Name, Expt, Cluster) <span class="sc">%&gt;%</span></span>
<span id="cb47-37"><a href="#cb47-37" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Seed.Mass =</span> <span class="fu">mean</span>(Seed.Mass, <span class="at">na.rm =</span> T),</span>
<span id="cb47-38"><a href="#cb47-38" tabindex="-1"></a>            <span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb47-39"><a href="#cb47-39" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="fu">ifelse</span>(Expt <span class="sc">==</span> <span class="st">&quot;Italy 2017&quot;</span> <span class="sc">&amp;</span> Seed.Mass <span class="sc">&gt;</span> <span class="dv">150</span>, <span class="st">&quot;Adapted&quot;</span>, <span class="st">&quot;Unadapted&quot;</span>),</span>
<span id="cb47-40"><a href="#cb47-40" tabindex="-1"></a>         <span class="at">Group =</span> <span class="fu">ifelse</span>(Expt <span class="sc">==</span> <span class="st">&quot;Sutherland 2017&quot;</span> <span class="sc">&amp;</span> Seed.Mass <span class="sc">&gt;</span> <span class="dv">300</span>, <span class="st">&quot;Adapted&quot;</span>, Group),</span>
<span id="cb47-41"><a href="#cb47-41" tabindex="-1"></a>         <span class="at">Group =</span> <span class="fu">ifelse</span>(Expt <span class="sc">==</span> <span class="st">&quot;Rosthern 2017&quot;</span> <span class="sc">&amp;</span> Seed.Mass <span class="sc">&gt;</span> <span class="dv">300</span>, <span class="st">&quot;Adapted&quot;</span>, Group),</span>
<span id="cb47-42"><a href="#cb47-42" tabindex="-1"></a>         <span class="at">Trait =</span> <span class="st">&quot;Height&quot;</span>)</span>
<span id="cb47-43"><a href="#cb47-43" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb47-44"><a href="#cb47-44" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx2, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Seed.Mass, <span class="at">color =</span> Cluster, <span class="at">alpha =</span> Group)) <span class="sc">+</span></span>
<span id="cb47-45"><a href="#cb47-45" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb47-46"><a href="#cb47-46" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Expt <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-47"><a href="#cb47-47" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb47-48"><a href="#cb47-48" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb47-49"><a href="#cb47-49" tabindex="-1"></a>  theme_AGL <span class="sc">+</span> </span>
<span id="cb47-50"><a href="#cb47-50" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Plot Yield (g)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Height&quot;</span>)</span>
<span id="cb47-51"><a href="#cb47-51" tabindex="-1"></a><span class="co"># Area</span></span>
<span id="cb47-52"><a href="#cb47-52" tabindex="-1"></a>x1<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">rbind</span>(it17_gc.a[[<span class="dv">2</span>]], ro17_gc.a[[<span class="dv">2</span>]], su17_gc.a[[<span class="dv">2</span>]]) <span class="sc">%&gt;%</span></span>
<span id="cb47-53"><a href="#cb47-53" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Name, Expt, <span class="at">Value=</span>k)</span>
<span id="cb47-54"><a href="#cb47-54" tabindex="-1"></a>xx3 <span class="ot">&lt;-</span> x1<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb47-55"><a href="#cb47-55" tabindex="-1"></a>  <span class="fu">left_join</span>(x2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>,<span class="st">&quot;Name&quot;</span>,<span class="st">&quot;Expt&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-56"><a href="#cb47-56" tabindex="-1"></a>  <span class="fu">left_join</span>(x3, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-57"><a href="#cb47-57" tabindex="-1"></a>  <span class="fu">group_by</span>(Entry, Name, Expt, Cluster) <span class="sc">%&gt;%</span></span>
<span id="cb47-58"><a href="#cb47-58" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Seed.Mass =</span> <span class="fu">mean</span>(Seed.Mass, <span class="at">na.rm =</span> T),</span>
<span id="cb47-59"><a href="#cb47-59" tabindex="-1"></a>            <span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb47-60"><a href="#cb47-60" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="fu">ifelse</span>(Expt <span class="sc">==</span> <span class="st">&quot;Italy 2017&quot;</span> <span class="sc">&amp;</span> Seed.Mass <span class="sc">&gt;</span> <span class="dv">150</span>, <span class="st">&quot;Adapted&quot;</span>, <span class="st">&quot;Unadapted&quot;</span>),</span>
<span id="cb47-61"><a href="#cb47-61" tabindex="-1"></a>         <span class="at">Group =</span> <span class="fu">ifelse</span>(Expt <span class="sc">==</span> <span class="st">&quot;Sutherland 2017&quot;</span> <span class="sc">&amp;</span> Seed.Mass <span class="sc">&gt;</span> <span class="dv">300</span>, <span class="st">&quot;Adapted&quot;</span>, Group),</span>
<span id="cb47-62"><a href="#cb47-62" tabindex="-1"></a>         <span class="at">Group =</span> <span class="fu">ifelse</span>(Expt <span class="sc">==</span> <span class="st">&quot;Rosthern 2017&quot;</span> <span class="sc">&amp;</span> Seed.Mass <span class="sc">&gt;</span> <span class="dv">300</span>, <span class="st">&quot;Adapted&quot;</span>, Group),</span>
<span id="cb47-63"><a href="#cb47-63" tabindex="-1"></a>         <span class="at">Trait =</span> <span class="st">&quot;Area&quot;</span>)</span>
<span id="cb47-64"><a href="#cb47-64" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb47-65"><a href="#cb47-65" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx3, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">y =</span> Seed.Mass, <span class="at">color =</span> Cluster, <span class="at">alpha =</span> Group)) <span class="sc">+</span></span>
<span id="cb47-66"><a href="#cb47-66" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb47-67"><a href="#cb47-67" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Expt <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-68"><a href="#cb47-68" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb47-69"><a href="#cb47-69" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb47-70"><a href="#cb47-70" tabindex="-1"></a>  theme_AGL <span class="sc">+</span> </span>
<span id="cb47-71"><a href="#cb47-71" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Plot Yield (g)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Area&quot;</span>)</span>
<span id="cb47-72"><a href="#cb47-72" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb47-73"><a href="#cb47-73" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(xx1, xx2, xx3)</span>
<span id="cb47-74"><a href="#cb47-74" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb47-75"><a href="#cb47-75" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">y =</span> Value, <span class="at">x =</span> Seed.Mass, </span>
<span id="cb47-76"><a href="#cb47-76" tabindex="-1"></a>                     <span class="at">color =</span> Cluster, <span class="at">alpha =</span> Group)) <span class="sc">+</span></span>
<span id="cb47-77"><a href="#cb47-77" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb47-78"><a href="#cb47-78" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Trait <span class="sc">~</span> Expt, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-79"><a href="#cb47-79" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb47-80"><a href="#cb47-80" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb47-81"><a href="#cb47-81" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb47-82"><a href="#cb47-82" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Plot Yield (g)&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb47-83"><a href="#cb47-83" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_07.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
<hr />
</div>
<div id="additional-figures-8---vha-x-cluster" class="section level2">
<h2>Additional Figures 8 - VH/A x Cluster</h2>
<p><img src="Additional/Additional_Figure_08.png" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> myPCAinput <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>  <span class="fu">select</span>(Name, It17_h.k, It17_a.k, It17_v.k, Su17_h.k, Su17_a.k, Su17_v.k)</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">It17 =</span> It17_h.k <span class="sc">/</span> It17_a.k,</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>         <span class="at">Su17 =</span> Su17_h.k <span class="sc">/</span> Su17_a.k) <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>  <span class="fu">select</span>(Name, It17, Su17) <span class="sc">%&gt;%</span></span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>  <span class="fu">gather</span>(Expt, HA_Ratio, It17, Su17)</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">select</span>(Name, <span class="at">It17=</span>It17_v.k, <span class="at">Su17=</span>Su17_v.k) <span class="sc">%&gt;%</span></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">It17 =</span> scales<span class="sc">::</span><span class="fu">rescale</span>(It17),</span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a>         <span class="at">Su17 =</span> scales<span class="sc">::</span><span class="fu">rescale</span>(Su17)) <span class="sc">%&gt;%</span></span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a>  <span class="fu">gather</span>(Expt, Volume, It17, Su17)</span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">left_join</span>(x1, x2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Name&quot;</span>, <span class="st">&quot;Expt&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(myPCA, Name, Cluster), <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>)</span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Cluster, <span class="at">y =</span> HA_Ratio, <span class="at">size =</span> Volume, <span class="at">fill =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb48-18"><a href="#cb48-18" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Expt <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb48-19"><a href="#cb48-19" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> myColors_Cluster, <span class="at">guide =</span> F) <span class="sc">+</span></span>
<span id="cb48-20"><a href="#cb48-20" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Scaled Volume&quot;</span>, <span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb48-21"><a href="#cb48-21" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb48-22"><a href="#cb48-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Height / Area&quot;</span>)</span>
<span id="cb48-23"><a href="#cb48-23" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb48-24"><a href="#cb48-24" tabindex="-1"></a>xx <span class="ot">&lt;-</span> myPCAinput <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-25"><a href="#cb48-25" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-26"><a href="#cb48-26" tabindex="-1"></a>  <span class="fu">select</span>(Name, It17_h.k, It17_a.k, It17_v.k, Su17_h.k, Su17_a.k, Su17_v.k) <span class="sc">%&gt;%</span></span>
<span id="cb48-27"><a href="#cb48-27" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">It17 =</span> It17_v.k <span class="sc">*</span> It17_h.k <span class="sc">/</span> It17_a.k,</span>
<span id="cb48-28"><a href="#cb48-28" tabindex="-1"></a>         <span class="at">Su17 =</span> Su17_v.k <span class="sc">*</span> Su17_h.k <span class="sc">/</span> Su17_a.k) <span class="sc">%&gt;%</span></span>
<span id="cb48-29"><a href="#cb48-29" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(myPCA, Name, Cluster), <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-30"><a href="#cb48-30" tabindex="-1"></a>  <span class="fu">select</span>(Name, Cluster, It17, Su17) <span class="sc">%&gt;%</span></span>
<span id="cb48-31"><a href="#cb48-31" tabindex="-1"></a>  <span class="fu">gather</span>(Expt, Value, It17, Su17) <span class="sc">%&gt;%</span></span>
<span id="cb48-32"><a href="#cb48-32" tabindex="-1"></a>  <span class="fu">left_join</span>(x2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Name&quot;</span>, <span class="st">&quot;Expt&quot;</span>))</span>
<span id="cb48-33"><a href="#cb48-33" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb48-34"><a href="#cb48-34" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Cluster, <span class="at">y =</span> Value, <span class="at">size =</span> Volume, <span class="at">fill =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb48-35"><a href="#cb48-35" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb48-36"><a href="#cb48-36" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Expt <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb48-37"><a href="#cb48-37" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb48-38"><a href="#cb48-38" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Scaled Volume&quot;</span>, <span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb48-39"><a href="#cb48-39" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb48-40"><a href="#cb48-40" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Volume * Height / Area&quot;</span>)</span>
<span id="cb48-41"><a href="#cb48-41" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb48-42"><a href="#cb48-42" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.85</span>),</span>
<span id="cb48-43"><a href="#cb48-43" tabindex="-1"></a>                <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb48-44"><a href="#cb48-44" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_08.png&quot;</span>, mp, </span>
<span id="cb48-45"><a href="#cb48-45" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="additional-figures-9---harvest-index" class="section level2">
<h2>Additional Figures 9 - Harvest Index</h2>
<p><img src="Additional/Additional_Figure_09.png" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(it17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>                  <span class="fu">select</span>(Plot, Expt, Entry, Name, <span class="at">Seed.Mass=</span>Value),</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>                su17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>                  <span class="fu">select</span>(Plot, Expt, Entry, Name, <span class="at">Seed.Mass=</span>Value) )</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(it17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Expt, Entry, Name, <span class="at">Volume=</span>k),</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>                su17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Expt, Entry, Name, <span class="at">Volume=</span>k) )</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">full_join</span>(x1, x2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>, <span class="st">&quot;Expt&quot;</span>, <span class="st">&quot;Entry&quot;</span>, <span class="st">&quot;Name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(myPCA, Entry, Cluster), <span class="at">by =</span> <span class="st">&quot;Entry&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span> <span class="ot">=</span> Seed.Mass <span class="sc">/</span> Volume) <span class="sc">%&gt;%</span></span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>  <span class="fu">group_by</span>(Expt, Entry, Name, Cluster) <span class="sc">%&gt;%</span></span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span>, <span class="at">na.rm =</span> T),</span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>            <span class="st">`</span><span class="at">Seed Mass</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(Seed.Mass, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Expt, <span class="fu">c</span>(<span class="st">&quot;Italy 2017&quot;</span>,<span class="st">&quot;Sutherland 2017&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;It17&quot;</span>, <span class="st">&quot;Su17&quot;</span>)))</span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Cluster, <span class="at">y =</span> <span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span>, <span class="at">fill =</span> Cluster, <span class="at">size =</span> <span class="st">`</span><span class="at">Seed Mass</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Expt) <span class="sc">+</span></span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> myColors_Cluster, <span class="at">guide =</span> F) <span class="sc">+</span></span>
<span id="cb49-20"><a href="#cb49-20" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb49-21"><a href="#cb49-21" tabindex="-1"></a>  theme_AGL</span>
<span id="cb49-22"><a href="#cb49-22" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb49-23"><a href="#cb49-23" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Expt, <span class="at">y =</span> <span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span>, <span class="at">fill =</span> Cluster, <span class="at">group =</span> Entry)) <span class="sc">+</span></span>
<span id="cb49-24"><a href="#cb49-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb49-25"><a href="#cb49-25" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="st">`</span><span class="at">Seed Mass</span><span class="st">`</span>), <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-26"><a href="#cb49-26" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Cluster) <span class="sc">+</span></span>
<span id="cb49-27"><a href="#cb49-27" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> myColors_Cluster, <span class="at">guide =</span> F) <span class="sc">+</span></span>
<span id="cb49-28"><a href="#cb49-28" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb49-29"><a href="#cb49-29" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb49-30"><a href="#cb49-30" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb49-31"><a href="#cb49-31" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb49-32"><a href="#cb49-32" tabindex="-1"></a>xx <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Seed Mass</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-33"><a href="#cb49-33" tabindex="-1"></a>  <span class="fu">spread</span>(Expt, <span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-34"><a href="#cb49-34" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diff =</span> <span class="st">`</span><span class="at">Su17</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">It17</span><span class="st">`</span>)</span>
<span id="cb49-35"><a href="#cb49-35" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Cluster, <span class="at">y =</span> Diff, <span class="at">fill =</span> Cluster, <span class="at">size =</span> <span class="st">`</span><span class="at">Seed Mass</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb49-36"><a href="#cb49-36" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">pch =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb49-37"><a href="#cb49-37" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> myColors_Cluster, <span class="at">guide =</span> F) <span class="sc">+</span></span>
<span id="cb49-38"><a href="#cb49-38" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb49-39"><a href="#cb49-39" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;HI Difference (Su17 - It17)&quot;</span>)</span>
<span id="cb49-40"><a href="#cb49-40" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb49-41"><a href="#cb49-41" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>, </span>
<span id="cb49-42"><a href="#cb49-42" tabindex="-1"></a>                <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb49-43"><a href="#cb49-43" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_09.png&quot;</span>, mp,</span>
<span id="cb49-44"><a href="#cb49-44" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">9</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="additional-figures-10---harvest-index-x-dtf"
class="section level2">
<h2>Additional Figures 10 - Harvest Index x DTF</h2>
<p><img src="Additional/Additional_Figure_10.png" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> it17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Name, <span class="at">Seed.Mass=</span>Value)</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> it17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, <span class="at">Volume=</span>k)</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(y1, y2, <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Italy 2017&quot;</span>,</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>         <span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span> <span class="ot">=</span> Seed.Mass <span class="sc">/</span> Volume)</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> su17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Name, <span class="at">Seed.Mass=</span>Value)</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> su17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, <span class="at">Volume=</span>k)</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(y1, y2, <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Sutherland 2017&quot;</span>,</span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a>         <span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span> <span class="ot">=</span> Seed.Mass <span class="sc">/</span> Volume)</span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(x1, x2) <span class="sc">%&gt;%</span></span>
<span id="cb50-14"><a href="#cb50-14" tabindex="-1"></a>  <span class="fu">group_by</span>(Name, Expt) <span class="sc">%&gt;%</span></span>
<span id="cb50-15"><a href="#cb50-15" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span>, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb50-16"><a href="#cb50-16" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(myPCA, Name, Cluster), <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-17"><a href="#cb50-17" tabindex="-1"></a>  <span class="fu">left_join</span>(myPCAinput <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-18"><a href="#cb50-18" tabindex="-1"></a>              <span class="fu">select</span>(Name, Su17_v.perc.DTF, It17_v.perc.DTF ), <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>)</span>
<span id="cb50-19"><a href="#cb50-19" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb50-20"><a href="#cb50-20" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Expt, <span class="at">y =</span> <span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span>, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb50-21"><a href="#cb50-21" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">pch =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb50-22"><a href="#cb50-22" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb50-23"><a href="#cb50-23" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb50-24"><a href="#cb50-24" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb50-25"><a href="#cb50-25" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Expt <span class="sc">==</span> <span class="st">&quot;Italy 2017&quot;</span>), </span>
<span id="cb50-26"><a href="#cb50-26" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> It17_v.perc.DTF, <span class="at">y =</span> <span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span>, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb50-27"><a href="#cb50-27" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">pch =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb50-28"><a href="#cb50-28" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb50-29"><a href="#cb50-29" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb50-30"><a href="#cb50-30" tabindex="-1"></a>  theme_AGL</span>
<span id="cb50-31"><a href="#cb50-31" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Expt <span class="sc">==</span> <span class="st">&quot;Sutherland 2017&quot;</span>), </span>
<span id="cb50-32"><a href="#cb50-32" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Su17_v.perc.DTF, <span class="at">y =</span> <span class="st">`</span><span class="at">Harvest Index</span><span class="st">`</span>, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb50-33"><a href="#cb50-33" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">pch =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb50-34"><a href="#cb50-34" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb50-35"><a href="#cb50-35" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb50-36"><a href="#cb50-36" tabindex="-1"></a>  theme_AGL</span>
<span id="cb50-37"><a href="#cb50-37" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb50-38"><a href="#cb50-38" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp2, mp3, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb50-39"><a href="#cb50-39" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb50-40"><a href="#cb50-40" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_10.png&quot;</span>, mp, </span>
<span id="cb50-41"><a href="#cb50-41" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
</div>
<div id="figure-06---envchange" class="section level1">
<h1>Figure 06 - EnvChange</h1>
<p><img src="Figure_06.jpg" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(it17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Name, Expt, <span class="at">Area=</span>k),</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>                it17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, <span class="at">Height=</span>k), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>  <span class="fu">left_join</span>(it17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, <span class="at">Volume=</span>k))</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(ro17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Name, Expt, <span class="at">Area=</span>k),</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>                ro17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, <span class="at">Height=</span>k), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>  <span class="fu">left_join</span>(ro17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, <span class="at">Volume=</span>k))</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(su17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, Name, Expt, <span class="at">Area=</span>k),</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>                su17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, <span class="at">Height=</span>k), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>  <span class="fu">left_join</span>(su17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Plot, <span class="at">Volume=</span>k))</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(x1, x2, x3) <span class="sc">%&gt;%</span></span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(myPCA, Name, Cluster), <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Name, Expt, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a>  <span class="fu">group_by</span>( Name, Expt, Cluster) <span class="sc">%&gt;%</span></span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(Area, Height, Volume), <span class="fu">funs</span>(mean), <span class="at">na.rm =</span> T)</span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a>yy <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span></span>
<span id="cb51-19"><a href="#cb51-19" tabindex="-1"></a>  <span class="fu">gather</span>(Trait, Value, Area, Height, Volume) <span class="sc">%&gt;%</span> </span>
<span id="cb51-20"><a href="#cb51-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">paste</span>(<span class="st">&quot;Plot&quot;</span>, Trait)) <span class="sc">%&gt;%</span></span>
<span id="cb51-21"><a href="#cb51-21" tabindex="-1"></a>  <span class="fu">spread</span>(Expt, Value) <span class="sc">%&gt;%</span></span>
<span id="cb51-22"><a href="#cb51-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EnvChange =</span> <span class="st">`</span><span class="at">Italy 2017</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Sutherland 2017</span><span class="st">`</span>)</span>
<span id="cb51-23"><a href="#cb51-23" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(yy, <span class="fu">aes</span>(<span class="at">x =</span> Cluster, <span class="at">y =</span> EnvChange, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb51-24"><a href="#cb51-24" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb51-25"><a href="#cb51-25" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">pch =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb51-26"><a href="#cb51-26" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb51-27"><a href="#cb51-27" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb51-28"><a href="#cb51-28" tabindex="-1"></a>        <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb51-29"><a href="#cb51-29" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb51-30"><a href="#cb51-30" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb51-31"><a href="#cb51-31" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb51-32"><a href="#cb51-32" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> Trait, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-33"><a href="#cb51-33" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb51-34"><a href="#cb51-34" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span> </span>
<span id="cb51-35"><a href="#cb51-35" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;A)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Change (It17 - Su17)&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>)</span>
<span id="cb51-36"><a href="#cb51-36" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb51-37"><a href="#cb51-37" tabindex="-1"></a>zz <span class="ot">&lt;-</span> myPCAinput <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-38"><a href="#cb51-38" tabindex="-1"></a>  <span class="fu">select</span>(Name, It17_v.perc.DTF, Su17_v.perc.DTF)</span>
<span id="cb51-39"><a href="#cb51-39" tabindex="-1"></a>yy <span class="ot">&lt;-</span> yy <span class="sc">%&gt;%</span> </span>
<span id="cb51-40"><a href="#cb51-40" tabindex="-1"></a>  <span class="fu">select</span>(Name, Cluster, Trait, EnvChange) <span class="sc">%&gt;%</span></span>
<span id="cb51-41"><a href="#cb51-41" tabindex="-1"></a>  <span class="fu">spread</span>(Trait, EnvChange) <span class="sc">%&gt;%</span></span>
<span id="cb51-42"><a href="#cb51-42" tabindex="-1"></a>  <span class="fu">left_join</span>(zz, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb51-43"><a href="#cb51-43" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">v.perc.DTF =</span> It17_v.perc.DTF <span class="sc">-</span> Su17_v.perc.DTF,</span>
<span id="cb51-44"><a href="#cb51-44" tabindex="-1"></a>         <span class="at">Group =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Plot Area</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">|</span> <span class="st">`</span><span class="at">Plot Height</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&quot;abnormal&quot;</span>, <span class="st">&quot;normal&quot;</span>),</span>
<span id="cb51-45"><a href="#cb51-45" tabindex="-1"></a>         <span class="at">Group =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Plot Area</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Plot Height</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&quot;normal&quot;</span>, Group))</span>
<span id="cb51-46"><a href="#cb51-46" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb51-47"><a href="#cb51-47" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(yy) <span class="sc">+</span></span>
<span id="cb51-48"><a href="#cb51-48" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">y =</span> <span class="fl">0.14</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">label =</span> <span class="st">&quot;Taller</span><span class="sc">\n</span><span class="st">&amp;</span><span class="sc">\n</span><span class="st">Thiner&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-49"><a href="#cb51-49" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.05</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">label =</span> <span class="st">&quot;Shorter</span><span class="sc">\n</span><span class="st">&amp;</span><span class="sc">\n</span><span class="st">Wider&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-50"><a href="#cb51-50" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Plot Area</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Plot Height</span><span class="st">`</span>, <span class="at">color =</span> Cluster), </span>
<span id="cb51-51"><a href="#cb51-51" tabindex="-1"></a>             <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb51-52"><a href="#cb51-52" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> yy <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Group <span class="sc">==</span> <span class="st">&quot;abnormal&quot;</span>),</span>
<span id="cb51-53"><a href="#cb51-53" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Plot Area</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Plot Height</span><span class="st">`</span>), <span class="at">pch =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb51-54"><a href="#cb51-54" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb51-55"><a href="#cb51-55" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb51-56"><a href="#cb51-56" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb51-57"><a href="#cb51-57" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb51-58"><a href="#cb51-58" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb51-59"><a href="#cb51-59" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-60"><a href="#cb51-60" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;B)&quot;</span>,</span>
<span id="cb51-61"><a href="#cb51-61" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Change in Plot Area (It17 - Su17)&quot;</span>,</span>
<span id="cb51-62"><a href="#cb51-62" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Change in Plot Height (It17 - Su17)&quot;</span>)</span>
<span id="cb51-63"><a href="#cb51-63" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb51-64"><a href="#cb51-64" tabindex="-1"></a>yy <span class="ot">&lt;-</span> yy <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-65"><a href="#cb51-65" tabindex="-1"></a>  <span class="fu">select</span>(Name, Cluster, <span class="at">It17=</span>It17_v.perc.DTF, <span class="at">Su17=</span>Su17_v.perc.DTF) <span class="sc">%&gt;%</span></span>
<span id="cb51-66"><a href="#cb51-66" tabindex="-1"></a>  <span class="fu">gather</span>(Expt, Value, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb51-67"><a href="#cb51-67" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb51-68"><a href="#cb51-68" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(yy, <span class="fu">aes</span>(<span class="at">x =</span> Expt, <span class="at">y =</span> Value, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb51-69"><a href="#cb51-69" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="at">pch =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb51-70"><a href="#cb51-70" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span></span>
<span id="cb51-71"><a href="#cb51-71" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb51-72"><a href="#cb51-72" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-73"><a href="#cb51-73" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;C)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;% of Volume Growth at Flowering&quot;</span>)</span>
<span id="cb51-74"><a href="#cb51-74" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb51-75"><a href="#cb51-75" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, <span class="fu">ggarrange</span>(mp2, mp3, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb51-76"><a href="#cb51-76" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Figure_06.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="prepare-data-for-gwas" class="section level1">
<h1>Prepare Data for GWAS</h1>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>fixNames <span class="ot">&lt;-</span> <span class="cf">function</span>(xx) {</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>  xx <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Name =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>, Name),</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>                <span class="at">Name =</span> <span class="fu">gsub</span>(<span class="st">&quot;-&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, Name),</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>                <span class="at">Name =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Name, <span class="st">&quot;3156.11_AGL&quot;</span>, <span class="st">&quot;X3156.11_AGL&quot;</span>))</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>}</span></code></pre></div>
<div id="raw-drone-data" class="section level2">
<h2>Raw Drone Data</h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co"># Italy 2017</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>myT1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>,</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>          <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>,</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>          <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>)</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>myT2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Plot.Volume&quot;</span>, <span class="st">&quot;Plot.Area&quot;</span>, <span class="st">&quot;Plot.Height&quot;</span>)</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>xx <span class="ot">&lt;-</span> it17_d <span class="sc">%&gt;%</span> </span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DAP =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(DAP, <span class="fu">c</span>(<span class="dv">93</span>, <span class="dv">101</span>, <span class="dv">119</span>, <span class="dv">133</span>, <span class="dv">163</span>), </span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="dv">94</span>, <span class="dv">100</span>, <span class="dv">118</span>, <span class="dv">132</span>, <span class="dv">164</span>)),</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>         <span class="at">DAP =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(DAP, <span class="fu">c</span>(<span class="dv">94</span>, <span class="dv">100</span>, <span class="dv">118</span>, <span class="dv">132</span>, <span class="dv">164</span>),</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="st">&quot;094&quot;</span>,<span class="st">&quot;100&quot;</span>,<span class="st">&quot;118&quot;</span>,<span class="st">&quot;132&quot;</span>,<span class="st">&quot;164&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>  <span class="fu">filter</span>(Trait <span class="sc">%in%</span> myT1, DAP <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;094&quot;</span>,<span class="st">&quot;100&quot;</span>,<span class="st">&quot;118&quot;</span>,<span class="st">&quot;132&quot;</span>,<span class="st">&quot;164&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>  <span class="fu">group_by</span>(Name, DAP, Trait) <span class="sc">%&gt;%</span></span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value_f =</span> <span class="fu">mean</span>(Value_f, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Trait, myT1, myT2),</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a>         <span class="at">Trait =</span> <span class="fu">paste0</span>(<span class="st">&quot;It17_&quot;</span>,Trait, <span class="st">&quot;.d&quot;</span>, DAP)) <span class="sc">%&gt;%</span></span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>DAP) <span class="sc">%&gt;%</span></span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a>  <span class="fu">spread</span>(Trait, Value_f) <span class="sc">%&gt;%</span></span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a>  <span class="fu">fixNames</span>()</span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a>yy <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">gather</span>(Trait, Value, <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a><span class="fu">write.csv</span>(xx, <span class="st">&quot;Data_GWAS/myY_it17_d.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a><span class="co"># Rosthern 2017</span></span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a>myT1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>,</span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a>          <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>,</span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a>          <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>)</span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a>xx <span class="ot">&lt;-</span> ro17_d <span class="sc">%&gt;%</span> </span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a>  <span class="fu">filter</span>(Trait <span class="sc">%in%</span> myT1, DAP <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">24</span>,<span class="dv">32</span>,<span class="dv">39</span>,<span class="dv">40</span>,<span class="dv">54</span>,<span class="dv">61</span>,<span class="dv">67</span>,<span class="dv">74</span>,<span class="dv">80</span>,<span class="dv">89</span>,<span class="dv">95</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-29"><a href="#cb53-29" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DAP =</span> <span class="fu">paste0</span>(<span class="st">&quot;0&quot;</span>, DAP)) <span class="sc">%&gt;%</span></span>
<span id="cb53-30"><a href="#cb53-30" tabindex="-1"></a>  <span class="fu">group_by</span>(Name, DAP, Trait) <span class="sc">%&gt;%</span></span>
<span id="cb53-31"><a href="#cb53-31" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value_f =</span> <span class="fu">mean</span>(Value_f, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb53-32"><a href="#cb53-32" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-33"><a href="#cb53-33" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Trait, myT1, myT2),</span>
<span id="cb53-34"><a href="#cb53-34" tabindex="-1"></a>         <span class="at">Trait =</span> <span class="fu">paste0</span>(<span class="st">&quot;Ro17_&quot;</span>, Trait, <span class="st">&quot;.d&quot;</span>, DAP)) <span class="sc">%&gt;%</span></span>
<span id="cb53-35"><a href="#cb53-35" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>DAP) <span class="sc">%&gt;%</span></span>
<span id="cb53-36"><a href="#cb53-36" tabindex="-1"></a>  <span class="fu">spread</span>(Trait, Value_f) <span class="sc">%&gt;%</span></span>
<span id="cb53-37"><a href="#cb53-37" tabindex="-1"></a>  <span class="fu">fixNames</span>()</span>
<span id="cb53-38"><a href="#cb53-38" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(xx))</span>
<span id="cb53-39"><a href="#cb53-39" tabindex="-1"></a>xx[<span class="fu">is.na</span>(xx)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb53-40"><a href="#cb53-40" tabindex="-1"></a>yy <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">gather</span>(Trait, Value, <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-41"><a href="#cb53-41" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb53-42"><a href="#cb53-42" tabindex="-1"></a>xx <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> </span>
<span id="cb53-43"><a href="#cb53-43" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Ro17_Plot.Area.d024,<span class="sc">-</span>Ro17_Plot.Area.d032, <span class="sc">-</span>Ro17_Plot.Area.d039, </span>
<span id="cb53-44"><a href="#cb53-44" tabindex="-1"></a>         <span class="sc">-</span>Ro17_Plot.Volume.d024, <span class="sc">-</span>Ro17_Plot.Volume.d032) </span>
<span id="cb53-45"><a href="#cb53-45" tabindex="-1"></a><span class="fu">write.csv</span>(xx, <span class="st">&quot;Data_GWAS/myY_Ro17_d.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb53-46"><a href="#cb53-46" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb53-47"><a href="#cb53-47" tabindex="-1"></a>myT1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_blue.ndvi.based&quot;</span>,</span>
<span id="cb53-48"><a href="#cb53-48" tabindex="-1"></a>          <span class="st">&quot;crop_area_m2_blue.ndvi.based&quot;</span>,</span>
<span id="cb53-49"><a href="#cb53-49" tabindex="-1"></a>          <span class="st">&quot;mean_crop_height_m_blue.ndvi.based&quot;</span>)</span>
<span id="cb53-50"><a href="#cb53-50" tabindex="-1"></a>xx <span class="ot">&lt;-</span> su17_d <span class="sc">%&gt;%</span></span>
<span id="cb53-51"><a href="#cb53-51" tabindex="-1"></a>  <span class="fu">filter</span>(Trait <span class="sc">%in%</span> myT1, DAP <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">32</span>,<span class="dv">40</span>,<span class="dv">46</span>,<span class="dv">51</span>,<span class="dv">57</span>,<span class="dv">61</span>,<span class="dv">68</span>,<span class="dv">72</span>,<span class="dv">75</span>,<span class="dv">77</span>,<span class="dv">83</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-52"><a href="#cb53-52" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DAP =</span> <span class="fu">paste0</span>(<span class="st">&quot;0&quot;</span>, DAP)) <span class="sc">%&gt;%</span></span>
<span id="cb53-53"><a href="#cb53-53" tabindex="-1"></a>  <span class="fu">group_by</span>(Name, DAP, Trait) <span class="sc">%&gt;%</span></span>
<span id="cb53-54"><a href="#cb53-54" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value_f =</span> <span class="fu">mean</span>(Value_f, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb53-55"><a href="#cb53-55" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-56"><a href="#cb53-56" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Trait, myT1, myT2),</span>
<span id="cb53-57"><a href="#cb53-57" tabindex="-1"></a>         <span class="at">Trait =</span> <span class="fu">paste0</span>(<span class="st">&quot;Su17_&quot;</span>, Trait, <span class="st">&quot;.d&quot;</span>, DAP)) <span class="sc">%&gt;%</span></span>
<span id="cb53-58"><a href="#cb53-58" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>DAP) <span class="sc">%&gt;%</span></span>
<span id="cb53-59"><a href="#cb53-59" tabindex="-1"></a>  <span class="fu">spread</span>(Trait, Value_f) <span class="sc">%&gt;%</span></span>
<span id="cb53-60"><a href="#cb53-60" tabindex="-1"></a>  <span class="fu">fixNames</span>()</span>
<span id="cb53-61"><a href="#cb53-61" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(xx))</span>
<span id="cb53-62"><a href="#cb53-62" tabindex="-1"></a>xx[<span class="fu">is.na</span>(xx)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb53-63"><a href="#cb53-63" tabindex="-1"></a>yy <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">gather</span>(Trait, Value, <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-64"><a href="#cb53-64" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb53-65"><a href="#cb53-65" tabindex="-1"></a>xx <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Su17_Plot.Area.d032, <span class="sc">-</span>Su17_Plot.Volume.d032) </span>
<span id="cb53-66"><a href="#cb53-66" tabindex="-1"></a><span class="fu">write.csv</span>(xx, <span class="st">&quot;Data_GWAS/myY_Su17_d.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb53-67"><a href="#cb53-67" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb53-68"><a href="#cb53-68" tabindex="-1"></a>myT1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;crop_volume_m3_excess.green.based&quot;</span>,</span>
<span id="cb53-69"><a href="#cb53-69" tabindex="-1"></a>          <span class="st">&quot;crop_area_m2_excess.green.based&quot;</span>,</span>
<span id="cb53-70"><a href="#cb53-70" tabindex="-1"></a>          <span class="st">&quot;mean_crop_height_m_excess.green.based&quot;</span>)</span>
<span id="cb53-71"><a href="#cb53-71" tabindex="-1"></a>xx <span class="ot">&lt;-</span> su18_d <span class="sc">%&gt;%</span></span>
<span id="cb53-72"><a href="#cb53-72" tabindex="-1"></a>  <span class="fu">filter</span>(Trait <span class="sc">%in%</span> myT1, DAP <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">61</span>,<span class="dv">65</span>,<span class="dv">68</span>,<span class="dv">72</span>,<span class="dv">76</span>,<span class="dv">79</span>,<span class="dv">86</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-73"><a href="#cb53-73" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DAP =</span> <span class="fu">paste0</span>(<span class="st">&quot;0&quot;</span>, DAP)) <span class="sc">%&gt;%</span></span>
<span id="cb53-74"><a href="#cb53-74" tabindex="-1"></a>  <span class="fu">group_by</span>(Name, DAP, Trait) <span class="sc">%&gt;%</span></span>
<span id="cb53-75"><a href="#cb53-75" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value_f =</span> <span class="fu">mean</span>(Value_f, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb53-76"><a href="#cb53-76" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-77"><a href="#cb53-77" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Trait, myT1, myT2),</span>
<span id="cb53-78"><a href="#cb53-78" tabindex="-1"></a>         <span class="at">Trait =</span> <span class="fu">paste0</span>(<span class="st">&quot;Su18_&quot;</span>,Trait, <span class="st">&quot;.d&quot;</span>, DAP)) <span class="sc">%&gt;%</span></span>
<span id="cb53-79"><a href="#cb53-79" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>DAP) <span class="sc">%&gt;%</span></span>
<span id="cb53-80"><a href="#cb53-80" tabindex="-1"></a>  <span class="fu">spread</span>(Trait, Value_f) <span class="sc">%&gt;%</span></span>
<span id="cb53-81"><a href="#cb53-81" tabindex="-1"></a>  <span class="fu">fixNames</span>()</span>
<span id="cb53-82"><a href="#cb53-82" tabindex="-1"></a>yy <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">gather</span>(Trait, Value, <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-83"><a href="#cb53-83" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb53-84"><a href="#cb53-84" tabindex="-1"></a><span class="fu">write.csv</span>(xx, <span class="st">&quot;Data_GWAS/myY_Su18_d.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="growth-curve-data" class="section level2">
<h2>Growth Curve Data</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co"># Italy 2017</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> it17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;It17_gc.v&quot;</span>)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> it17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;It17_gc.h&quot;</span>)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> it17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;It17_gc.a&quot;</span>)</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(x1,x2,x3) <span class="sc">%&gt;%</span></span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>  <span class="fu">select</span>(Name, Expt, r, b, g.r, g.b, k,</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>         x.min, x.mid, x.max, x.d, x.gen, auc.l, auc.e) <span class="sc">%&gt;%</span></span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>  <span class="fu">gather</span>(Trait, Value, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>  <span class="fu">group_by</span>(Name, Expt, Trait) <span class="sc">%&gt;%</span></span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">paste</span>(Expt, Trait, <span class="at">sep =</span> <span class="st">&quot;.&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Expt) <span class="sc">%&gt;%</span> <span class="fu">spread</span>(Trait, Value)  <span class="sc">%&gt;%</span></span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>  <span class="fu">fixNames</span>()</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a><span class="fu">write.csv</span>(xx, <span class="st">&quot;Data_GWAS/myY_it17_gc.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a><span class="co"># Rosthern 2017</span></span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> ro17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Ro17_gc.v&quot;</span>)</span>
<span id="cb54-17"><a href="#cb54-17" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> ro17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Ro17_gc.h&quot;</span>)</span>
<span id="cb54-18"><a href="#cb54-18" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> ro17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Ro17_gc.a&quot;</span>)</span>
<span id="cb54-19"><a href="#cb54-19" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(x1,x2,x3) <span class="sc">%&gt;%</span></span>
<span id="cb54-20"><a href="#cb54-20" tabindex="-1"></a>  <span class="fu">select</span>(Name, Expt, r, b, g.r, g.b, k,  </span>
<span id="cb54-21"><a href="#cb54-21" tabindex="-1"></a>         x.min, x.mid, x.max, x.d, x.gen, auc.l, auc.e ) <span class="sc">%&gt;%</span></span>
<span id="cb54-22"><a href="#cb54-22" tabindex="-1"></a>  <span class="fu">gather</span>(Trait, Value, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb54-23"><a href="#cb54-23" tabindex="-1"></a>  <span class="fu">group_by</span>(Name, Expt, Trait) <span class="sc">%&gt;%</span></span>
<span id="cb54-24"><a href="#cb54-24" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb54-25"><a href="#cb54-25" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">paste</span>(Expt, Trait, <span class="at">sep =</span> <span class="st">&quot;.&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-26"><a href="#cb54-26" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Expt) <span class="sc">%&gt;%</span> <span class="fu">spread</span>(Trait, Value) <span class="sc">%&gt;%</span></span>
<span id="cb54-27"><a href="#cb54-27" tabindex="-1"></a>  <span class="fu">fixNames</span>()</span>
<span id="cb54-28"><a href="#cb54-28" tabindex="-1"></a><span class="fu">write.csv</span>(xx, <span class="st">&quot;Data_GWAS/myY_ro17_gc.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb54-29"><a href="#cb54-29" tabindex="-1"></a><span class="co"># Sutherland 2017</span></span>
<span id="cb54-30"><a href="#cb54-30" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> su17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Su17_gc.v&quot;</span>)</span>
<span id="cb54-31"><a href="#cb54-31" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> su17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Su17_gc.h&quot;</span>)</span>
<span id="cb54-32"><a href="#cb54-32" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> su17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Su17_gc.a&quot;</span>)</span>
<span id="cb54-33"><a href="#cb54-33" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(x1,x2,x3) <span class="sc">%&gt;%</span></span>
<span id="cb54-34"><a href="#cb54-34" tabindex="-1"></a>  <span class="fu">select</span>(Name, Expt, r, b, g.r, g.b, k, </span>
<span id="cb54-35"><a href="#cb54-35" tabindex="-1"></a>         x.min, x.mid, x.max, x.d, x.gen, auc.l, auc.e) <span class="sc">%&gt;%</span></span>
<span id="cb54-36"><a href="#cb54-36" tabindex="-1"></a>  <span class="fu">gather</span>(Trait, Value, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb54-37"><a href="#cb54-37" tabindex="-1"></a>  <span class="fu">group_by</span>(Name, Expt, Trait) <span class="sc">%&gt;%</span></span>
<span id="cb54-38"><a href="#cb54-38" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb54-39"><a href="#cb54-39" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">paste</span>(Expt, Trait, <span class="at">sep =</span> <span class="st">&quot;.&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-40"><a href="#cb54-40" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Expt) <span class="sc">%&gt;%</span> <span class="fu">spread</span>(Trait, Value) <span class="sc">%&gt;%</span></span>
<span id="cb54-41"><a href="#cb54-41" tabindex="-1"></a>  <span class="fu">fixNames</span>()</span>
<span id="cb54-42"><a href="#cb54-42" tabindex="-1"></a><span class="fu">write.csv</span>(xx, <span class="st">&quot;Data_GWAS/myY_su17_gc.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co"># Italy 2017</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> it17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name) <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> it17_gc.a[[<span class="dv">2</span>]], <span class="at">xf =</span> it17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;It17_&quot;</span>, <span class="at">Prefix =</span> <span class="st">&quot;gc.a.&quot;</span>)</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> it17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name) <span class="sc">%&gt;%</span></span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> it17_gc.h[[<span class="dv">2</span>]], <span class="at">xf =</span> it17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;It17_&quot;</span>, <span class="at">Prefix =</span> <span class="st">&quot;gc.h.&quot;</span>)</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> it17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name) <span class="sc">%&gt;%</span></span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> it17_gc.v[[<span class="dv">2</span>]], <span class="at">xf =</span> it17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;It17_&quot;</span>, <span class="at">Prefix =</span> <span class="st">&quot;gc.v.&quot;</span>)</span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(x1, x2, x3) <span class="sc">%&gt;%</span></span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a>  <span class="fu">select</span>(Expt, Prefix, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a>  <span class="fu">gather</span>(Trait, Value, <span class="dv">6</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a>  <span class="fu">group_by</span>(Name, Expt, Prefix, Trait) <span class="sc">%&gt;%</span></span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">paste0</span>(Expt, Prefix, Trait)) <span class="sc">%&gt;%</span></span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Expt, <span class="sc">-</span>Prefix) <span class="sc">%&gt;%</span></span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>  <span class="fu">spread</span>(Trait, Value)</span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a><span class="fu">write.csv</span>(xx, <span class="st">&quot;Data_GWAS/myY_it17_pg.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a><span class="co"># Rosthern 2017</span></span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> ro17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb55-26"><a href="#cb55-26" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name) <span class="sc">%&gt;%</span></span>
<span id="cb55-27"><a href="#cb55-27" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> ro17_gc.a[[<span class="dv">2</span>]], <span class="at">xf =</span> ro17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-28"><a href="#cb55-28" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Ro17_&quot;</span>, <span class="at">Prefix =</span> <span class="st">&quot;gc.a.&quot;</span>)</span>
<span id="cb55-29"><a href="#cb55-29" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> ro17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb55-30"><a href="#cb55-30" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name) <span class="sc">%&gt;%</span></span>
<span id="cb55-31"><a href="#cb55-31" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> ro17_gc.h[[<span class="dv">2</span>]], <span class="at">xf =</span> ro17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb55-32"><a href="#cb55-32" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Ro17_&quot;</span>, <span class="at">Prefix =</span> <span class="st">&quot;gc.h.&quot;</span>)</span>
<span id="cb55-33"><a href="#cb55-33" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> ro17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb55-34"><a href="#cb55-34" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name) <span class="sc">%&gt;%</span></span>
<span id="cb55-35"><a href="#cb55-35" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> ro17_gc.v[[<span class="dv">2</span>]], <span class="at">xf =</span> ro17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb55-36"><a href="#cb55-36" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Ro17_&quot;</span>, <span class="at">Prefix =</span> <span class="st">&quot;gc.v.&quot;</span>)</span>
<span id="cb55-37"><a href="#cb55-37" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(x1, x2, x3) <span class="sc">%&gt;%</span></span>
<span id="cb55-38"><a href="#cb55-38" tabindex="-1"></a>  <span class="fu">select</span>(Expt, Prefix, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb55-39"><a href="#cb55-39" tabindex="-1"></a>  <span class="fu">gather</span>(Trait, Value, <span class="dv">6</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb55-40"><a href="#cb55-40" tabindex="-1"></a>  <span class="fu">group_by</span>(Name, Expt, Prefix, Trait) <span class="sc">%&gt;%</span></span>
<span id="cb55-41"><a href="#cb55-41" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb55-42"><a href="#cb55-42" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-43"><a href="#cb55-43" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">paste0</span>(Expt, Prefix, Trait)) <span class="sc">%&gt;%</span></span>
<span id="cb55-44"><a href="#cb55-44" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Expt, <span class="sc">-</span>Prefix) <span class="sc">%&gt;%</span></span>
<span id="cb55-45"><a href="#cb55-45" tabindex="-1"></a>  <span class="fu">spread</span>(Trait, Value)</span>
<span id="cb55-46"><a href="#cb55-46" tabindex="-1"></a><span class="fu">write.csv</span>(xx, <span class="st">&quot;Data_GWAS/myY_ro17_pg.csv&quot;</span>, <span class="at">row.names =</span> F)</span>
<span id="cb55-47"><a href="#cb55-47" tabindex="-1"></a><span class="co"># Sutherland 2017</span></span>
<span id="cb55-48"><a href="#cb55-48" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> su17_gc.a[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb55-49"><a href="#cb55-49" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name) <span class="sc">%&gt;%</span></span>
<span id="cb55-50"><a href="#cb55-50" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> su17_gc.a[[<span class="dv">2</span>]], <span class="at">xf =</span> su17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-51"><a href="#cb55-51" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Su17_&quot;</span>, <span class="at">Prefix =</span> <span class="st">&quot;gc.a.&quot;</span>)</span>
<span id="cb55-52"><a href="#cb55-52" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> su17_gc.h[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb55-53"><a href="#cb55-53" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name) <span class="sc">%&gt;%</span></span>
<span id="cb55-54"><a href="#cb55-54" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> su17_gc.h[[<span class="dv">2</span>]], <span class="at">xf =</span> su17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb55-55"><a href="#cb55-55" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Su17_&quot;</span>, <span class="at">Prefix =</span> <span class="st">&quot;gc.h.&quot;</span>)</span>
<span id="cb55-56"><a href="#cb55-56" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> su17_gc.v[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb55-57"><a href="#cb55-57" tabindex="-1"></a>  <span class="fu">select</span>(Plot, Entry, Name) <span class="sc">%&gt;%</span></span>
<span id="cb55-58"><a href="#cb55-58" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">phenolGrowth</span>(<span class="at">xd =</span> su17_gc.v[[<span class="dv">2</span>]], <span class="at">xf =</span> su17_f), <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb55-59"><a href="#cb55-59" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> <span class="st">&quot;Su17_&quot;</span>, <span class="at">Prefix =</span> <span class="st">&quot;gc.v.&quot;</span>)</span>
<span id="cb55-60"><a href="#cb55-60" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(x1, x2, x3) <span class="sc">%&gt;%</span></span>
<span id="cb55-61"><a href="#cb55-61" tabindex="-1"></a>  <span class="fu">select</span>(Expt, Prefix, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb55-62"><a href="#cb55-62" tabindex="-1"></a>  <span class="fu">gather</span>(Trait, Value, <span class="dv">6</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb55-63"><a href="#cb55-63" tabindex="-1"></a>  <span class="fu">group_by</span>(Name, Expt, Prefix, Trait) <span class="sc">%&gt;%</span></span>
<span id="cb55-64"><a href="#cb55-64" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb55-65"><a href="#cb55-65" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-66"><a href="#cb55-66" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">paste0</span>(Expt, Prefix, Trait)) <span class="sc">%&gt;%</span></span>
<span id="cb55-67"><a href="#cb55-67" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Expt, <span class="sc">-</span>Prefix) <span class="sc">%&gt;%</span></span>
<span id="cb55-68"><a href="#cb55-68" tabindex="-1"></a>  <span class="fu">spread</span>(Trait, Value)</span>
<span id="cb55-69"><a href="#cb55-69" tabindex="-1"></a><span class="fu">write.csv</span>(xx, <span class="st">&quot;Data_GWAS/myY_su17_pg.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="manual-phenotypes-1" class="section level2">
<h2>Manual Phenotypes</h2>
<hr />
</div>
</div>
<div id="run-gwas" class="section level1">
<h1>Run GWAS</h1>
<p>Genotype data</p>
<blockquote>
<ul>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a
href="Data_GWAS/myG_LDP_GRN_RD3_MAF5_MISS25.zip">Data_GWAS/myG_LDP_GRN_RD3_MAF5_MISS25.zip</a></li>
</ul>
</blockquote>
<p>Manual Phenotype Data</p>
<blockquote>
<ul>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a href="Data_GWAS/myY_myF.csv">Data_GWAS/myY_myF.csv</a></li>
</ul>
</blockquote>
<p>Drone Phenotype data</p>
<blockquote>
<ul>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a href="Data_GWAS/myY_it17_d.csv">Data_GWAS/myY_it17_d.csv</a></li>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a href="Data_GWAS/myY_ro17_d.csv">Data_GWAS/myY_ro17_d.csv</a></li>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a href="Data_GWAS/myY_su17_d.csv">Data_GWAS/myY_su17_d.csv</a></li>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a href="Data_GWAS/myY_su18_d.csv">Data_GWAS/myY_su18_d.csv</a></li>
</ul>
</blockquote>
<p>Growth Curve Coefficients</p>
<blockquote>
<ul>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a href="Data_GWAS/myY_it17_gc.csv">Data_GWAS/myY_it17_gc.csv</a></li>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a href="Data_GWAS/myY_ro17_gc.csv">Data_GWAS/myY_ro17_gc.csv</a></li>
<li><i class="far fa-floppy-disk" role="presentation" aria-label="floppy-disk icon"></i>
<a href="Data_GWAS/myY_su17_gc.csv">Data_GWAS/myY_su17_gc.csv</a></li>
</ul>
</blockquote>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;jiabowang/GAPIT&quot;)</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">library</span>(GAPIT3)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>myG <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;Data_GWAS/myG_LDP_GRN_RD3_MAF5_MISS25.txt&quot;</span>, <span class="at">header =</span> F)</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>myY_it17_d <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_it17_d.csv&quot;</span>)</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>myY_ro17_d <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_ro17_d.csv&quot;</span>)</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>myY_su17_d <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_su17_d.csv&quot;</span>)</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>myY_su18_d <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_su18_d.csv&quot;</span>)</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>myY_it17_gc <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_it17_gc.csv&quot;</span>)</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>myY_ro17_gc <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_ro17_gc.csv&quot;</span>)</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>myY_su17_gc <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_su17_gc.csv&quot;</span>)</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>myY_myF <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_myF.csv&quot;</span>)</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;GWAS_Results/&quot;</span>)</span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>myModels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;MLM&quot;</span>,<span class="st">&quot;FarmCPU&quot;</span>,<span class="st">&quot;BLINK&quot;</span>)</span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>myGAPIT <span class="ot">&lt;-</span> <span class="fu">GAPIT</span>(<span class="at">Y =</span> myY_it17_d, <span class="at">G =</span> myG, <span class="at">PCA.total =</span> <span class="dv">4</span>, </span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a>                 <span class="at">model =</span> myModels, <span class="at">Phenotype.View =</span> F)</span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a>myGAPIT <span class="ot">&lt;-</span> <span class="fu">GAPIT</span>(<span class="at">Y =</span> myY_ro17_d, <span class="at">G =</span> myG, <span class="at">PCA.total =</span> <span class="dv">4</span>, </span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a>                 <span class="at">model =</span> myModels, <span class="at">Phenotype.View =</span> F)</span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a>myGAPIT <span class="ot">&lt;-</span> <span class="fu">GAPIT</span>(<span class="at">Y =</span> myY_su17_d, <span class="at">G =</span> myG, <span class="at">PCA.total =</span> <span class="dv">4</span>, </span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a>                 <span class="at">model =</span> myModels, <span class="at">Phenotype.View =</span> F)</span>
<span id="cb56-25"><a href="#cb56-25" tabindex="-1"></a>myGAPIT <span class="ot">&lt;-</span> <span class="fu">GAPIT</span>(<span class="at">Y =</span> myY_su18_d, <span class="at">G =</span> myG, <span class="at">PCA.total =</span> <span class="dv">4</span>, </span>
<span id="cb56-26"><a href="#cb56-26" tabindex="-1"></a>                 <span class="at">model =</span> myModels, <span class="at">Phenotype.View =</span> F)</span>
<span id="cb56-27"><a href="#cb56-27" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-28"><a href="#cb56-28" tabindex="-1"></a>myGAPIT <span class="ot">&lt;-</span> <span class="fu">GAPIT</span>(<span class="at">Y =</span> myY_it17_gc, <span class="at">G =</span> myG, <span class="at">PCA.total =</span> <span class="dv">4</span>, </span>
<span id="cb56-29"><a href="#cb56-29" tabindex="-1"></a>                 <span class="at">model =</span> myModels, <span class="at">Phenotype.View =</span> F)</span>
<span id="cb56-30"><a href="#cb56-30" tabindex="-1"></a>myGAPIT <span class="ot">&lt;-</span> <span class="fu">GAPIT</span>(<span class="at">Y =</span> myY_ro17_gc, <span class="at">G =</span> myG, <span class="at">PCA.total =</span> <span class="dv">4</span>, </span>
<span id="cb56-31"><a href="#cb56-31" tabindex="-1"></a>                 <span class="at">model =</span> myModels, <span class="at">Phenotype.View =</span> F)</span>
<span id="cb56-32"><a href="#cb56-32" tabindex="-1"></a>myGAPIT <span class="ot">&lt;-</span> <span class="fu">GAPIT</span>(<span class="at">Y =</span> myY_su17_gc, <span class="at">G =</span> myG, <span class="at">PCA.total =</span> <span class="dv">4</span>, </span>
<span id="cb56-33"><a href="#cb56-33" tabindex="-1"></a>                 <span class="at">model =</span> myModels, <span class="at">Phenotype.View =</span> F)</span>
<span id="cb56-34"><a href="#cb56-34" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-35"><a href="#cb56-35" tabindex="-1"></a>myGAPIT <span class="ot">&lt;-</span> <span class="fu">GAPIT</span>(<span class="at">Y =</span> myY_myF, <span class="at">G =</span> myG, <span class="at">PCA.total =</span> <span class="dv">4</span>, </span>
<span id="cb56-36"><a href="#cb56-36" tabindex="-1"></a>                 <span class="at">model =</span> myModels, <span class="at">Phenotype.View =</span> F)</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="sc">-</span><span class="fu">log10</span>( <span class="fl">0.01</span> <span class="sc">/</span> (<span class="fu">nrow</span>(myG)<span class="sc">-</span><span class="dv">1</span>) )</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="sc">-</span><span class="fu">log10</span>( <span class="fl">0.05</span> <span class="sc">/</span> (<span class="fu">nrow</span>(myG)<span class="sc">-</span><span class="dv">1</span>) )</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a><span class="sc">-</span><span class="fu">log10</span>( <span class="fl">0.10</span> <span class="sc">/</span> (<span class="fu">nrow</span>(myG)<span class="sc">-</span><span class="dv">1</span>) )</span></code></pre></div>
<hr />
</div>
<div id="post-gwas" class="section level1">
<h1>Post GWAS</h1>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;derekmichaelwright/gwaspr&quot;, force = T)</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="fu">library</span>(gwaspr)</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>myTraits <span class="ot">&lt;-</span> <span class="fu">list_Traits</span>(<span class="st">&quot;GWAS_Results/&quot;</span>)</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>myResults <span class="ot">&lt;-</span> <span class="fu">list_Result_Files</span>(<span class="st">&quot;GWAS_Results/&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">order_GWAS_Results</span>(<span class="at">folder =</span> <span class="st">&quot;GWAS_Results/&quot;</span>, <span class="at">files =</span> myResults)</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">table_GWAS_Results</span>(<span class="st">&quot;GWAS_Results/&quot;</span>, myResults, <span class="at">threshold =</span> <span class="fl">6.8</span>, <span class="at">sug.threshold =</span> <span class="dv">6</span>)</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a><span class="fu">write.csv</span>(xx, <span class="st">&quot;Supplemental_Table_01.csv&quot;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Supplemental_Table_01.csv&quot;</span>)</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>xx <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Threshold <span class="sc">==</span> <span class="st">&quot;Significant&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>  <span class="fu">pull</span>(SNP) <span class="sc">%&gt;%</span> <span class="fu">unique</span>() <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>dna <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">stringsAsFactors =</span> F, </span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>    <span class="at">Symbol =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;R&quot;</span>, <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;N&quot;</span>), </span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>,<span class="st">&quot;CC&quot;</span>,<span class="st">&quot;GG&quot;</span>,<span class="st">&quot;TT&quot;</span>,<span class="st">&quot;UU&quot;</span>,<span class="st">&quot;AG&quot;</span>,<span class="st">&quot;CT&quot;</span>,<span class="st">&quot;GC&quot;</span>,<span class="st">&quot;AT&quot;</span>,<span class="st">&quot;GT&quot;</span>,<span class="st">&quot;AC&quot;</span>,<span class="st">&quot;NN&quot;</span>))</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>fixNames <span class="ot">&lt;-</span> <span class="cf">function</span>(xx) {</span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a>  xx <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Name =</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>, Name),</span>
<span id="cb61-8"><a href="#cb61-8" tabindex="-1"></a>                <span class="at">Name =</span> <span class="fu">gsub</span>(<span class="st">&quot;-&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, Name),</span>
<span id="cb61-9"><a href="#cb61-9" tabindex="-1"></a>                <span class="at">Name =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Name, <span class="st">&quot;3156.11_AGL&quot;</span>, <span class="st">&quot;X3156.11_AGL&quot;</span>))</span>
<span id="cb61-10"><a href="#cb61-10" tabindex="-1"></a>}</span>
<span id="cb61-11"><a href="#cb61-11" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb61-12"><a href="#cb61-12" tabindex="-1"></a>myMColors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;black&quot;</span>,<span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;darkred&quot;</span>,<span class="dv">4</span>))</span>
<span id="cb61-13"><a href="#cb61-13" tabindex="-1"></a>myVltys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb61-14"><a href="#cb61-14" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb61-15"><a href="#cb61-15" tabindex="-1"></a>myMarkersd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Lcu.1GRN.Chr2p44545877&quot;</span>, <span class="st">&quot;Lcu.1GRN.Chr5p1658484&quot;</span>, <span class="st">&quot;Lcu.1GRN.Chr6p3269280&quot;</span>)</span>
<span id="cb61-16"><a href="#cb61-16" tabindex="-1"></a>myMarkers <span class="ot">&lt;-</span> <span class="fu">c</span>(myMarkersd, <span class="st">&quot;Lcu.1GRN.Chr1p2884425&quot;</span>, <span class="st">&quot;Lcu.1GRN.Chr7p628672781&quot;</span>, </span>
<span id="cb61-17"><a href="#cb61-17" tabindex="-1"></a>                           <span class="st">&quot;Lcu.1GRN.Chr6p22131416&quot;</span>, <span class="st">&quot;Lcu.1GRN.Chr7p649509676&quot;</span>)</span>
<span id="cb61-18"><a href="#cb61-18" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb61-19"><a href="#cb61-19" tabindex="-1"></a>myG <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;Data_GWAS/myG_LDP_GRN_RD3_MAF5_MISS25.txt&quot;</span>, <span class="at">header =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb61-20"><a href="#cb61-20" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SNP=</span><span class="dv">1</span>, <span class="at">Chr=</span><span class="dv">3</span>, <span class="at">Pos=</span><span class="dv">4</span>)</span></code></pre></div>
<hr />
<div id="significant-markers" class="section level2">
<h2>Significant Markers</h2>
<blockquote>
<ul>
<li><i class="fas fa-globe" role="presentation" aria-label="globe icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/tree/main/Additional/Markers/Chr/"
target="_blank">Additional/Markers/Chr</a></li>
<li><i class="fas fa-globe" role="presentation" aria-label="globe icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/tree/main/Additional/Markers/Effecp/"
target="_blank">Additional/Markers/Effect</a></li>
<li><i class="fas fa-globe" role="presentation" aria-label="globe icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/tree/main/Additional/Markers/Pvalue/"
target="_blank">Additional/Markers/Pvalue</a></li>
</ul>
</blockquote>
<p><img src="Additional/Markers/Chr/Lcu.1GRN.Chr1p2884425.png" /></p>
<p><img src="Additional/Markers/Chr/Lcu.1GRN.Chr7p628672781.png" /></p>
<p><img src="Additional/Markers/Chr/Lcu.1GRN.Chr6p22131416.png" /></p>
<p><img src="Additional/Markers/Chr/Lcu.1GRN.Chr7p649509676.png" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="co"># Create function</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>gg_BoxPlotMarker <span class="ot">&lt;-</span> <span class="cf">function</span>(myG, myY, trait, marker) {</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>  dna <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">stringsAsFactors =</span> F, </span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>    <span class="at">Symbol =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;R&quot;</span>, <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;N&quot;</span>), </span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>    <span class="at">Value =</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>,<span class="st">&quot;CC&quot;</span>,<span class="st">&quot;GG&quot;</span>,<span class="st">&quot;TT&quot;</span>,<span class="st">&quot;UU&quot;</span>,<span class="st">&quot;AG&quot;</span>,<span class="st">&quot;CT&quot;</span>,<span class="st">&quot;GC&quot;</span>,<span class="st">&quot;AT&quot;</span>,<span class="st">&quot;GT&quot;</span>,<span class="st">&quot;AC&quot;</span>,<span class="st">&quot;NN&quot;</span>))</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  myPCA <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;myPCA.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>    <span class="fu">fixNames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">factor</span>(Cluster))</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> myG <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SNP <span class="sc">==</span> marker) <span class="sc">%&gt;%</span> </span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>    <span class="fu">gather</span>(Name, Allele, <span class="dv">12</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>    <span class="fu">select</span>(Name, Allele) <span class="sc">%&gt;%</span> </span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Allele =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Allele, dna<span class="sc">$</span>Symbol, dna<span class="sc">$</span>Value), </span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a>           <span class="at">Allele =</span> <span class="fu">factor</span>(Allele, <span class="at">levels =</span> dna<span class="sc">$</span>Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Allele <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;AG&quot;</span>,<span class="st">&quot;CT&quot;</span>,<span class="st">&quot;GC&quot;</span>,<span class="st">&quot;AT&quot;</span>,<span class="st">&quot;GT&quot;</span>,<span class="st">&quot;AC&quot;</span>,<span class="st">&quot;NN&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-16"><a href="#cb62-16" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Allele)) <span class="sc">%&gt;%</span></span>
<span id="cb62-17"><a href="#cb62-17" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="fu">select</span>(myPCA, Name, Cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb62-18"><a href="#cb62-18" tabindex="-1"></a>    <span class="fu">left_join</span>(myY, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-19"><a href="#cb62-19" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">get</span>(trait)))</span>
<span id="cb62-20"><a href="#cb62-20" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb62-21"><a href="#cb62-21" tabindex="-1"></a>  <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Allele, <span class="at">y =</span> <span class="fu">get</span>(trait))) <span class="sc">+</span> </span>
<span id="cb62-22"><a href="#cb62-22" tabindex="-1"></a>    <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">color =</span> Cluster), <span class="at">cex =</span> <span class="fl">2.5</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb62-23"><a href="#cb62-23" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">&quot;white&quot;</span>,<span class="dv">0</span>), <span class="at">color =</span> <span class="fu">alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.8</span>),</span>
<span id="cb62-24"><a href="#cb62-24" tabindex="-1"></a>                 <span class="at">lwd =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">coef =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb62-25"><a href="#cb62-25" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> <span class="fu">as.character</span>(trait)) <span class="sc">+</span></span>
<span id="cb62-26"><a href="#cb62-26" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span> </span>
<span id="cb62-27"><a href="#cb62-27" tabindex="-1"></a>    theme_AGL <span class="sc">+</span></span>
<span id="cb62-28"><a href="#cb62-28" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb62-29"><a href="#cb62-29" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb62-30"><a href="#cb62-30" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="cn">NULL</span>)</span>
<span id="cb62-31"><a href="#cb62-31" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>myY <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_it17_gc.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>    <span class="fu">select</span>(Name, It17_gc.h.k, It17_gc.a.k, It17_gc.v.k, It17_gc.v.r, It17_gc.v.x.mid) <span class="sc">%&gt;%</span></span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>    <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_ro17_gc.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>      <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>      <span class="fu">select</span>(Name, Ro17_gc.h.k, Ro17_gc.a.k, Ro17_gc.v.k, Ro17_gc.v.r, Ro17_gc.v.x.mid), <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>    <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_su17_gc.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>      <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>      <span class="fu">select</span>(Name, Su17_gc.h.k, Su17_gc.a.k, Su17_gc.v.k, Su17_gc.v.r, Su17_gc.v.x.mid), <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a>    <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_myF.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a>      <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a>      <span class="fu">select</span>(Name, <span class="fu">contains</span>(<span class="st">&quot;Yield&quot;</span>)), <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>)</span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Supplemental_Table_01.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-19"><a href="#cb63-19" tabindex="-1"></a>  <span class="fu">arrange</span>(Chr, Pos) <span class="sc">%&gt;%</span> </span>
<span id="cb63-20"><a href="#cb63-20" tabindex="-1"></a>  <span class="fu">filter</span>(Threshold <span class="sc">==</span> <span class="st">&quot;Significant&quot;</span>, MAF <span class="sc">&gt;</span> <span class="fl">0.1</span>, <span class="sc">!</span><span class="fu">duplicated</span>(SNP)) <span class="sc">%&gt;%</span></span>
<span id="cb63-21"><a href="#cb63-21" tabindex="-1"></a>  <span class="fu">filter</span>(Chr <span class="sc">==</span> <span class="dv">7</span>)</span>
<span id="cb63-22"><a href="#cb63-22" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb63-23"><a href="#cb63-23" tabindex="-1"></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-24"><a href="#cb63-24" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb63-25"><a href="#cb63-25" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> xx<span class="sc">$</span>SNP) {</span>
<span id="cb63-26"><a href="#cb63-26" tabindex="-1"></a>  <span class="co"># Prep</span></span>
<span id="cb63-27"><a href="#cb63-27" tabindex="-1"></a>  myCaption <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Supplemental_Table_01.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-28"><a href="#cb63-28" tabindex="-1"></a>    <span class="fu">filter</span>(SNP <span class="sc">==</span> i) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Trait) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb63-29"><a href="#cb63-29" tabindex="-1"></a>  myCaption <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Trait Associations:&quot;</span>, <span class="fu">paste</span>(myCaption, <span class="at">collapse =</span> <span class="st">&quot;;&quot;</span>))</span>
<span id="cb63-30"><a href="#cb63-30" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb63-31"><a href="#cb63-31" tabindex="-1"></a>  mp1 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;It17_gc.h.k&quot;</span>, i)</span>
<span id="cb63-32"><a href="#cb63-32" tabindex="-1"></a>  mp2 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;It17_gc.a.k&quot;</span>, i)</span>
<span id="cb63-33"><a href="#cb63-33" tabindex="-1"></a>  mp3 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;It17_gc.v.k&quot;</span>, i)</span>
<span id="cb63-34"><a href="#cb63-34" tabindex="-1"></a>  mp4 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;It17_gc.v.r&quot;</span>, i)</span>
<span id="cb63-35"><a href="#cb63-35" tabindex="-1"></a>  mp5 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;It17_gc.v.x.mid&quot;</span>, i)</span>
<span id="cb63-36"><a href="#cb63-36" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb63-37"><a href="#cb63-37" tabindex="-1"></a>  mp6 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;Su17_gc.h.k&quot;</span>, i)</span>
<span id="cb63-38"><a href="#cb63-38" tabindex="-1"></a>  mp7 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;Su17_gc.a.k&quot;</span>, i)</span>
<span id="cb63-39"><a href="#cb63-39" tabindex="-1"></a>  mp8 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;Su17_gc.v.k&quot;</span>, i)</span>
<span id="cb63-40"><a href="#cb63-40" tabindex="-1"></a>  mp9 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;Su17_gc.v.r&quot;</span>, i)</span>
<span id="cb63-41"><a href="#cb63-41" tabindex="-1"></a>  mp10 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;Su17_gc.v.x.mid&quot;</span>, i)</span>
<span id="cb63-42"><a href="#cb63-42" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb63-43"><a href="#cb63-43" tabindex="-1"></a>  mp11 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;Ro17_gc.h.k&quot;</span>, i)</span>
<span id="cb63-44"><a href="#cb63-44" tabindex="-1"></a>  mp12 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;Ro17_gc.a.k&quot;</span>, i)</span>
<span id="cb63-45"><a href="#cb63-45" tabindex="-1"></a>  mp13 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;Ro17_gc.v.k&quot;</span>, i)</span>
<span id="cb63-46"><a href="#cb63-46" tabindex="-1"></a>  mp14 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;Ro17_gc.v.r&quot;</span>, i)</span>
<span id="cb63-47"><a href="#cb63-47" tabindex="-1"></a>  mp15 <span class="ot">&lt;-</span> <span class="fu">gg_BoxPlotMarker</span>(myG, myY, <span class="st">&quot;Ro17_gc.v.x.mid&quot;</span>, i)</span>
<span id="cb63-48"><a href="#cb63-48" tabindex="-1"></a>  <span class="co"># Append</span></span>
<span id="cb63-49"><a href="#cb63-49" tabindex="-1"></a>  mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, mp4, mp5, mp6, mp7, mp8, mp9, mp10, </span>
<span id="cb63-50"><a href="#cb63-50" tabindex="-1"></a>                  mp11, mp12, mp13, mp14, mp15, </span>
<span id="cb63-51"><a href="#cb63-51" tabindex="-1"></a>                  <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-52"><a href="#cb63-52" tabindex="-1"></a>    <span class="fu">annotate_figure</span>(<span class="at">top =</span> <span class="fu">text_grob</span>(i), <span class="at">bottom =</span> <span class="fu">text_grob</span>(myCaption, <span class="at">size =</span> <span class="dv">5</span>))</span>
<span id="cb63-53"><a href="#cb63-53" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">&quot;additional/Markers/Chr/&quot;</span>, i, <span class="st">&quot;.png&quot;</span>), mp, </span>
<span id="cb63-54"><a href="#cb63-54" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb63-55"><a href="#cb63-55" tabindex="-1"></a>  counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb63-56"><a href="#cb63-56" tabindex="-1"></a>}</span></code></pre></div>
<hr />
</div>
<div id="manhattan-plots" class="section level2">
<h2>Manhattan Plots</h2>
<blockquote>
<ul>
<li><i class="fas fa-globe" role="presentation" aria-label="globe icon"></i>
<a
href="https://github.com/derekmichaelwright/AGILE_LDP_UAV/tree/main/Additional/Manhattan"
target="_blank">Additional/Manhattan/</a></li>
</ul>
</blockquote>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> myTraits) {</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>  mp <span class="ot">&lt;-</span> <span class="fu">gg_Manhattan</span>(<span class="at">folder =</span> <span class="st">&quot;GWAS_Results/&quot;</span>, <span class="at">trait =</span> i, <span class="at">facet =</span> F,</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>                     <span class="at">models =</span> <span class="fu">c</span>(<span class="st">&quot;MLM&quot;</span>, <span class="st">&quot;FarmCPU&quot;</span>, <span class="st">&quot;BLINK&quot;</span>),</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>                     <span class="at">threshold =</span> <span class="fl">6.8</span>, <span class="at">sug.threshold =</span> <span class="dv">6</span>, <span class="at">legend.rows =</span> <span class="dv">2</span>,</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>                     <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">&quot;Additional/Manhattan/01_&quot;</span>,i,<span class="st">&quot;.png&quot;</span>), mp, </span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>  mp <span class="ot">&lt;-</span> <span class="fu">gg_Manhattan</span>(<span class="at">folder =</span> <span class="st">&quot;GWAS_Results/&quot;</span>, <span class="at">trait =</span> i, <span class="at">facet =</span> T,</span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>                     <span class="at">models =</span> <span class="fu">c</span>(<span class="st">&quot;MLM&quot;</span>, <span class="st">&quot;FarmCPU&quot;</span>, <span class="st">&quot;BLINK&quot;</span>),</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a>                     <span class="at">threshold =</span> <span class="fl">6.8</span>, <span class="at">sug.threshold =</span> <span class="dv">6</span>, <span class="at">legend.rows =</span> <span class="dv">2</span>,</span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>                     <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">&quot;Additional/Manhattan/02_&quot;</span>,i,<span class="st">&quot;.png&quot;</span>), mp, </span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a>         <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a>}</span></code></pre></div>
<hr />
</div>
</div>
<div id="figure-07---gwas-summary" class="section level1">
<h1>Figure 07 - GWAS Summary</h1>
<p><img src="Figure_07.jpg" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Supplemental_Table_01.csv&quot;</span>)</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a><span class="co"># Create plotting function</span></span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>gg_GWAS_Hits <span class="ot">&lt;-</span> <span class="cf">function</span>(xx, <span class="at">xg =</span> myG, myTs, <span class="at">myR =</span> <span class="dv">1000000</span>, <span class="at">myTitle =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>                         <span class="at">myYlab =</span> <span class="st">&quot;Significant Associations&quot;</span>, </span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>                         <span class="at">sigThresh =</span> <span class="fu">round</span>(<span class="fu">length</span>(myTs)<span class="sc">/</span><span class="dv">10</span>), <span class="at">sigMin =</span> <span class="dv">0</span>,  </span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>                         <span class="at">vlines =</span> <span class="cn">NULL</span>, <span class="at">vlines.types =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(vlines)),</span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a>                         <span class="at">vline.colors =</span> <span class="fu">rep</span>(<span class="st">&quot;red&quot;</span>, <span class="fu">length</span>(vlines)) ) {</span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a>  myCs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkorange3&quot;</span>, <span class="st">&quot;darkslategray4&quot;</span>,<span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">%in%</span> myTs, Threshold <span class="sc">==</span> <span class="st">&quot;Significant&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(P.value)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Hits =</span> <span class="cn">NA</span>)</span>
<span id="cb65-13"><a href="#cb65-13" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb65-14"><a href="#cb65-14" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(xx)) {</span>
<span id="cb65-15"><a href="#cb65-15" tabindex="-1"></a>    myChr <span class="ot">&lt;-</span> xx<span class="sc">$</span>Chr[i]</span>
<span id="cb65-16"><a href="#cb65-16" tabindex="-1"></a>    myPos <span class="ot">&lt;-</span> xx<span class="sc">$</span>Pos[i]</span>
<span id="cb65-17"><a href="#cb65-17" tabindex="-1"></a>    myMod <span class="ot">&lt;-</span> xx<span class="sc">$</span>Model[i]</span>
<span id="cb65-18"><a href="#cb65-18" tabindex="-1"></a>    xi <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> </span>
<span id="cb65-19"><a href="#cb65-19" tabindex="-1"></a>      <span class="fu">filter</span>(Chr <span class="sc">==</span> myChr, Model <span class="sc">==</span> myMod, Pos <span class="sc">&gt;</span> myPos<span class="sc">-</span>myR, Pos <span class="sc">&lt;</span> myPos<span class="sc">+</span>myR)</span>
<span id="cb65-20"><a href="#cb65-20" tabindex="-1"></a>    xx<span class="sc">$</span>Hits[i] <span class="ot">&lt;-</span> <span class="fu">nrow</span>(xi)</span>
<span id="cb65-21"><a href="#cb65-21" tabindex="-1"></a>    xi <span class="ot">&lt;-</span> xi <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(SNP <span class="sc">==</span> xx<span class="sc">$</span>SNP[i] <span class="sc">&amp;</span> Trait <span class="sc">==</span> xx<span class="sc">$</span>Trait[i]))</span>
<span id="cb65-22"><a href="#cb65-22" tabindex="-1"></a>    xx<span class="sc">$</span>Pos[xx<span class="sc">$</span>SNP <span class="sc">%in%</span> xi<span class="sc">$</span>SNP <span class="sc">&amp;</span> xx<span class="sc">$</span>Trait <span class="sc">%in%</span> xi<span class="sc">$</span>Trait] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb65-23"><a href="#cb65-23" tabindex="-1"></a>  }</span>
<span id="cb65-24"><a href="#cb65-24" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Pos), Hits <span class="sc">&gt;</span> sigMin) <span class="sc">%&gt;%</span></span>
<span id="cb65-25"><a href="#cb65-25" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Model =</span> <span class="fu">factor</span>(Model, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;MLM&quot;</span>, <span class="st">&quot;FarmCPU&quot;</span>, <span class="st">&quot;BLINK&quot;</span>)))</span>
<span id="cb65-26"><a href="#cb65-26" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb65-27"><a href="#cb65-27" tabindex="-1"></a>  ymax <span class="ot">&lt;-</span> <span class="fu">max</span>(xx<span class="sc">$</span>Hits)</span>
<span id="cb65-28"><a href="#cb65-28" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb65-29"><a href="#cb65-29" tabindex="-1"></a>  mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Pos <span class="sc">/</span> <span class="dv">100000000</span>) ) <span class="sc">+</span></span>
<span id="cb65-30"><a href="#cb65-30" tabindex="-1"></a>    <span class="fu">geom_blank</span>(<span class="at">data =</span> xg)</span>
<span id="cb65-31"><a href="#cb65-31" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(vlines)) {</span>
<span id="cb65-32"><a href="#cb65-32" tabindex="-1"></a>    xgm <span class="ot">&lt;-</span> xg <span class="sc">%&gt;%</span> </span>
<span id="cb65-33"><a href="#cb65-33" tabindex="-1"></a>      <span class="fu">filter</span>(SNP <span class="sc">%in%</span> vlines) <span class="sc">%&gt;%</span> </span>
<span id="cb65-34"><a href="#cb65-34" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">SNP =</span> <span class="fu">factor</span>(SNP, <span class="at">levels =</span> vlines)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-35"><a href="#cb65-35" tabindex="-1"></a>      <span class="fu">arrange</span>(SNP)</span>
<span id="cb65-36"><a href="#cb65-36" tabindex="-1"></a>    mp <span class="ot">&lt;-</span> mp <span class="sc">+</span> </span>
<span id="cb65-37"><a href="#cb65-37" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">data =</span> xgm, <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb65-38"><a href="#cb65-38" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">xintercept =</span> Pos <span class="sc">/</span> <span class="dv">100000000</span>, <span class="at">color =</span> SNP, <span class="at">lty =</span> SNP)) <span class="sc">+</span> </span>
<span id="cb65-39"><a href="#cb65-39" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> vline.colors) <span class="sc">+</span></span>
<span id="cb65-40"><a href="#cb65-40" tabindex="-1"></a>      <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> vlines.types)</span>
<span id="cb65-41"><a href="#cb65-41" tabindex="-1"></a>  }</span>
<span id="cb65-42"><a href="#cb65-42" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb65-43"><a href="#cb65-43" tabindex="-1"></a>  mp <span class="ot">&lt;-</span> mp <span class="sc">+</span></span>
<span id="cb65-44"><a href="#cb65-44" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Hits, <span class="at">size =</span> Hits, <span class="at">key1 =</span> SNP, </span>
<span id="cb65-45"><a href="#cb65-45" tabindex="-1"></a>                   <span class="at">fill =</span> Model, <span class="at">shape =</span> Model), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb65-46"><a href="#cb65-46" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="fu">paste</span>(myTitle) <span class="sc">~</span> <span class="fu">paste</span>(<span class="st">&quot;Chr&quot;</span>, Chr), </span>
<span id="cb65-47"><a href="#cb65-47" tabindex="-1"></a>               <span class="at">space =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="sc">+</span></span>
<span id="cb65-48"><a href="#cb65-48" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span><span class="sc">:</span><span class="dv">25</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;MLM&quot;</span>,<span class="st">&quot;FarmCPU&quot;</span>,<span class="st">&quot;BLINK&quot;</span>)) <span class="sc">+</span></span>
<span id="cb65-49"><a href="#cb65-49" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> myCs, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;MLM&quot;</span>,<span class="st">&quot;FarmCPU&quot;</span>,<span class="st">&quot;BLINK&quot;</span>)) <span class="sc">+</span></span>
<span id="cb65-50"><a href="#cb65-50" tabindex="-1"></a>    <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb65-51"><a href="#cb65-51" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb65-52"><a href="#cb65-52" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">accuracy =</span> <span class="dv">1</span>),</span>
<span id="cb65-53"><a href="#cb65-53" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,ymax)) <span class="sc">+</span></span>
<span id="cb65-54"><a href="#cb65-54" tabindex="-1"></a>    theme_AGL <span class="sc">+</span></span>
<span id="cb65-55"><a href="#cb65-55" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb65-56"><a href="#cb65-56" tabindex="-1"></a>          <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb65-57"><a href="#cb65-57" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> F, <span class="at">lty =</span> F, <span class="at">size =</span> F) <span class="sc">+</span></span>
<span id="cb65-58"><a href="#cb65-58" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;100 Mbp&quot;</span>, <span class="at">y =</span> myYlab)</span>
<span id="cb65-59"><a href="#cb65-59" tabindex="-1"></a>  mp</span>
<span id="cb65-60"><a href="#cb65-60" tabindex="-1"></a>}</span>
<span id="cb65-61"><a href="#cb65-61" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb65-62"><a href="#cb65-62" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, myG, <span class="at">myTitle =</span> <span class="st">&quot;Manual&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb65-63"><a href="#cb65-63" tabindex="-1"></a>          <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Canopy.Height|Plant.Length|Biomass&quot;</span>, myTraits)],</span>
<span id="cb65-64"><a href="#cb65-64" tabindex="-1"></a>          <span class="at">vlines =</span> myMarkers, <span class="at">vlines.types =</span> myVltys, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb65-65"><a href="#cb65-65" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, myG, <span class="at">myTitle =</span> <span class="st">&quot;UAV&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;Number of Significant Associations&quot;</span>,</span>
<span id="cb65-66"><a href="#cb65-66" tabindex="-1"></a>          <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Plot.Height|Plot.Area|Plot.Volume&quot;</span>, myTraits)], </span>
<span id="cb65-67"><a href="#cb65-67" tabindex="-1"></a>          <span class="at">vlines =</span> myMarkers, <span class="at">vlines.types =</span> myVltys, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb65-68"><a href="#cb65-68" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, myG, <span class="at">myTitle =</span> <span class="st">&quot;Growth Curves&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb65-69"><a href="#cb65-69" tabindex="-1"></a>          <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;gc.h|gc.a|gc.v&quot;</span>, myTraits)], </span>
<span id="cb65-70"><a href="#cb65-70" tabindex="-1"></a>          <span class="at">vlines =</span> myMarkers, <span class="at">vlines.types =</span> myVltys, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb65-71"><a href="#cb65-71" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb65-72"><a href="#cb65-72" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb65-73"><a href="#cb65-73" tabindex="-1"></a>                <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb65-74"><a href="#cb65-74" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Figure_07.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="supplemental-figure-6" class="section level1">
<h1>Supplemental Figure 6</h1>
<p><img src="Supplemental_Figure_06.jpg" /></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, myG, <span class="at">myTitle =</span> <span class="st">&quot;It17&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>                    <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;It17&quot;</span>, myTraits)], </span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>                    <span class="at">vlines =</span> myMarkers, <span class="at">vlines.types =</span> myVltys, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, myG, <span class="at">myTitle =</span> <span class="st">&quot;Ro17&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;Number of Significant Associations&quot;</span>,</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>                    <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Ro17&quot;</span>, myTraits)],</span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>                    <span class="at">vlines =</span> myMarkers, <span class="at">vlines.types =</span> myVltys, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, myG, <span class="at">myTitle =</span> <span class="st">&quot;Su17+Su18&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>                    <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Su17|Su18&quot;</span>, myTraits)], </span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a>                    <span class="at">vlines =</span> myMarkers, <span class="at">vlines.types =</span> myVltys, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb66-12"><a href="#cb66-12" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb66-13"><a href="#cb66-13" tabindex="-1"></a>                <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb66-14"><a href="#cb66-14" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Supplemental_Figure_06.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="supplemental-figure-7" class="section level1">
<h1>Supplemental Figure 7</h1>
<p><img src="Supplemental_Figure_07.jpg" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, myG, <span class="at">myTitle =</span> <span class="st">&quot;Height&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>                    <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Height|gc.h|Plant.Length&quot;</span>, myTraits)], </span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>                    <span class="at">vlines =</span> myMarkers, <span class="at">vlines.types =</span> myVltys, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, myG, <span class="at">myTitle =</span> <span class="st">&quot;Area&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;Number of Significant Associations&quot;</span>,</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>                    <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Area|gc.a|Width&quot;</span>, myTraits)],</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>                    <span class="at">vlines =</span> myMarkers, <span class="at">vlines.types =</span> myVltys, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, myG, <span class="at">myTitle =</span> <span class="st">&quot;Volume&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>                    <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Volume|gc.v|Biomass|Plant.Mass&quot;</span>, myTraits)], </span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a>                    <span class="at">vlines =</span> myMarkers, <span class="at">vlines.types =</span> myVltys, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb67-13"><a href="#cb67-13" tabindex="-1"></a>                <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb67-14"><a href="#cb67-14" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Supplemental_Figure_07.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="figure-08---markers" class="section level1">
<h1>Figure 08 - Markers</h1>
<p><img src="Figure_08.jpg" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>myEs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Su17&quot;</span>, <span class="st">&quot;It17&quot;</span>)</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>myPCA <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;myPCA.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>  <span class="fu">fixNames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">factor</span>(Cluster))</span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>myY <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_su17_gc.csv&quot;</span>), </span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>         Name, Su17_gc.h.k, Su17_gc.v.k, Su17_gc.v.x.mid),</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_it17_gc.csv&quot;</span>), </span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>         Name, It17_gc.h.k, It17_gc.v.k, It17_gc.v.x.mid),</span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() </span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a>xx <span class="ot">&lt;-</span> myG <span class="sc">%&gt;%</span> </span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a>  <span class="fu">filter</span>(SNP <span class="sc">%in%</span> myMarkers[<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a>  <span class="fu">gather</span>(Name, Allele, <span class="dv">12</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb68-16"><a href="#cb68-16" tabindex="-1"></a>  <span class="fu">select</span>(Name, SNP, Allele) <span class="sc">%&gt;%</span> </span>
<span id="cb68-17"><a href="#cb68-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Allele =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Allele, dna<span class="sc">$</span>Symbol, dna<span class="sc">$</span>Value), </span>
<span id="cb68-18"><a href="#cb68-18" tabindex="-1"></a>         <span class="at">Allele =</span> <span class="fu">factor</span>(Allele, <span class="at">levels =</span> dna<span class="sc">$</span>Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-19"><a href="#cb68-19" tabindex="-1"></a>  <span class="fu">filter</span>(Allele <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>,<span class="st">&quot;CC&quot;</span>,<span class="st">&quot;TT&quot;</span>,<span class="st">&quot;GG&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-20"><a href="#cb68-20" tabindex="-1"></a>  <span class="fu">spread</span>(SNP, Allele) <span class="sc">%&gt;%</span></span>
<span id="cb68-21"><a href="#cb68-21" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(myPCA, Name, Cluster), <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>)</span>
<span id="cb68-22"><a href="#cb68-22" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb68-23"><a href="#cb68-23" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(myY, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-24"><a href="#cb68-24" tabindex="-1"></a>  <span class="fu">gather</span>(Expt, Value, Su17_gc.h.k, It17_gc.h.k) <span class="sc">%&gt;%</span></span>
<span id="cb68-25"><a href="#cb68-25" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Expt, <span class="fu">c</span>(<span class="st">&quot;Su17_gc.h.k&quot;</span>, <span class="st">&quot;It17_gc.h.k&quot;</span>), myEs),</span>
<span id="cb68-26"><a href="#cb68-26" tabindex="-1"></a>         <span class="at">Expt =</span> <span class="fu">factor</span>(Expt, <span class="at">levels =</span> myEs))</span>
<span id="cb68-27"><a href="#cb68-27" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb68-28"><a href="#cb68-28" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(x1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">get</span>(myMarkers[<span class="dv">4</span>]))), </span>
<span id="cb68-29"><a href="#cb68-29" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">get</span>(myMarkers[<span class="dv">4</span>]), <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb68-30"><a href="#cb68-30" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">color =</span> Cluster), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.75</span>, <span class="at">cex =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb68-31"><a href="#cb68-31" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">&quot;white&quot;</span>,<span class="dv">0</span>), <span class="at">color =</span> <span class="fu">alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.7</span>),</span>
<span id="cb68-32"><a href="#cb68-32" tabindex="-1"></a>               <span class="at">lwd =</span> <span class="fl">0.75</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">coef =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb68-33"><a href="#cb68-33" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Expt <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb68-34"><a href="#cb68-34" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span> </span>
<span id="cb68-35"><a href="#cb68-35" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb68-36"><a href="#cb68-36" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb68-37"><a href="#cb68-37" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;A)&quot;</span>, myMarkers[<span class="dv">4</span>]), <span class="at">y =</span> <span class="st">&quot;Plot Height&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>)</span>
<span id="cb68-38"><a href="#cb68-38" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb68-39"><a href="#cb68-39" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(x1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">get</span>(myMarkers[<span class="dv">5</span>]))),</span>
<span id="cb68-40"><a href="#cb68-40" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">get</span>(myMarkers[<span class="dv">5</span>]), <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb68-41"><a href="#cb68-41" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">color =</span> Cluster), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.75</span>, <span class="at">cex =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb68-42"><a href="#cb68-42" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">&quot;white&quot;</span>,<span class="dv">0</span>), <span class="at">color =</span> <span class="fu">alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.7</span>),</span>
<span id="cb68-43"><a href="#cb68-43" tabindex="-1"></a>               <span class="at">lwd =</span> <span class="fl">0.75</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">coef =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb68-44"><a href="#cb68-44" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Expt <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb68-45"><a href="#cb68-45" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span> </span>
<span id="cb68-46"><a href="#cb68-46" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb68-47"><a href="#cb68-47" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb68-48"><a href="#cb68-48" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;B)&quot;</span>,myMarkers[<span class="dv">5</span>]), <span class="at">y =</span> <span class="st">&quot;Plot Height&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>)</span>
<span id="cb68-49"><a href="#cb68-49" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb68-50"><a href="#cb68-50" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(myY, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-51"><a href="#cb68-51" tabindex="-1"></a>  <span class="fu">gather</span>(Expt, Value, Su17_gc.v.k, It17_gc.v.k) <span class="sc">%&gt;%</span></span>
<span id="cb68-52"><a href="#cb68-52" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Expt, <span class="fu">c</span>(<span class="st">&quot;Su17_gc.v.k&quot;</span>, <span class="st">&quot;It17_gc.v.k&quot;</span>), myEs),</span>
<span id="cb68-53"><a href="#cb68-53" tabindex="-1"></a>         <span class="at">Expt =</span> <span class="fu">factor</span>(Expt, <span class="at">levels =</span> myEs))</span>
<span id="cb68-54"><a href="#cb68-54" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb68-55"><a href="#cb68-55" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(x1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">get</span>(myMarkers[<span class="dv">6</span>]))),</span>
<span id="cb68-56"><a href="#cb68-56" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">get</span>(myMarkers[<span class="dv">6</span>]), <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb68-57"><a href="#cb68-57" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">color =</span> Cluster), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.75</span>, <span class="at">cex =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb68-58"><a href="#cb68-58" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">&quot;white&quot;</span>,<span class="dv">0</span>), <span class="at">color =</span> <span class="fu">alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.7</span>),</span>
<span id="cb68-59"><a href="#cb68-59" tabindex="-1"></a>               <span class="at">lwd =</span> <span class="fl">0.75</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">coef =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb68-60"><a href="#cb68-60" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Expt <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb68-61"><a href="#cb68-61" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span> </span>
<span id="cb68-62"><a href="#cb68-62" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb68-63"><a href="#cb68-63" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb68-64"><a href="#cb68-64" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;C)&quot;</span>,myMarkers[<span class="dv">6</span>]), <span class="at">y =</span> <span class="st">&quot;Plot Volume&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>)</span>
<span id="cb68-65"><a href="#cb68-65" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb68-66"><a href="#cb68-66" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> xx <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(myY, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-67"><a href="#cb68-67" tabindex="-1"></a>  <span class="fu">gather</span>(Expt, Value, Su17_gc.v.x.mid, It17_gc.v.x.mid) <span class="sc">%&gt;%</span></span>
<span id="cb68-68"><a href="#cb68-68" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Expt =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Expt, <span class="fu">c</span>(<span class="st">&quot;Su17_gc.v.x.mid&quot;</span>, <span class="st">&quot;It17_gc.v.x.mid&quot;</span>), myEs),</span>
<span id="cb68-69"><a href="#cb68-69" tabindex="-1"></a>         <span class="at">Expt =</span> <span class="fu">factor</span>(Expt, <span class="at">levels =</span> myEs))</span>
<span id="cb68-70"><a href="#cb68-70" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb68-71"><a href="#cb68-71" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(x1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">get</span>(myMarkers[<span class="dv">7</span>]))),</span>
<span id="cb68-72"><a href="#cb68-72" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">get</span>(myMarkers[<span class="dv">7</span>]), <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb68-73"><a href="#cb68-73" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">color =</span> Cluster), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.75</span>, <span class="at">cex =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb68-74"><a href="#cb68-74" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">&quot;white&quot;</span>,<span class="dv">0</span>), <span class="at">color =</span> <span class="fu">alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.7</span>),</span>
<span id="cb68-75"><a href="#cb68-75" tabindex="-1"></a>               <span class="at">lwd =</span> <span class="fl">0.75</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">coef =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb68-76"><a href="#cb68-76" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Expt <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb68-77"><a href="#cb68-77" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span> </span>
<span id="cb68-78"><a href="#cb68-78" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb68-79"><a href="#cb68-79" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb68-80"><a href="#cb68-80" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;D)&quot;</span>,myMarkers[<span class="dv">7</span>]), <span class="at">y =</span> <span class="st">&quot;Volume x.mid&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>)</span>
<span id="cb68-81"><a href="#cb68-81" tabindex="-1"></a><span class="co"># Append</span></span>
<span id="cb68-82"><a href="#cb68-82" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, mp4, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb68-83"><a href="#cb68-83" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Figure_08.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
<div id="additional-figures-11---ah-by-ftb" class="section level2">
<h2>Additional Figures 11 - AH by FTb</h2>
<p><img src="Additional/Additional_Figure_11.png" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>myY <span class="ot">&lt;-</span> su17_f <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>  <span class="fu">fixNames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>  <span class="fu">group_by</span>(Name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Yield =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T))</span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>myV <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Data_GWAS/myY_su17_gc.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>  <span class="fu">fixNames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>  <span class="fu">select</span>(Name, Su17_gc.h.k, Su17_gc.a.k, Su17_gc.v.k)</span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>myPCA <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;myPCA.csv&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Name, Origin) <span class="sc">%&gt;%</span></span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a>  <span class="fu">fixNames</span>()</span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>xx <span class="ot">&lt;-</span> myG <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SNP <span class="sc">%in%</span> myMarkersd[<span class="dv">3</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a>  <span class="fu">gather</span>(Name, Allele, <span class="dv">12</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a>  <span class="fu">select</span>(Name, SNP, Allele) <span class="sc">%&gt;%</span> </span>
<span id="cb69-14"><a href="#cb69-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Allele =</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(Allele, dna<span class="sc">$</span>Symbol, dna<span class="sc">$</span>Value), </span>
<span id="cb69-15"><a href="#cb69-15" tabindex="-1"></a>         <span class="at">Allele =</span> <span class="fu">factor</span>(Allele, <span class="at">levels =</span> dna<span class="sc">$</span>Value)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-16"><a href="#cb69-16" tabindex="-1"></a>  <span class="fu">filter</span>(Allele <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>,<span class="st">&quot;CC&quot;</span>,<span class="st">&quot;TT&quot;</span>,<span class="st">&quot;GG&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb69-17"><a href="#cb69-17" tabindex="-1"></a>  <span class="fu">spread</span>(SNP, Allele) <span class="sc">%&gt;%</span></span>
<span id="cb69-18"><a href="#cb69-18" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(myPCA, Name, Origin)) <span class="sc">%&gt;%</span></span>
<span id="cb69-19"><a href="#cb69-19" tabindex="-1"></a>  <span class="fu">left_join</span>(myV, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-20"><a href="#cb69-20" tabindex="-1"></a>  <span class="fu">left_join</span>(myY, <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-21"><a href="#cb69-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Origin =</span> <span class="fu">ifelse</span>(Origin <span class="sc">==</span> <span class="st">&quot;Canada&quot;</span>, Origin, <span class="st">&quot;Other&quot;</span>),</span>
<span id="cb69-22"><a href="#cb69-22" tabindex="-1"></a>         <span class="at">Group =</span> <span class="fu">ifelse</span>(<span class="fu">get</span>(myMarkersd[<span class="dv">3</span>]) <span class="sc">==</span> <span class="st">&quot;CC&quot;</span>, <span class="st">&quot;Other [CC]&quot;</span>, <span class="st">&quot;Other [TT]&quot;</span>),</span>
<span id="cb69-23"><a href="#cb69-23" tabindex="-1"></a>         <span class="at">Group =</span> <span class="fu">ifelse</span>(Origin <span class="sc">==</span> <span class="st">&quot;Canada&quot;</span>, <span class="st">&quot;Canada [CC]&quot;</span>, Group)) <span class="sc">%&gt;%</span></span>
<span id="cb69-24"><a href="#cb69-24" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">rev</span>(Group))</span>
<span id="cb69-25"><a href="#cb69-25" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb69-26"><a href="#cb69-26" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Su17_gc.a.k, <span class="at">y =</span> Su17_gc.h.k, <span class="at">size =</span> Yield)) <span class="sc">+</span></span>
<span id="cb69-27"><a href="#cb69-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">get</span>(myMarkersd[<span class="dv">3</span>]), <span class="at">pch =</span> Group), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb69-28"><a href="#cb69-28" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> xx <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Origin <span class="sc">!=</span> <span class="st">&quot;Canada&quot;</span>, <span class="fu">get</span>(myMarkersd[<span class="dv">3</span>]) <span class="sc">==</span> <span class="st">&quot;CC&quot;</span>), <span class="at">pch =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb69-29"><a href="#cb69-29" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;FTb&quot;</span>)), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;deeppink4&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>)) <span class="sc">+</span></span>
<span id="cb69-30"><a href="#cb69-30" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">name =</span> <span class="st">&quot;Origin&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">16</span>,<span class="dv">16</span>),</span>
<span id="cb69-31"><a href="#cb69-31" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Canada [CC]&quot;</span>, <span class="st">&quot;Other [CC]&quot;</span>, <span class="st">&quot;Other [TT]&quot;</span>),</span>
<span id="cb69-32"><a href="#cb69-32" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Canada&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Other&quot;</span>)) <span class="sc">+</span></span>
<span id="cb69-33"><a href="#cb69-33" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb69-34"><a href="#cb69-34" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> <span class="st">&quot;Sutherland, Canada 2017&quot;</span>) <span class="sc">+</span></span>
<span id="cb69-35"><a href="#cb69-35" tabindex="-1"></a>  theme_AGL <span class="sc">+</span></span>
<span id="cb69-36"><a href="#cb69-36" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Plot Area&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Plot Height&quot;</span>)</span>
<span id="cb69-37"><a href="#cb69-37" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_11.png&quot;</span>, mp, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
<hr />
</div>
</div>
<div id="supplemental-figure-8---dtf-markers" class="section level1">
<h1>Supplemental Figure 8 - DTF Markers</h1>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Supplemental_Figure_08_Su17.html"
target="_blank">Additional/Supplemental_Figure_08_Su17.html</a></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Supplemental_Figure_08_It17.html"
target="_blank">Additional/Supplemental_Figure_08_It17.html</a></li>
</ul>
</blockquote>
<p><img src="Supplemental_Figure_08.jpg" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="co"># Create plotting function</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>gg_HAMarker <span class="ot">&lt;-</span> <span class="cf">function</span>(xh, xa, xf, xm, <span class="at">myTitle =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>                        <span class="at">dtf_range =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">62</span>), <span class="at">yield_limit =</span> <span class="dv">300</span>,</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>                        <span class="at">plotlyfilename =</span> <span class="st">&quot;Additional/Supplemental_Figure.html&quot;</span>) {</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>  <span class="co"># Prep data</span></span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>  xh <span class="ot">&lt;-</span> xh[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Entry) <span class="sc">%&gt;%</span></span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Height =</span> <span class="fu">mean</span>(k, <span class="at">na.rm =</span> T))</span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>  xa <span class="ot">&lt;-</span> xa[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Entry) <span class="sc">%&gt;%</span></span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Area =</span> <span class="fu">mean</span>(k, <span class="at">na.rm =</span> T))</span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>  xs <span class="ot">&lt;-</span> xf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;Seed.Mass&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a>    <span class="fu">group_by</span>(Entry) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Yield =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T))</span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a>  xd <span class="ot">&lt;-</span> xf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">&quot;DTF&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-13"><a href="#cb70-13" tabindex="-1"></a>    <span class="fu">group_by</span>(Entry) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">DTF =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> T))</span>
<span id="cb70-14"><a href="#cb70-14" tabindex="-1"></a>  myPCA <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;myPCA.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-15"><a href="#cb70-15" tabindex="-1"></a>    <span class="fu">fixNames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-16"><a href="#cb70-16" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Cluster =</span> <span class="fu">factor</span>(Cluster))</span>
<span id="cb70-17"><a href="#cb70-17" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb70-18"><a href="#cb70-18" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> myG <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SNP <span class="sc">%in%</span> myMarkersd) <span class="sc">%&gt;%</span> </span>
<span id="cb70-19"><a href="#cb70-19" tabindex="-1"></a>    <span class="fu">gather</span>(Name, Allele, <span class="dv">12</span><span class="sc">:</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-20"><a href="#cb70-20" tabindex="-1"></a>    <span class="fu">select</span>(Name, SNP, Allele) <span class="sc">%&gt;%</span></span>
<span id="cb70-21"><a href="#cb70-21" tabindex="-1"></a>    <span class="fu">spread</span>(SNP, Allele) <span class="sc">%&gt;%</span></span>
<span id="cb70-22"><a href="#cb70-22" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Late =</span> <span class="fu">ifelse</span>(<span class="fu">get</span>(myMarkersd[<span class="dv">3</span>]) <span class="sc">==</span> <span class="st">&quot;GG&quot;</span>, <span class="st">&quot;Late Alleles&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb70-23"><a href="#cb70-23" tabindex="-1"></a>           <span class="at">Early =</span> <span class="fu">ifelse</span>(<span class="fu">get</span>(myMarkersd[<span class="dv">1</span>]) <span class="sc">==</span> <span class="st">&quot;CC&quot;</span> <span class="sc">|</span> <span class="fu">get</span>(myMarkersd[<span class="dv">2</span>]) <span class="sc">==</span> <span class="st">&quot;AA&quot;</span>, <span class="st">&quot;Early Alleles&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb70-24"><a href="#cb70-24" tabindex="-1"></a>           <span class="at">FloweringAlleles =</span> <span class="fu">ifelse</span>(Late <span class="sc">==</span> <span class="st">&quot;&quot;</span>, Early, Late),</span>
<span id="cb70-25"><a href="#cb70-25" tabindex="-1"></a>           <span class="at">FloweringAlleles =</span> <span class="fu">ifelse</span>(Late <span class="sc">==</span> <span class="st">&quot;Late Alleles&quot;</span> <span class="sc">&amp;</span> Early <span class="sc">==</span> <span class="st">&quot;Early Alleles&quot;</span>, <span class="st">&quot;Other&quot;</span>, FloweringAlleles),</span>
<span id="cb70-26"><a href="#cb70-26" tabindex="-1"></a>           <span class="at">FloweringAlleles =</span> <span class="fu">ifelse</span>(FloweringAlleles <span class="sc">==</span> <span class="st">&quot;&quot;</span>, <span class="st">&quot;Other&quot;</span>, FloweringAlleles)) <span class="sc">%&gt;%</span></span>
<span id="cb70-27"><a href="#cb70-27" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="fu">select</span>(myPCA, Name, Entry, Cluster, Origin), <span class="at">by =</span> <span class="st">&quot;Name&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-28"><a href="#cb70-28" tabindex="-1"></a>    <span class="fu">left_join</span>(xh, <span class="at">by =</span> <span class="st">&quot;Entry&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-29"><a href="#cb70-29" tabindex="-1"></a>    <span class="fu">left_join</span>(xa, <span class="at">by =</span> <span class="st">&quot;Entry&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-30"><a href="#cb70-30" tabindex="-1"></a>    <span class="fu">left_join</span>(xs, <span class="at">by =</span> <span class="st">&quot;Entry&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-31"><a href="#cb70-31" tabindex="-1"></a>    <span class="fu">left_join</span>(xd, <span class="at">by =</span> <span class="st">&quot;Entry&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-32"><a href="#cb70-32" tabindex="-1"></a>    <span class="fu">arrange</span>(Yield) <span class="sc">%&gt;%</span></span>
<span id="cb70-33"><a href="#cb70-33" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Selection =</span> <span class="fu">ifelse</span>(FloweringAlleles <span class="sc">==</span> <span class="st">&quot;Other&quot;</span> <span class="sc">&amp;</span> Yield <span class="sc">&gt;=</span> yield_limit <span class="sc">&amp;</span> </span>
<span id="cb70-34"><a href="#cb70-34" tabindex="-1"></a>                                DTF <span class="sc">&gt;=</span> dtf_range[<span class="dv">1</span>] <span class="sc">&amp;</span> DTF <span class="sc">&lt;=</span> dtf_range[<span class="dv">2</span>], <span class="st">&quot;Selected&quot;</span>, <span class="st">&quot;Other&quot;</span>),</span>
<span id="cb70-35"><a href="#cb70-35" tabindex="-1"></a>           <span class="at">FloweringAlleles =</span> <span class="fu">factor</span>(FloweringAlleles, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Early Alleles&quot;</span>, <span class="st">&quot;Late Alleles&quot;</span>, <span class="st">&quot;Other&quot;</span>)))</span>
<span id="cb70-36"><a href="#cb70-36" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb70-37"><a href="#cb70-37" tabindex="-1"></a>  mypchs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">16</span>)</span>
<span id="cb70-38"><a href="#cb70-38" tabindex="-1"></a>  myalphas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.9</span>)</span>
<span id="cb70-39"><a href="#cb70-39" tabindex="-1"></a>  mysizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="dv">2</span>)</span>
<span id="cb70-40"><a href="#cb70-40" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb70-41"><a href="#cb70-41" tabindex="-1"></a>  mp1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> Area, <span class="at">y =</span> Height, </span>
<span id="cb70-42"><a href="#cb70-42" tabindex="-1"></a>                        <span class="at">color =</span> Cluster, <span class="at">pch =</span> FloweringAlleles,</span>
<span id="cb70-43"><a href="#cb70-43" tabindex="-1"></a>                        <span class="at">alpha =</span> Selection, <span class="at">size =</span> Selection)) <span class="sc">+</span> </span>
<span id="cb70-44"><a href="#cb70-44" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">key1 =</span> Entry, <span class="at">key2 =</span> Name, <span class="at">key3 =</span> Origin, </span>
<span id="cb70-45"><a href="#cb70-45" tabindex="-1"></a>                   <span class="at">key4 =</span> Yield, <span class="at">key5 =</span> DTF)) <span class="sc">+</span> </span>
<span id="cb70-46"><a href="#cb70-46" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span> </span>
<span id="cb70-47"><a href="#cb70-47" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> mypchs, <span class="at">guide =</span> F) <span class="sc">+</span></span>
<span id="cb70-48"><a href="#cb70-48" tabindex="-1"></a>    <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> myalphas) <span class="sc">+</span></span>
<span id="cb70-49"><a href="#cb70-49" tabindex="-1"></a>    <span class="fu">scale_size_manual</span>(<span class="at">values =</span> mysizes) <span class="sc">+</span></span>
<span id="cb70-50"><a href="#cb70-50" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb70-51"><a href="#cb70-51" tabindex="-1"></a>    theme_AGL <span class="sc">+</span></span>
<span id="cb70-52"><a href="#cb70-52" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> myTitle, <span class="at">y =</span> <span class="st">&quot;Plot Height&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Plot Area&quot;</span>)</span>
<span id="cb70-53"><a href="#cb70-53" tabindex="-1"></a>  <span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(mp1), <span class="at">file=</span>plotlyfilename)</span>
<span id="cb70-54"><a href="#cb70-54" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb70-55"><a href="#cb70-55" tabindex="-1"></a>  mp2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> FloweringAlleles, <span class="at">y =</span> Yield, </span>
<span id="cb70-56"><a href="#cb70-56" tabindex="-1"></a>                        <span class="at">color =</span> Cluster, <span class="at">pch =</span> FloweringAlleles,</span>
<span id="cb70-57"><a href="#cb70-57" tabindex="-1"></a>                        <span class="at">alpha =</span> Selection, <span class="at">size =</span> Selection)) <span class="sc">+</span> </span>
<span id="cb70-58"><a href="#cb70-58" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> yield_limit) <span class="sc">+</span></span>
<span id="cb70-59"><a href="#cb70-59" tabindex="-1"></a>    <span class="fu">geom_quasirandom</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb70-60"><a href="#cb70-60" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span> </span>
<span id="cb70-61"><a href="#cb70-61" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> mypchs, <span class="at">guide =</span> F) <span class="sc">+</span></span>
<span id="cb70-62"><a href="#cb70-62" tabindex="-1"></a>    <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> myalphas) <span class="sc">+</span></span>
<span id="cb70-63"><a href="#cb70-63" tabindex="-1"></a>    <span class="fu">scale_size_manual</span>(<span class="at">values =</span> mysizes) <span class="sc">+</span></span>
<span id="cb70-64"><a href="#cb70-64" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb70-65"><a href="#cb70-65" tabindex="-1"></a>    theme_AGL <span class="sc">+</span></span>
<span id="cb70-66"><a href="#cb70-66" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;DTF Markers&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Yield (g/plot)&quot;</span>)</span>
<span id="cb70-67"><a href="#cb70-67" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb70-68"><a href="#cb70-68" tabindex="-1"></a>  mp3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(xx, <span class="fu">aes</span>(<span class="at">x =</span> FloweringAlleles, <span class="at">y =</span> DTF, </span>
<span id="cb70-69"><a href="#cb70-69" tabindex="-1"></a>                        <span class="at">color =</span> Cluster, <span class="at">pch =</span> FloweringAlleles,</span>
<span id="cb70-70"><a href="#cb70-70" tabindex="-1"></a>                        <span class="at">alpha =</span> Selection, <span class="at">size =</span> Selection)) <span class="sc">+</span> </span>
<span id="cb70-71"><a href="#cb70-71" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> dtf_range) <span class="sc">+</span></span>
<span id="cb70-72"><a href="#cb70-72" tabindex="-1"></a>    <span class="fu">geom_quasirandom</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb70-73"><a href="#cb70-73" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> myColors_Cluster) <span class="sc">+</span> </span>
<span id="cb70-74"><a href="#cb70-74" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> mypchs, <span class="at">guide =</span> F) <span class="sc">+</span></span>
<span id="cb70-75"><a href="#cb70-75" tabindex="-1"></a>    <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> myalphas) <span class="sc">+</span></span>
<span id="cb70-76"><a href="#cb70-76" tabindex="-1"></a>    <span class="fu">scale_size_manual</span>(<span class="at">values =</span> mysizes) <span class="sc">+</span></span>
<span id="cb70-77"><a href="#cb70-77" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb70-78"><a href="#cb70-78" tabindex="-1"></a>    theme_AGL <span class="sc">+</span></span>
<span id="cb70-79"><a href="#cb70-79" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;DTF Markers&quot;</span>, <span class="at">y =</span> <span class="st">&quot;DTF&quot;</span>)</span>
<span id="cb70-80"><a href="#cb70-80" tabindex="-1"></a>  <span class="co"># Append</span></span>
<span id="cb70-81"><a href="#cb70-81" tabindex="-1"></a>  mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp1, mp2, mp3, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">align =</span> <span class="st">&quot;h&quot;</span>, <span class="at">common.legend =</span> T, <span class="at">legend =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb70-82"><a href="#cb70-82" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb70-83"><a href="#cb70-83" tabindex="-1"></a>  mp</span>
<span id="cb70-84"><a href="#cb70-84" tabindex="-1"></a>}</span>
<span id="cb70-85"><a href="#cb70-85" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb70-86"><a href="#cb70-86" tabindex="-1"></a>mp_a <span class="ot">&lt;-</span> <span class="fu">gg_HAMarker</span>(<span class="at">xh =</span> su17_gc.h, <span class="at">xa =</span> su17_gc.a, <span class="at">xf =</span> su17_f, </span>
<span id="cb70-87"><a href="#cb70-87" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;A) Sutherland, Canada 2017&quot;</span>,</span>
<span id="cb70-88"><a href="#cb70-88" tabindex="-1"></a>                   <span class="at">dtf_range =</span> <span class="fu">c</span>(<span class="dv">47</span>, <span class="dv">62</span>), <span class="at">yield_limit =</span> <span class="dv">300</span>,</span>
<span id="cb70-89"><a href="#cb70-89" tabindex="-1"></a>                   <span class="at">plotlyfilename =</span> <span class="st">&quot;Additional/Supplemental_Figure_08_Su17.html&quot;</span>)</span>
<span id="cb70-90"><a href="#cb70-90" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb70-91"><a href="#cb70-91" tabindex="-1"></a>mp_b <span class="ot">&lt;-</span> <span class="fu">gg_HAMarker</span>(<span class="at">xh =</span> it17_gc.h, <span class="at">xa =</span> it17_gc.a, <span class="at">xf =</span> it17_f, </span>
<span id="cb70-92"><a href="#cb70-92" tabindex="-1"></a>                   <span class="at">myTitle =</span> <span class="st">&quot;B) Metaponto, Italy 2017&quot;</span>,</span>
<span id="cb70-93"><a href="#cb70-93" tabindex="-1"></a>                   <span class="at">dtf_range =</span> <span class="fu">c</span>(<span class="dv">95</span>, <span class="dv">145</span>), <span class="at">yield_limit =</span> <span class="dv">100</span>,</span>
<span id="cb70-94"><a href="#cb70-94" tabindex="-1"></a>                   <span class="at">plotlyfilename =</span> <span class="st">&quot;Additional/Supplemental_Figure_08_It17.html&quot;</span>)</span>
<span id="cb70-95"><a href="#cb70-95" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb70-96"><a href="#cb70-96" tabindex="-1"></a>mp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(mp_a, mp_b, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> T)</span>
<span id="cb70-97"><a href="#cb70-97" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Supplemental_Figure_08.jpg&quot;</span>, mp, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<hr />
<div id="additional-figures-12" class="section level2">
<h2>Additional Figures 12</h2>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_12_1.html"
target="_blank">Additional/Additional_Figure_12_1.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_12_1.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_12_2.html"
target="_blank">Additional/Additional_Figure_12_2.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_12_2.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_12_3.html"
target="_blank">Additional/Additional_Figure_12_3.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_12_3.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_12_4.html"
target="_blank">Additional/Additional_Figure_12_4.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_12_4.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_12_5.html"
target="_blank">Additional/Additional_Figure_12_5.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_12_5.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_12_6.html"
target="_blank">Additional/Additional_Figure_12_6.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_12_6.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_12_7.html"
target="_blank">Additional/Additional_Figure_12_7.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_12_7.png" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="co"># Prep data</span></span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Supplemental_Table_01.csv&quot;</span>)</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, <span class="at">myTitle =</span> <span class="st">&quot;Manual&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>          <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Canopy.Height|Plant.Length|Biomass|Plant.Mass|Yield|Seed.Mass&quot;</span>, myTraits)], </span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>          <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, <span class="at">myTitle =</span> <span class="st">&quot;UAV&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;Number of Significant Associations&quot;</span>,</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>          <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Plot.Height|Plot.Area|Plot.Volume&quot;</span>, myTraits)], </span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>          <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, <span class="at">myTitle =</span> <span class="st">&quot;Growth Curves&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>          <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;gc.h|gc.a|gc.v&quot;</span>, myTraits)], </span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a>          <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, <span class="at">myTitle =</span> <span class="st">&quot;Height&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a>                    <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Height|gc.h|Plant.Length&quot;</span>, myTraits)], </span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a>                    <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a>mp5 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, <span class="at">myTitle =</span> <span class="st">&quot;Area&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;Number of Significant Associations&quot;</span>,</span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a>                    <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Area|gc.a|Width|Node|Lowest.Pod&quot;</span>, myTraits)], </span>
<span id="cb71-19"><a href="#cb71-19" tabindex="-1"></a>                    <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb71-20"><a href="#cb71-20" tabindex="-1"></a>mp6 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, <span class="at">myTitle =</span> <span class="st">&quot;Volume&quot;</span>, <span class="at">myYlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb71-21"><a href="#cb71-21" tabindex="-1"></a>                    <span class="at">myTs =</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Volume|gc.v|Biomass|Plant.Mass&quot;</span>, myTraits)], </span>
<span id="cb71-22"><a href="#cb71-22" tabindex="-1"></a>                    <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb71-23"><a href="#cb71-23" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb71-24"><a href="#cb71-24" tabindex="-1"></a>mp7 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Hits</span>(xx, <span class="at">myTitle =</span> <span class="st">&quot;Volume + Height + Area&quot;</span>, </span>
<span id="cb71-25"><a href="#cb71-25" tabindex="-1"></a>                    <span class="at">myTs =</span> <span class="fu">c</span>(myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Height|gc.h|Plant.Length|&quot;</span>, myTraits)], </span>
<span id="cb71-26"><a href="#cb71-26" tabindex="-1"></a>                             myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Area|gc.a|Width|Node|Lowest.Pod&quot;</span>, myTraits)],</span>
<span id="cb71-27"><a href="#cb71-27" tabindex="-1"></a>                             myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Volume|gc.v|Biomass|Plant.Mass&quot;</span>, myTraits)]),</span>
<span id="cb71-28"><a href="#cb71-28" tabindex="-1"></a>                    <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors, <span class="at">sigThresh =</span> <span class="dv">20</span>)</span>
<span id="cb71-29"><a href="#cb71-29" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb71-30"><a href="#cb71-30" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_12_1.png&quot;</span>, mp1, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb71-31"><a href="#cb71-31" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_12_2.png&quot;</span>, mp2, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb71-32"><a href="#cb71-32" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_12_3.png&quot;</span>, mp3, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb71-33"><a href="#cb71-33" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_12_4.png&quot;</span>, mp4, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb71-34"><a href="#cb71-34" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_12_5.png&quot;</span>, mp5, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb71-35"><a href="#cb71-35" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_12_6.png&quot;</span>, mp6, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb71-36"><a href="#cb71-36" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_12_7.png&quot;</span>, mp7, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb71-37"><a href="#cb71-37" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb71-38"><a href="#cb71-38" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(mp1), <span class="at">file=</span><span class="st">&quot;Additional/Additional_Figure_12_1.html&quot;</span>)</span>
<span id="cb71-39"><a href="#cb71-39" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(mp2), <span class="at">file=</span><span class="st">&quot;Additional/Additional_Figure_12_2.html&quot;</span>)</span>
<span id="cb71-40"><a href="#cb71-40" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(mp3), <span class="at">file=</span><span class="st">&quot;Additional/Additional_Figure_12_3.html&quot;</span>)</span>
<span id="cb71-41"><a href="#cb71-41" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(mp4), <span class="at">file=</span><span class="st">&quot;Additional/Additional_Figure_12_4.html&quot;</span>)</span>
<span id="cb71-42"><a href="#cb71-42" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(mp5), <span class="at">file=</span><span class="st">&quot;Additional/Additional_Figure_12_5.html&quot;</span>)</span>
<span id="cb71-43"><a href="#cb71-43" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(mp6), <span class="at">file=</span><span class="st">&quot;Additional/Additional_Figure_12_6.html&quot;</span>)</span>
<span id="cb71-44"><a href="#cb71-44" tabindex="-1"></a><span class="fu">saveWidget</span>(<span class="fu">ggplotly</span>(mp7), <span class="at">file=</span><span class="st">&quot;Additional/Additional_Figure_12_7.html&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="additional-figures-13" class="section level2">
<h2>Additional Figures 13</h2>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_13_1.html"
target="_blank">Additional/Additional_Figure_13_1.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_13_1.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_13_2.html"
target="_blank">Additional/Additional_Figure_13_2.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_13_2.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_13_3.html"
target="_blank">Additional/Additional_Figure_13_3.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_13_3.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_13_4.html"
target="_blank">Additional/Additional_Figure_13_4.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_13_4.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_13_5.html"
target="_blank">Additional/Additional_Figure_13_5.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_13_5.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_13_6.html"
target="_blank">Additional/Additional_Figure_13_6.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_13_6.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_13_7.html"
target="_blank">Additional/Additional_Figure_13_7.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_13_7.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_13_8.html"
target="_blank">Additional/Additional_Figure_13_8.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_13_8.png" /></p>
<blockquote>
<ul>
<li><i class="fas fa-chart-line" role="presentation" aria-label="chart-line icon"></i>
<a
href="https://derekmichaelwright.github.io/AGILE_LDP_UAV/Additional/Additional_Figure_13_9.html"
target="_blank">Additional/Additional_Figure_13_9.html</a></li>
</ul>
</blockquote>
<p><img src="Additional/Additional_Figure_13_9.png" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a><span class="co"># Drone Data</span></span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>myTi <span class="ot">&lt;-</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Plot.Height&quot;</span>, myTraits)]</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>mp1 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Summary</span>(<span class="at">folder =</span> <span class="st">&quot;GWAS_Results/&quot;</span>, <span class="at">traits =</span> myTi, <span class="at">threshold =</span> <span class="fl">6.8</span>, <span class="at">sug.threshold =</span> <span class="dv">6</span>,</span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>                       <span class="at">hlines =</span> <span class="fu">c</span>(<span class="fl">7.5</span>, <span class="fl">18.5</span>, <span class="fl">28.5</span>), <span class="at">vline.legend =</span> F, <span class="at">shapes =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">25</span>),</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>                       <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>myTi <span class="ot">&lt;-</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Plot.Area&quot;</span>, myTraits)]</span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a>mp2 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Summary</span>(<span class="at">folder =</span> <span class="st">&quot;GWAS_Results/&quot;</span>, <span class="at">traits =</span> myTi, <span class="at">threshold =</span> <span class="fl">6.8</span>, <span class="at">sug.threshold =</span> <span class="dv">6</span>,</span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a>                       <span class="at">hlines =</span> <span class="fu">c</span>(<span class="fl">7.5</span>, <span class="fl">17.5</span>, <span class="fl">25.5</span>), <span class="at">vline.legend =</span> F, <span class="at">shapes =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">25</span>),</span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a>                       <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a>myTi <span class="ot">&lt;-</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Plot.Volume&quot;</span>, myTraits)]</span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a>mp3 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Summary</span>(<span class="at">folder =</span> <span class="st">&quot;GWAS_Results/&quot;</span>, <span class="at">traits =</span> myTi, <span class="at">threshold =</span> <span class="fl">6.8</span>, <span class="at">sug.threshold =</span> <span class="dv">6</span>,</span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a>                       <span class="at">hlines =</span> <span class="fu">c</span>(<span class="fl">7.5</span>, <span class="fl">17.5</span>, <span class="fl">25.5</span>), <span class="at">vline.legend =</span> F, <span class="at">shapes =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">25</span>),</span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a>                       <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb72-18"><a href="#cb72-18" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-19"><a href="#cb72-19" tabindex="-1"></a><span class="co"># Growth Curves</span></span>
<span id="cb72-20"><a href="#cb72-20" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-21"><a href="#cb72-21" tabindex="-1"></a>myTi <span class="ot">&lt;-</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;gc.h&quot;</span>, myTraits)]</span>
<span id="cb72-22"><a href="#cb72-22" tabindex="-1"></a>mp4 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Summary</span>(<span class="at">folder =</span> <span class="st">&quot;GWAS_Results/&quot;</span>, <span class="at">traits =</span> myTi, <span class="at">threshold =</span> <span class="fl">6.8</span>, <span class="at">sug.threshold =</span> <span class="dv">6</span>,</span>
<span id="cb72-23"><a href="#cb72-23" tabindex="-1"></a>                       <span class="at">hlines =</span> <span class="fu">c</span>(<span class="fl">12.5</span>, <span class="fl">24.5</span>), <span class="at">vline.legend =</span> F, <span class="at">shapes =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">25</span>),</span>
<span id="cb72-24"><a href="#cb72-24" tabindex="-1"></a>                       <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb72-25"><a href="#cb72-25" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-26"><a href="#cb72-26" tabindex="-1"></a>myTi <span class="ot">&lt;-</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;gc.a&quot;</span>, myTraits)]</span>
<span id="cb72-27"><a href="#cb72-27" tabindex="-1"></a>mp5 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Summary</span>(<span class="at">folder =</span> <span class="st">&quot;GWAS_Results/&quot;</span>, <span class="at">traits =</span> myTi, <span class="at">threshold =</span> <span class="fl">6.8</span>, <span class="at">sug.threshold =</span> <span class="dv">6</span>,</span>
<span id="cb72-28"><a href="#cb72-28" tabindex="-1"></a>                       <span class="at">hlines =</span> <span class="fu">c</span>(<span class="fl">12.5</span>, <span class="fl">24.5</span>), <span class="at">vline.legend =</span> F, <span class="at">shapes =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">25</span>),</span>
<span id="cb72-29"><a href="#cb72-29" tabindex="-1"></a>                       <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb72-30"><a href="#cb72-30" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-31"><a href="#cb72-31" tabindex="-1"></a>myTi <span class="ot">&lt;-</span> myTraits[<span class="fu">grepl</span>(<span class="st">&quot;gc.v&quot;</span>, myTraits)]</span>
<span id="cb72-32"><a href="#cb72-32" tabindex="-1"></a>mp6 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Summary</span>(<span class="at">folder =</span> <span class="st">&quot;GWAS_Results/&quot;</span>, <span class="at">traits =</span> myTi, <span class="at">threshold =</span> <span class="fl">6.8</span>, <span class="at">sug.threshold =</span> <span class="dv">6</span>,</span>
<span id="cb72-33"><a href="#cb72-33" tabindex="-1"></a>                       <span class="at">hlines =</span> <span class="fu">c</span>(<span class="fl">12.5</span>, <span class="fl">24.5</span>), <span class="at">vline.legend =</span> F, <span class="at">shapes =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">25</span>),</span>
<span id="cb72-34"><a href="#cb72-34" tabindex="-1"></a>                       <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb72-35"><a href="#cb72-35" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-36"><a href="#cb72-36" tabindex="-1"></a><span class="co"># Manual Measurements</span></span>
<span id="cb72-37"><a href="#cb72-37" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-38"><a href="#cb72-38" tabindex="-1"></a>myTi <span class="ot">&lt;-</span> <span class="fu">c</span>(myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Canopy.Height&quot;</span>, myTraits)], </span>
<span id="cb72-39"><a href="#cb72-39" tabindex="-1"></a>          myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Plant.Length&quot;</span>, myTraits)])</span>
<span id="cb72-40"><a href="#cb72-40" tabindex="-1"></a>mp7 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Summary</span>(<span class="at">folder =</span> <span class="st">&quot;GWAS_Results/&quot;</span>, <span class="at">traits =</span> myTi, <span class="at">threshold =</span> <span class="fl">6.8</span>, <span class="at">sug.threshold =</span> <span class="dv">6</span>,</span>
<span id="cb72-41"><a href="#cb72-41" tabindex="-1"></a>                       <span class="at">hlines =</span> <span class="fu">c</span>(<span class="fl">9.5</span>), <span class="at">vline.legend =</span> F, <span class="at">shapes =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">25</span>),</span>
<span id="cb72-42"><a href="#cb72-42" tabindex="-1"></a>                       <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb72-43"><a href="#cb72-43" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-44"><a href="#cb72-44" tabindex="-1"></a>myTi <span class="ot">&lt;-</span> <span class="fu">c</span>(myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Plot.Biomass&quot;</span>, myTraits)], </span>
<span id="cb72-45"><a href="#cb72-45" tabindex="-1"></a>          myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Straw.Biomass&quot;</span>, myTraits)],</span>
<span id="cb72-46"><a href="#cb72-46" tabindex="-1"></a>          myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Plant.Mass&quot;</span>, myTraits)] )</span>
<span id="cb72-47"><a href="#cb72-47" tabindex="-1"></a>mp8 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Summary</span>(<span class="at">folder =</span> <span class="st">&quot;GWAS_Results/&quot;</span>, <span class="at">traits =</span> myTi, <span class="at">threshold =</span> <span class="fl">6.8</span>, <span class="at">sug.threshold =</span> <span class="dv">6</span>,</span>
<span id="cb72-48"><a href="#cb72-48" tabindex="-1"></a>                       <span class="at">hlines =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">19.5</span>), <span class="at">vline.legend =</span> F, <span class="at">shapes =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">25</span>),</span>
<span id="cb72-49"><a href="#cb72-49" tabindex="-1"></a>                       <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb72-50"><a href="#cb72-50" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-51"><a href="#cb72-51" tabindex="-1"></a>myTi <span class="ot">&lt;-</span> <span class="fu">c</span>(myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Flower.Branch&quot;</span>, myTraits)],</span>
<span id="cb72-52"><a href="#cb72-52" tabindex="-1"></a>          myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Nodes.At.Flower&quot;</span>, myTraits)],</span>
<span id="cb72-53"><a href="#cb72-53" tabindex="-1"></a>          myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Node.Of.Flower&quot;</span>, myTraits)],</span>
<span id="cb72-54"><a href="#cb72-54" tabindex="-1"></a>          myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Lowest.Pod.H&quot;</span>, myTraits)], </span>
<span id="cb72-55"><a href="#cb72-55" tabindex="-1"></a>          myTraits[<span class="fu">grepl</span>(<span class="st">&quot;Canopy.Width&quot;</span>, myTraits)] )</span>
<span id="cb72-56"><a href="#cb72-56" tabindex="-1"></a>mp9 <span class="ot">&lt;-</span> <span class="fu">gg_GWAS_Summary</span>(<span class="at">folder =</span> <span class="st">&quot;GWAS_Results/&quot;</span>, <span class="at">traits =</span> myTi, <span class="at">threshold =</span> <span class="fl">6.8</span>, <span class="at">sug.threshold =</span> <span class="dv">6</span>,</span>
<span id="cb72-57"><a href="#cb72-57" tabindex="-1"></a>                       <span class="at">hlines =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">12.5</span>, <span class="fl">16.5</span>, <span class="fl">27.5</span>), <span class="at">vline.legend =</span> F, <span class="at">shapes =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">25</span>),</span>
<span id="cb72-58"><a href="#cb72-58" tabindex="-1"></a>                       <span class="at">vlines =</span> myMarkers, <span class="at">vline.colors =</span> myMColors)</span>
<span id="cb72-59"><a href="#cb72-59" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-60"><a href="#cb72-60" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_13_1.png&quot;</span>, mp1, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb72-61"><a href="#cb72-61" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_13_2.png&quot;</span>, mp2, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb72-62"><a href="#cb72-62" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_13_3.png&quot;</span>, mp3, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb72-63"><a href="#cb72-63" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_13_4.png&quot;</span>, mp4, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb72-64"><a href="#cb72-64" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_13_5.png&quot;</span>, mp5, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb72-65"><a href="#cb72-65" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_13_6.png&quot;</span>, mp6, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb72-66"><a href="#cb72-66" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_13_7.png&quot;</span>, mp7, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb72-67"><a href="#cb72-67" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_13_8.png&quot;</span>, mp8, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb72-68"><a href="#cb72-68" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Additional/Additional_Figure_13_9.png&quot;</span>, mp9, <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb72-69"><a href="#cb72-69" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-70"><a href="#cb72-70" tabindex="-1"></a><span class="fu">gg_GWAS_plotly</span>(mp1, <span class="at">filename =</span> <span class="st">&quot;Additional/Additional_Figure_13_1.html&quot;</span>)</span>
<span id="cb72-71"><a href="#cb72-71" tabindex="-1"></a><span class="fu">gg_GWAS_plotly</span>(mp2, <span class="at">filename =</span> <span class="st">&quot;Additional/Additional_Figure_13_2.html&quot;</span>)</span>
<span id="cb72-72"><a href="#cb72-72" tabindex="-1"></a><span class="fu">gg_GWAS_plotly</span>(mp3, <span class="at">filename =</span> <span class="st">&quot;Additional/Additional_Figure_13_3.html&quot;</span>)</span>
<span id="cb72-73"><a href="#cb72-73" tabindex="-1"></a><span class="fu">gg_GWAS_plotly</span>(mp4, <span class="at">filename =</span> <span class="st">&quot;Additional/Additional_Figure_13_4.html&quot;</span>)</span>
<span id="cb72-74"><a href="#cb72-74" tabindex="-1"></a><span class="fu">gg_GWAS_plotly</span>(mp5, <span class="at">filename =</span> <span class="st">&quot;Additional/Additional_Figure_13_5.html&quot;</span>)</span>
<span id="cb72-75"><a href="#cb72-75" tabindex="-1"></a><span class="fu">gg_GWAS_plotly</span>(mp6, <span class="at">filename =</span> <span class="st">&quot;Additional/Additional_Figure_13_6.html&quot;</span>)</span>
<span id="cb72-76"><a href="#cb72-76" tabindex="-1"></a><span class="fu">gg_GWAS_plotly</span>(mp7, <span class="at">filename =</span> <span class="st">&quot;Additional/Additional_Figure_13_7.html&quot;</span>)</span>
<span id="cb72-77"><a href="#cb72-77" tabindex="-1"></a><span class="fu">gg_GWAS_plotly</span>(mp8, <span class="at">filename =</span> <span class="st">&quot;Additional/Additional_Figure_13_8.html&quot;</span>)</span>
<span id="cb72-78"><a href="#cb72-78" tabindex="-1"></a><span class="fu">gg_GWAS_plotly</span>(mp9, <span class="at">filename =</span> <span class="st">&quot;Additional/Additional_Figure_13_9.html&quot;</span>)</span></code></pre></div>
<hr />
<p>© Derek Michael Wright</p>
</div>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
		$('#content img:not(.no-lightbox)').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: true },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
